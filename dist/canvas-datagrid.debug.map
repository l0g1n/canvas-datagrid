{"version":3,"sources":["webpack://canvasDatagrid/webpack/universalModuleDefinition","webpack://canvasDatagrid/./lib/button.js","webpack://canvasDatagrid/./lib/component.js","webpack://canvasDatagrid/./lib/contextMenu.js","webpack://canvasDatagrid/./lib/defaults.js","webpack://canvasDatagrid/./lib/dom.js","webpack://canvasDatagrid/./lib/draw.js","webpack://canvasDatagrid/./lib/events/index.js","webpack://canvasDatagrid/./lib/events/util.js","webpack://canvasDatagrid/./lib/intf.js","webpack://canvasDatagrid/./lib/main.js","webpack://canvasDatagrid/./lib/publicMethods.js","webpack://canvasDatagrid/./lib/touch.js","webpack://canvasDatagrid/./node_modules/is-printable-key-event/dist/index.js","webpack://canvasDatagrid/webpack/bootstrap","webpack://canvasDatagrid/webpack/runtime/compat get default export","webpack://canvasDatagrid/webpack/runtime/define property getters","webpack://canvasDatagrid/webpack/runtime/hasOwnProperty shorthand","webpack://canvasDatagrid/webpack/runtime/make namespace object","webpack://canvasDatagrid/webpack/startup"],"names":["self","zIndexTop","applyButtonMenuItemStyle","buttonMenuItemContainer","createInlineStyle","mobile","addEventListener","applyButtonStyle","button","buttonMenu","createButton","pos","items","imgSrc","wrapper","document","createElement","buttonArrow","buttonIcon","intf","Array","isArray","Error","init","loc","s","scrollOffset","canvas","undefined","style","buttonZIndex","x","left","y","top","height","position","zIndex","scrollBox","scrollLeft","scrollTop","innerHTML","buttonArrowDownHTML","img","setAttribute","maxWidth","appendChild","body","toggleButtonMenu","dispose","parentNode","removeChild","createDisposeEvent","requestAnimationFrame","disposeButtonMenu","offsetHeight","createButtonMenu","selectedIndex","rect","createItems","addItem","item","menuItemContainer","addContent","content","title","click","ev","apply","disposeButton","clickIndex","idx","dispatchEvent","Event","getBoundingClientRect","bottom","window","innerHeight","buttonMenuWindowMargin","right","innerWidth","Object","defineProperty","get","set","value","isNaN","isFinite","length","forEach","index","removeEventListener","e","keyCode","moveButtonPos","attachButton","typeMap","component","g_observer","getObserver","dehyphenateProperty","hyphenateProperty","prop","replace","p","nextLetterCap","prototype","call","char","toUpperCase","cust","toLowerCase","getDefaultItem","base","i","r","defaults","filter","applyComponentStyle","supressChangeAndDrawEvents","isComponent","cStyle","getComputedStyle","tagName","defs","computedStyle","styles","def","val","getPropertyValue","setStyleProperty","resize","data","strData","JSON","parse","schema","strSchema","number","strNum","n","parseInt","strBool","test","string","str","getObservableAttributes","attrs","attributes","attr","push","disconnectedCallback","connected","connectedCallback","parentDOMNode","observe","adoptedCallback","attributeChangedCallback","attrName","oldVal","newVal","tfn","dataType","name","Function","MutationObserver","hoverScrollTimeout","autoCompleteContext","applyContextItemStyle","contextItemContainer","createContextMenu","parentContextMenu","container","upArrow","downArrow","children","childMenuArrow","removeChildContext","relatedTarget","contextMenu","contains","splice","indexOf","contextAddCallback","getAttribute","cPos","childContextMenuMarginLeft","offsetWidth","childContextMenuMarginTop","createChildContext","childContextMenuArrowHTML","checkArrowVisibility","scrollHeight","fade","element","opacity","timer","setInterval","clearInterval","display","animationDurationHideContextMenu","unfade","animationDurationShowContextMenu","startHoverScroll","type","t","a","contextHoverScrollAmount","setTimeout","contextHoverScrollRateMs","endHoverScroll","clearTimeout","contextMenuZIndex","color","contextMenuArrowColor","el","textAlign","inputDropdown","maxHeight","autocompleteBottomMargin","minWidth","width","hasFocus","deltaY","deltaX","contextMenuArrowUpHTML","contextMenuArrowDownHTML","contextMenuWindowMargin","parentGrid","c","createFilterContextMenuItems","filterContainer","filterLabel","filterAutoCompleteButton","filterInput","cell","header","iRect","checkRegExpErrorState","background","contextFilterInputBackground","contextFilterInputColor","invalidFilterRegEx","contextFilterInvalidRegExpBackground","contextFilterInvalidRegExpColor","fillAutoComplete","count","blanksItem","viewData","row","cellValue","String","trim","blankValues","includes","blanksText","maxAutoCompleteItems","formatters","stopPropagation","disposeAutocomplete","keys","concat","map","key","createAutoCompleteContext","autoCompleteItems","onclick","disposeContextMenu","preventDefault","setFilter","en","columnFilters","filterOptionText","contextFilterButtonHTML","cf","h","getHeaderByName","removeFilterOptionText","removeFilterClick","controlInput","focus","addDefaultContextMenuItem","isNormalCell","isBackground","isColumnHeaderCellCap","isScrollBar","isCorner","isRowHeader","showFilter","showCopy","selections","reduce","copyText","execCommand","showPaste","clipBoardData","pasteText","paste","columnIndex","rowIndex","draw","showColumnSelector","columnSelectorText","d","getSchema","column","toggleColumnVisibility","hidden","setStorageData","columnSelectorHiddenText","columnSelectorVisibleText","hideColumnText","saveAppearance","showClearSettingsOption","sizes","rows","columns","clearSettingsOptionText","createRowOrders","createColumnOrders","storedSettings","columnWidth","cellWidth","cellHeight","allowSorting","showOrderByOption","showOrderByOptionTextAsc","order","showOrderByOptionTextDesc","event","mousedown","mouseup","contextmenuEvent","overridePos","target","contextPosition","getLayerPos","NativeEvent","getCellAt","isGrid","contextMenuMarginLeft","canvasOffsetLeft","contextMenuMarginTop","canvasOffsetTop","mobileContextMenuMargin","filterButtonMenuOffsetTop","getClippingRect","ele","boundingRect","eleRect","clipRect","w","parentRect","Infinity","columnHeaderCellHeight","getColumnHeaderCellHeight","rowHeaderCellWidth","getRowHeaderCellWidth","offsetTop","scrollBarWidth","offsetLeft","clipElement","clip","scrollingElement","nodeName","nodeType","resizeEditInput","input","editCell","bm","gridBorderCollapse","borderWidth","cellBorderWidth","getVisibleCellByIndex","mobileEditInputHeight","cellPaddingLeft","ignoreScrollOffset","offsetParent","clientX","clientY","isChildGrid","endEdit","abort","abortEdit","newValue","oldValue","changes","originalData","boundRowIndex","defaultValue","aborted","addRow","createNewRowData","beginEditAt","inEnterMode","editable","adjacentCells","enumItems","enu","option","valueInEnum","scrollIntoView","setActiveCell","getAdjacentCells","multiLine","editCellZIndex","fontSize","editCellFontSize","scale","cellValueIsEmpty","shouldClearCellValue","nx","ny","altKey","nextRowIndex","shiftKey","Math","max","min","last","first","className","css","padding","buttonPadding","borderStyle","borderColor","buttonBorderColor","cursor","buttonBackgroundColor","userSelect","buttonHoverBackgroundColor","buttonActiveBorderColor","buttonActiveBackgroundColor","verticalAlign","buttonArrowColor","lineHeight","fontWeight","fontFamily","contextMenuFontFamily","contextMenuFontSize","margin","contextMenuItemMargin","borderRadius","contextMenuItemBorderRadius","contextMenuHoverBackground","contextMenuHoverColor","contextMenuLabelMargin","contextMenuLabelDisplay","contextMenuLabelMinWidth","contextMenuLabelMaxWidth","contextMenuBackground","contextMenuColor","border","contextMenuBorder","contextMenuPadding","contextMenuBorderRadius","contextMenuOpacity","overflow","whiteSpace","contextMenuCursor","marginLeft","contextFilterInputBorder","contextFilterInputBorderRadius","contextFilterInputFontFamily","contextFilterInputFontSize","contextFilterButtonBorder","contextFilterButtonBorderRadius","contextMenuFilterButtonFontFamily","contextMenuFilterButtonFontSize","cssFloat","childContextMenuArrowColor","contextMenuChildArrowFontSize","boxSizing","outline","mobileEditFontFamily","mobileEditFontSize","editCellBorder","editCellColor","editCellBackgroundColor","appearance","webkitAppearance","mozAppearance","editCellPaddingLeft","editCellFontFamily","boxShadow","editCellBoxShadow","contextMenuFilterInvalidExpresion","appendTo","setDom","ctx","context","eventParent","onblur","blur","parentIsCanvas","getContext","textBaseline","parentNodeStyle","touchstart","dblclick","mousemove","scrollWheel","copy","cut","keypress","keyup","keydown","perfCounters","cachedImagesDrawn","drawCount","perfWindowSize","entityCount","hiddenFrozenColumnCount","scrollDebugCounters","touchPPSCounters","htmlImageCache","fillArray","low","high","step","drawPerfLine","perfArr","arrIndex","useAbs","beginPath","moveTo","cx","cy","abs","lineTo","strokeStyle","stroke","drawOnAllImagesLoaded","loaded","html","complete","drawHtml","v","formattedValue","cacheKey","toString","round","drawImage","Image","onload","src","btoa","drawOrderByArrow","mt","columnHeaderOrderByArrowMarginTop","ml","columnHeaderOrderByArrowMarginLeft","mr","columnHeaderOrderByArrowMarginRight","aw","columnHeaderOrderByArrowWidth","ah","columnHeaderOrderByArrowHeight","fillStyle","columnHeaderOrderByArrowColor","columnHeaderOrderByArrowBorderColor","orderDirection","fill","drawTreeArrow","treeArrowMarginTop","treeArrowMarginRight","treeArrowMarginLeft","treeArrowWidth","treeArrowHeight","treeArrowColor","treeArrowBorderColor","openChildren","drawFilterButtonArrow","filterButtonHeight","filterButtonArrowHeight","filterButtonWidth","filterButtonArrowWidth","filterButtonArrowColor","filterButtonArrowBorderColor","radiusRect","radius","b","quadraticCurveTo","fillRect","strokeRect","fillText","text","fillCircle","arc","PI","strokeCircle","clipFrozenArea","mode","lastFrozenColumnPixel","lastFrozenRowPixel","fillHandle","selectionHandleType","strokeHandle","addselectionHandle","hw","selectionHandleSize","tr","br","tl","bl","addBorderLine","l","addEllipsis","ellipsisCache","measureText","wrapText","splitChar","lines","calculatedLineHeight","word","words","split","textHeight","out","wrap","cellWhiteSpace","autoResize","autoResizeRows","elWidth","et","ellipsisText","elClipLength","plWidth","clippedVal","ogWordWidth","previousLine","line","cHeight","paddedHeight","curSplitChar","measure","paddedWidth","arr","originText","stepLength","direction","substr","drawText","ll","fontHeight","vPos","hPos","paddingLeft","orderByArrowWidth","horizontalAlignment","paddingRight","verticalAlignment","paddingBottom","lineSpacing","debug","active","font","debugFont","debugColor","stringify","pw","idx_ord","sortColumnIndex","getFrozenColumnsWidth","frozenColumn","getColumnWidth","internal","visible","checkScrollHeight","rowHeaderCell","treeGrid","rowOpen","rowHeight","cornerCell","rowData","aCell","bc","selectionBorders","moveBorders","selectionHandles","rowHeaders","u","currentCell","performance","now","visibleRowHeights","orders","drawScrollBars","drawCorner","entities","m","scrollBarBoxMargin","scrollBarBorderColor","lineWidth","scrollBarBorderWidth","horizontalBox","scrollCache","horizontalBar","scrollBoxWidth","scrollWidth","verticalBox","frozenRow","verticalBar","scrollBoxHeight","horizontalBarVisible","scrollBarBackgroundColor","scrollBarBoxColor","horizontalBoxVisible","scrollBarActiveColor","scrollBarBoxBorderRadius","visibleCells","unshift","verticalBarVisible","verticalBoxVisible","scrollBarCornerBorderColor","scrollBarCornerBackgroundColor","corner","createHandlesOverlayArray","allowMovingSelection","selectionBorderTop","selectionBorderRight","selectionHandle","selectionBorderLeft","selectionBorderBottom","selectionHandleBehavior","createBorderOverlayArray","drawArray","propPrefix","offsetPoint","selectionBorder","isHeader","drawCell","rowOrderIndex","drawEach","headerIndex","columnOrderIndex","cellStyle","cellGridAttributes","isColumnHeader","isFilterable","filterable","selected","hovered","hovers","hoverMode","openedFilter","selectedFilterButton","activeCell","rawValue","activeHeader","f","orderByArrowSize","treeArrowSize","visibleRows","paddingTop","cellLineHeight","cellLineSpacing","viewRowIndex","viewColumnIndex","getBoundRowIndexFromViewRowIndex","boundColumnIndex","getBoundColumnIndexFromViewColumnIndex","sortRowIndex","isNormal","gridId","userHeight","userWidth","cellHeightWithChildGrid","cellWidthWithChildGrid","save","tree","showRowNumbers","childGrids","createGrid","cellGridHeight","grid","orderBy","console","warn","filterTextPrefix","movingSelection","moveOffset","restore","drawFilterButton","isSorting","orderings","showRowNumberGaps","previousRowNumber","hasRowGap","barHeight","rowHeaderCellRowNumberGapHeight","barColor","rowHeaderCellRowNumberGapColor","posX","posY","filterButtonBorderColor","filterButtonBackgroundColor","filterButtonActiveBackgroundColor","onFilterButton","filterButtonHoverBackgroundColor","filterButtonBorderRadius","drawRowHeader","showRowHeaders","filteredRowNumber","rowHeaderValue","hasActiveFilters","headerDescription","drawHeaders","g","o","columnHeaderCell","nonFrozenHeaderWidth","drawHeaderColumnRange","start","end","rArgs","rhIndex","showColumnHeaders","scrollPixelLeft","columnHeaderCellBorderWidth","scrollIndexLeft","isColumnHeaderCell","endCap","drawRow","treeHeight","rowSansTreeHeight","trees","scrollIndexRight","scrollPixelRight","initDraw","drawBackground","gridBackgroundColor","drawFrozenRows","ln","allowFreezingRows","frozenMarkerBorderWidth","frozenMarkerWidth","drawRows","snapToRow","scrollPixelTop","scrollIndexTop","scrollIndexBottom","scrollPixelBottom","showNewRow","newRow","drawMoveMarkers","moveOverlayBorderWidth","moveOverlayBorderColor","setLineDash","moveOverlayBorderSegments","drawReorderMarkers","reorderObject","dragOffset","reorderMarkerBackgroundColor","reorderMarkerBorderWidth","reorderMarkerBorderColor","dragMode","k","getRowHeight","reorderMarkerIndexBorderWidth","reorderMarkerIndexBorderColor","reorderTarget","selectedColumns","drawBorder","gridBorderWidth","gridBorderColor","drawSelectionBorders","selectionOverlayBorderWidth","selectionOverlayBorderColor","dsb","drawSelectionHandles","selectionHandleBorderWidth","selectionHandleBorderColor","selectionHandleColor","az","touchSelectHandleZone","ax","ay","drawActiveCell","cl","acx","acy","acw","ach","selectionMode","activeCellOverlayBorderWidth","activeCellOverlayBorderColor","getHeaderWidth","drawFrozenMarkers","my","mx","xHover","yHover","allowFreezingColumns","frozenMarkerHoverColor","frozenMarkerColor","frozenMarkerHoverBorderColor","frozenMarkerBorderColor","freezeMarkerPosition","frozenMarkerActiveColor","frozenMarkerActiveBorderColor","drawPerfLines","showPerformance","px","py","ph","dpl","debugPerfChartTextColor","toFixed","debugPerfChartBackground","debugScrollHeightColor","debugScrollWidthColor","debugPerformanceColor","debugEntitiesColor","debugTouchPPSXColor","debugTouchPPSYColor","pop","yPPS","xPPS","drawDebug","perf","perfDelta","frozenColumnsWidth","htmlImages","startScale","scaleDelta","zoomDeltaStart","touchLength","touches","touchPosition","touchPosition1","scrollIndex","scrollPixel","canvasOffset","touchDelta","touchAnimateTo","scrollAnimation","touchPPS","touchPPST","xPPST","yPPST","touchDuration","pointerLockPosition","size","mouse","touch","touchStart","dragContext","debugBackgroundColor","lh","wheeling","fn","events","removeEachListener","sfn","defaultPrevented","dispatchEachEvent","getRatio","maxPixelRatio","devicePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","drawAfterResize","vb","nb","co","isScrollBoxCorner","sbw","ratio","cellBorder","columnHeaderCellBorder","dataHeight","dataWidth","dims","ch","checkScrollBoxVisibility","overflowX","overflowY","setScrollBoxSize","setCanvasSize","dim","appliedInlineStyles","reduceSchema","accumulator","va","args","widthBoxRatio","heightBoxRatio","scrollBarBoxMinSize","scrollBarBoxWidth","bar","box","page","pageUpDownOverlap","scroll","dontDraw","floor","ctrl","ctrlKey","metaKey","persistantSelectionMode","singleSelectionMode","dragBounds","sBounds","delta","previousCell","scrollTimer","isInGrid","rowBoundaryCrossed","columnBoundaryCrossed","cellBoundaryCrossed","prefix","draggingItem","dragItem","selecting","dragStart","dragStartObject","getSelectionBounds","ignoreNextClick","selectRow","dragAddToSelection","selectedData","getSelectedData","selectedCells","getSelectedCells","selectionBounds","selectArea","isMultiRowsSelected","autoScrollOnMousemove","movedVertically","autoScrollMargin","movedHorizontally","autoScrollZone","startingBounds","checkSelectionChange","sb","selectAll","columnHeaderClickBehavior","treeArrowClickRadius","toggleTree","dragResizeColumn","resizingStartingWidth","resizingStartingHeight","minColumnWidth","minRowHeight","resizeScrollZone","resizeChildGrids","globalRowResize","stopDragResize","hasMoved","dragItemIsSelected","isColumnSelected","fitSelectedColumns","scrollGrid","scrollPointerLock","scrollStartMode","movementX","movementY","scrollMode","scrollStart","scrollModes","scrollRepeatRate","selectionScrollIncrement","stopScrollGrid","exitPointerLock","dragReorder","columReorder","rowReorder","allowColumnReordering","allowRowReordering","isMultiColumnsSelected","selectColumn","source","reorderDeadZone","stopDragReorder","oIndex","tIndex","odata","cr","sortColumnIndices","seletedColumnIndices","deleteCount","selectedRows","dragMove","stopDragMove","moveSelection","freezeMove","stopFreezeMove","startFreezeMove","lastMouseDownTarget","move","freeze","requestPointerLock","dragging","cols","keepFocusOnMouseOut","isPrintableKeyEvent","selectNone","deleteSelectedData","Number","isArrowKey","firstSelectedRowIndex","findIndex","firstSelectedRow","firstSelectedColumnIndex","lastSelectedColumn","yAtTop","yAtBottom","xAtLeft","xAtRight","selection","shift","selectionFollowsActiveCell","currentCellIsSelected","fitColumnToValues","autosize","deltaMode","touchHaltAnimation","scrollTo","pasteData","pasteValue","mimeType","startRowIndex","startColIndex","isSupportedHtml","parseData","cellData","join","forEachSelectedCell","colName","realRowIndex","cells","existingRowData","newRowData","assign","colIndex","columnName","boundRowIndexMap","affectedCells","getNextVisibleColumnIndex","visibleColumnIndex","getVisibleSchema","getVisibleColumnIndexOf","clipboardItems","Map","from","clipboardData","supportedMimeTypes","pasteableItems","itemToPaste","startCell","len","pasteType","getAsString","copySelectedCellsToClipboard","clearSelectedCells","genericDiv","genericSpan","genericTable","excelTable","excelTableRow","some","expression","IGNORE_NODETYPES","isHtmlTable","sanitizeElementData","elementData","innerText","parseHtmlText","doc","DOMParser","parseFromString","querySelector","parseHtmlTable","trs","querySelectorAll","childNodes","childNode","col","parseText","htmlSafe","createTextString","isNeat","values","createHTMLString","htmlString","ctor","treeGridAttributes","storageName","invalidSearchExpClass","localStyleLibraryStorageKey","add","sortFunction","sort","filters","sorters","parsers","schemaHashes","componentL1Events","eventNames","expandToRow","viewDataLength","orderedIndex","entries","firstRowAsString","rowAsString","rowDict","textString","copiedData","setData","has","visibility","localStorage","setItem","tempSchema","selectedColumn","applyDefaultValue","newRowIndex","forEachHeader","getSchemaNameHash","getFilteredAndSortedViewData","newViewData","originalRowIndex","headerName","filterText","currentFilterFunction","filterFrozenRows","sortFn","rowA","rowB","rowIndexB","sortFrozenRows","_row","refresh","getBestGuessDataType","drawChildGrids","gridKey","setTimer","selectionScrollZone","validateColumn","setDefaults","obj1","obj2","setAttributes","eachAttribute","setStyle","eachStyle","findColumnMaxTextLength","contextmenu","observer","disconnect","tryLoadStoredSettings","reloadStoredValues","getDomRoot","shadowRoot","host","getFontName","fontStyle","getFontHeight","parseFloat","parseStyleValue","initProp","propName","getStyleProperty","styleKeys","supressDrawAndEvent","isDim","getItem","message","initialized","addStyleKeyIfNoneExists","publicStyleKeyIntf","initScrollBox","ie","navigator","userAgent","edge","webKit","moz","cursorGrab","cursorGrabing","cursorGrabbing","clearChangeLog","gotoCell","gotoRow","addButton","findColumnScrollLeft","findRowScrollTop","isCellVisible","isRowVisible","isColumnVisible","getSchemaFromData","expandTree","collapseTree","insertRow","deleteRow","insertColumn","deleteColumn","addColumn","setRowHeight","setColumnWidth","resetColumnWidths","resetRowHeights","assertPxColor","clearPxColorAssertions","integerToAlpha","DOMStyles","valueObject","filterFor","filterRegExp","regEnd","pattern","exec","flags","substring","flagLength","RegExp","toLocaleUpperCase","textContent","TypeError","currentCursor","find","eventName","RangeError","eachDataRow","setTreeGridAttributes","setCellGridAttributes","schemaGetter","schemaSetter","eachSchemaColumn","hideEachSchemaColumn","getTypes","parseInnerHtml","callback","etl","autoGenerateSchema","dataGetter","dataSetter","autoResizeColumns","sHeight","sWidth","setScrollTop","preventScrollEvent","setScrollLeft","supressDrawEvent","webComponent","modules","dom","publicMethods","Grid","eval","module","attachShadow","HTMLElement","create","customElements","observedAttributes","define","canvasDatagrid","require","EXCLUDE_GLOBAL","tKeys","argKey","tKey","sKey","ordA","charCodeAt","ordZ","fromCharCode","showFilterInCell","offsetX","offsetY","targetX","targetY","sbh","offset","multiColIsSelected","columnIndices","colIsSelected","supressEvent","addCol","removeCol","st","de","ri","dragObject","childGrid","trArgs","treeGridHeight","newSize","dontSetStorageData","sorter","sel","visibleSchema","selectionLength","xi","maxRowLength","minXi","yi","lastSourceIndex","cidx","useTouchScrollZones","getBorder","entitiy","borderResizeZone","tsz","touchScrollZone","moveMode","borderDragBehavior","moveBorder","xBorderBehavior","yBorderBehavior","isVerticalScrollBar","isHorizontalScrollBar","allowColumnResize","allowColumnResizeFromCell","allowRowHeaderResize","allowRowResize","allowRowResizeFromCell","rowGrabZoneSize","maxCol","minCol","mapEachSchemaColumn","bounds","rowHeaderCellFont","autosizePadding","autosizeHeaderCellPadding","rowHeaderCellPaddingRight","rowHeaderCellPaddingLeft","formatter","columnHeaderCellFont","headerCellPaddingRight","headerCellPaddingLeft","cellFont","cellPaddingRight","cellAutoResizePadding","total","cellFormatterString","headerCell","asc","aValue","bValue","localeCompare","date","Date","getTime","touchTimerMs","debounceTouchMove","touchMoving","touchScrollTimeout","animationFrames","getTouchPos","touchIndex","easingFunctions","linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easing","touchEasingMethod","calculatePPSTimed","touchSigmaTimed","calculatePPS","touchSigma","touchEndAnimation","touchReleaseAnimationDurationMs","stopAnimation","touchEditCell","changedTouches","startingCell","calculatePPSTimer","touchContextTimeout","touchStartEvent","zoomAltered","touchStart1","touchScrollStart","touchContextMenuTimeMs","touchEndEvents","touchmove","passive","touchend","touchcancel","touchSelect","handleType","touchSelecting","touchMove","rw","rScrollZone","lScrollZone","bScrollZone","tScrollZone","t1","t2","touchDeadZone","touchZoomSensitivity","touchZoomMin","touchZoomMax","touchScroll","dz","touchReleaseAcceleration","scrollAnimationPPSThreshold"],"mappings":"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","file":"canvas-datagrid.debug.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"canvasDatagrid\"] = factory();\n\telse\n\t\troot[\"canvasDatagrid\"] = factory();\n})(self, function() {\nreturn ","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false, Event: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  let zIndexTop;\r\n\r\n  function applyButtonMenuItemStyle(buttonMenuItemContainer) {\r\n    self.createInlineStyle(\r\n      buttonMenuItemContainer,\r\n      'canvas-datagrid-button-menu-item' + (self.mobile ? '-mobile' : ''),\r\n    );\r\n    buttonMenuItemContainer.addEventListener('mouseover', function () {\r\n      self.createInlineStyle(\r\n        buttonMenuItemContainer,\r\n        'canvas-datagrid-button-menu-item:hover',\r\n      );\r\n    });\r\n    buttonMenuItemContainer.addEventListener('mouseout', function () {\r\n      self.createInlineStyle(\r\n        buttonMenuItemContainer,\r\n        'canvas-datagrid-button-menu-item',\r\n      );\r\n    });\r\n  }\r\n\r\n  function applyButtonStyle(button) {\r\n    self.createInlineStyle(button, 'canvas-datagrid-button-wrapper');\r\n    button.addEventListener('mouseover', function () {\r\n      if (!self.buttonMenu) {\r\n        self.createInlineStyle(button, 'canvas-datagrid-button-wrapper:hover');\r\n      }\r\n    });\r\n    button.addEventListener('mouseout', function () {\r\n      if (!self.buttonMenu) {\r\n        self.createInlineStyle(button, 'canvas-datagrid-button-wrapper');\r\n      }\r\n    });\r\n  }\r\n\r\n  function createButton(pos, items, imgSrc) {\r\n    var wrapper = document.createElement('div'),\r\n      buttonArrow = document.createElement('div'),\r\n      buttonIcon = document.createElement('div'),\r\n      intf = {};\r\n\r\n    if (!Array.isArray(items)) {\r\n      throw new Error('createButton expects an array.');\r\n    }\r\n\r\n    function init() {\r\n      var loc = {},\r\n        s = self.scrollOffset(self.canvas);\r\n\r\n      if (zIndexTop === undefined) {\r\n        zIndexTop = self.style.buttonZIndex;\r\n      }\r\n\r\n      applyButtonStyle(wrapper);\r\n      self.createInlineStyle(buttonIcon, 'canvas-datagrid-button-icon');\r\n      self.createInlineStyle(buttonArrow, 'canvas-datagrid-button-arrow');\r\n\r\n      loc.x = pos.left - s.left;\r\n      loc.y = pos.top - s.top;\r\n      loc.height = 0;\r\n      zIndexTop += 1;\r\n      wrapper.style.position = 'absolute';\r\n      wrapper.style.zIndex = zIndexTop;\r\n      wrapper.style.left = loc.x + 'px';\r\n      wrapper.style.top = loc.y + 'px';\r\n      wrapper.left = pos.left + self.scrollBox.scrollLeft;\r\n      wrapper.top = pos.top + self.scrollBox.scrollTop;\r\n      buttonArrow.innerHTML = self.style.buttonArrowDownHTML;\r\n      if (imgSrc) {\r\n        let img = document.createElement('img');\r\n        img.setAttribute('src', imgSrc);\r\n        img.style.maxWidth = '100%';\r\n        img.style.height = '100%';\r\n        buttonIcon.appendChild(img);\r\n      }\r\n      wrapper.appendChild(buttonIcon);\r\n      wrapper.appendChild(buttonArrow);\r\n      document.body.appendChild(wrapper);\r\n      wrapper.addEventListener('click', toggleButtonMenu);\r\n    }\r\n\r\n    intf.wrapper = wrapper;\r\n    intf.items = items;\r\n    init();\r\n\r\n    intf.dispose = function () {\r\n      if (wrapper.parentNode) {\r\n        wrapper.parentNode.removeChild(wrapper);\r\n      }\r\n    };\r\n    return intf;\r\n  }\r\n\r\n  function toggleButtonMenu() {\r\n    function createDisposeEvent() {\r\n      requestAnimationFrame(function () {\r\n        document.addEventListener('click', self.disposeButtonMenu);\r\n      });\r\n    }\r\n    if (self.buttonMenu) {\r\n      self.disposeButtonMenu();\r\n    } else {\r\n      let pos = {\r\n        left: self.button.wrapper.left - self.scrollBox.scrollLeft,\r\n        top:\r\n          self.button.wrapper.top +\r\n          self.button.wrapper.offsetHeight -\r\n          self.scrollBox.scrollTop,\r\n      };\r\n      self.buttonMenu = createButtonMenu(pos, self.button.items);\r\n      self.createInlineStyle(\r\n        self.button.wrapper,\r\n        'canvas-datagrid-button-wrapper:active',\r\n      );\r\n      createDisposeEvent();\r\n    }\r\n  }\r\n\r\n  function createButtonMenu(pos, items) {\r\n    var buttonMenu = document.createElement('div'),\r\n      selectedIndex = -1,\r\n      intf = {},\r\n      rect;\r\n\r\n    function createItems() {\r\n      function addItem(item, menuItemContainer) {\r\n        function addContent(content) {\r\n          if (content === null) {\r\n            return;\r\n          }\r\n\r\n          if (typeof content === 'object') {\r\n            menuItemContainer.appendChild(content);\r\n            return;\r\n          }\r\n\r\n          applyButtonMenuItemStyle(menuItemContainer);\r\n          menuItemContainer.innerHTML = content;\r\n          return;\r\n        }\r\n\r\n        addContent(item.title);\r\n        item.buttonMenuItemContainer = menuItemContainer;\r\n\r\n        if (item.click) {\r\n          menuItemContainer.addEventListener('click', function (ev) {\r\n            item.click.apply(self, [ev]);\r\n            self.disposeButton();\r\n          });\r\n        }\r\n      }\r\n\r\n      for (let item of items) {\r\n        var buttonMenuItemContainer = document.createElement('div');\r\n        addItem(item, buttonMenuItemContainer);\r\n        buttonMenu.appendChild(buttonMenuItemContainer);\r\n      }\r\n    }\r\n\r\n    function clickIndex(idx) {\r\n      items[idx].buttonMenuItemContainer.dispatchEvent(new Event('click'));\r\n    }\r\n\r\n    function init() {\r\n      var loc = {},\r\n        s = self.scrollOffset(self.canvas);\r\n\r\n      if (zIndexTop === undefined) {\r\n        zIndexTop = self.style.buttonZIndex;\r\n      }\r\n\r\n      createItems();\r\n      self.createInlineStyle(\r\n        buttonMenu,\r\n        'canvas-datagrid-button-menu' + (self.mobile ? '-mobile' : ''),\r\n      );\r\n\r\n      loc.x = pos.left - s.left;\r\n      loc.y = pos.top - s.top;\r\n      loc.height = 0;\r\n      zIndexTop += 1;\r\n      buttonMenu.style.position = 'absolute';\r\n      buttonMenu.style.zIndex = zIndexTop;\r\n      buttonMenu.style.left = loc.x + 'px';\r\n      buttonMenu.style.top = loc.y + 'px';\r\n      document.body.appendChild(buttonMenu);\r\n      rect = buttonMenu.getBoundingClientRect();\r\n\r\n      if (rect.bottom > window.innerHeight) {\r\n        loc.y =\r\n          self.button.wrapper.top -\r\n          buttonMenu.offsetHeight -\r\n          self.scrollBox.scrollTop;\r\n        if (loc.y < 0) {\r\n          loc.y = self.style.buttonMenuWindowMargin;\r\n        }\r\n\r\n        if (\r\n          buttonMenu.offsetHeight >\r\n          window.innerHeight - self.style.buttonMenuWindowMargin\r\n        ) {\r\n          buttonMenu.style.height =\r\n            window.innerHeight - self.style.buttonMenuWindowMargin * 2 + 'px';\r\n        }\r\n      }\r\n\r\n      if (rect.right > window.innerWidth) {\r\n        loc.x -=\r\n          rect.right - window.innerWidth + self.style.buttonMenuWindowMargin;\r\n      }\r\n\r\n      if (loc.x < 0) {\r\n        loc.x = self.style.buttonMenuWindowMargin;\r\n      }\r\n\r\n      if (loc.y < 0) {\r\n        loc.y = self.style.buttonMenuWindowMargin;\r\n      }\r\n\r\n      buttonMenu.style.left = loc.x + 'px';\r\n      buttonMenu.style.top = loc.y + 'px';\r\n    }\r\n\r\n    intf.buttonMenu = buttonMenu;\r\n    init();\r\n    intf.clickIndex = clickIndex;\r\n    intf.rect = rect;\r\n    intf.items = items;\r\n\r\n    intf.dispose = function () {\r\n      if (buttonMenu.parentNode) {\r\n        buttonMenu.parentNode.removeChild(buttonMenu);\r\n      }\r\n    };\r\n\r\n    Object.defineProperty(intf, 'selectedIndex', {\r\n      get: function get() {\r\n        return selectedIndex;\r\n      },\r\n      set: function set(value) {\r\n        if (typeof value !== 'number' || isNaN(value) || !isFinite(value)) {\r\n          throw new Error('Button menu selected index must be a sane number.');\r\n        }\r\n\r\n        selectedIndex = value;\r\n\r\n        if (selectedIndex > items.length - 1) {\r\n          selectedIndex = items.length - 1;\r\n        }\r\n\r\n        if (selectedIndex < 0) {\r\n          selectedIndex = 0;\r\n        }\r\n\r\n        items.forEach(function (item, index) {\r\n          if (index === selectedIndex) {\r\n            return self.createInlineStyle(\r\n              item.buttonMenuItemContainer,\r\n              'canvas-datagrid-button-menu-item:hover',\r\n            );\r\n          }\r\n\r\n          self.createInlineStyle(\r\n            item.buttonMenuItemContainer,\r\n            'canvas-datagrid-button-menu-item',\r\n          );\r\n        });\r\n      },\r\n    });\r\n    return intf;\r\n  }\r\n\r\n  self.disposeButtonMenu = function () {\r\n    if (self.buttonMenu) {\r\n      document.removeEventListener('click', self.disposeButtonMenu);\r\n      self.buttonMenu.dispose();\r\n      self.buttonMenu = undefined;\r\n      self.createInlineStyle(\r\n        self.button.wrapper,\r\n        'canvas-datagrid-button-wrapper:hover',\r\n      );\r\n    }\r\n  };\r\n\r\n  self.disposeButton = function (e) {\r\n    if (e && e.keyCode !== 27) return;\r\n    document.removeEventListener('keydown', self.disposeButton);\r\n    zIndexTop = self.style.buttonZIndex;\r\n    self.disposeButtonMenu();\r\n\r\n    if (self.button) {\r\n      self.button.dispose();\r\n    }\r\n\r\n    self.button = undefined;\r\n  };\r\n\r\n  self.moveButtonPos = function () {\r\n    self.button.wrapper.style.left =\r\n      self.button.wrapper.left - self.scrollBox.scrollLeft + 'px';\r\n    self.button.wrapper.style.top =\r\n      self.button.wrapper.top - self.scrollBox.scrollTop + 'px';\r\n    self.disposeButtonMenu();\r\n  };\r\n\r\n  self.attachButton = function (pos, items, imgSrc) {\r\n    function createDisposeEvent() {\r\n      requestAnimationFrame(function () {\r\n        document.addEventListener('keydown', self.disposeButton);\r\n      });\r\n    }\r\n\r\n    if (self.button) {\r\n      self.disposeButton();\r\n    }\r\n\r\n    self.button = createButton(pos, items, imgSrc);\r\n    createDisposeEvent();\r\n  };\r\n  return;\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nimport defaults from './defaults';\r\n\r\nexport default function () {\r\n  var typeMap,\r\n    component = {};\r\n  var g_observer;\r\n  component.getObserver = function () {\r\n    // console.log(g_observer, 'component.js x obs');\r\n    return g_observer;\r\n  };\r\n  component.dehyphenateProperty = function hyphenateProperty(prop) {\r\n    prop = prop.replace('--cdg-', '');\r\n    var p = '',\r\n      nextLetterCap;\r\n    Array.prototype.forEach.call(prop, function (char) {\r\n      if (nextLetterCap) {\r\n        nextLetterCap = false;\r\n        p += char.toUpperCase();\r\n        return;\r\n      }\r\n      if (char === '-') {\r\n        nextLetterCap = true;\r\n        return;\r\n      }\r\n      p += char;\r\n    });\r\n    return p;\r\n  };\r\n  component.hyphenateProperty = function hyphenateProperty(prop, cust) {\r\n    var p = '';\r\n    Array.prototype.forEach.call(prop, function (char) {\r\n      if (char === char.toUpperCase()) {\r\n        p += '-' + char.toLowerCase();\r\n        return;\r\n      }\r\n      p += char;\r\n    });\r\n    return (cust ? '--cdg-' : '') + p;\r\n  };\r\n  function getDefaultItem(base, item) {\r\n    var i = {},\r\n      r;\r\n    defaults(i);\r\n    r = i.defaults[base].filter(function (i) {\r\n      return (\r\n        i[0].toLowerCase() === item.toLowerCase() ||\r\n        component.hyphenateProperty(i[0]) === item.toLowerCase() ||\r\n        component.hyphenateProperty(i[0], true) === item.toLowerCase()\r\n      );\r\n    })[0];\r\n    return r;\r\n  }\r\n  component.applyComponentStyle = function (supressChangeAndDrawEvents, intf) {\r\n    if (!intf.isComponent) {\r\n      return;\r\n    }\r\n    var cStyle = window.getComputedStyle(\r\n        intf.tagName === 'CANVAS-DATAGRID' ? intf : intf.canvas,\r\n        null,\r\n      ),\r\n      defs = {};\r\n    intf.computedStyle = cStyle;\r\n    defaults(defs);\r\n    defs = defs.defaults.styles;\r\n    defs.forEach(function (def) {\r\n      var val;\r\n      val = cStyle.getPropertyValue(component.hyphenateProperty(def[0], true));\r\n      if (val === '') {\r\n        val = cStyle.getPropertyValue(\r\n          component.hyphenateProperty(def[0], false),\r\n        );\r\n      }\r\n      if (val !== '' && typeof val === 'string') {\r\n        intf.setStyleProperty(\r\n          def[0],\r\n          typeMap[typeof def[1]](\r\n            val.replace(/^\\s+/, '').replace(/\\s+$/, ''),\r\n            def[1],\r\n          ),\r\n          true,\r\n        );\r\n      }\r\n    });\r\n    if (!supressChangeAndDrawEvents && intf.dispatchEvent) {\r\n      requestAnimationFrame(function () {\r\n        intf.resize(true);\r\n      });\r\n      intf.dispatchEvent('stylechanged', intf.style);\r\n    }\r\n  };\r\n  typeMap = {\r\n    data: function (strData) {\r\n      try {\r\n        return JSON.parse(strData);\r\n      } catch (e) {\r\n        throw new Error('Cannot read JSON data in canvas-datagrid data.');\r\n      }\r\n    },\r\n    schema: function (strSchema) {\r\n      try {\r\n        return JSON.parse(strSchema);\r\n      } catch (e) {\r\n        throw new Error(\r\n          'Cannot read JSON data in canvas-datagrid schema attribute.',\r\n        );\r\n      }\r\n    },\r\n    number: function (strNum, def) {\r\n      var n = parseInt(strNum, 10);\r\n      return isNaN(n) ? def : n;\r\n    },\r\n    boolean: function (strBool) {\r\n      return /true/i.test(strBool);\r\n    },\r\n    string: function (str) {\r\n      return str;\r\n    },\r\n  };\r\n  component.getObservableAttributes = function () {\r\n    var i = {},\r\n      attrs = ['data', 'schema', 'style', 'className', 'name'];\r\n    defaults(i);\r\n    i.defaults.attributes.forEach(function (attr) {\r\n      attrs.push(attr[0].toLowerCase());\r\n    });\r\n    return attrs;\r\n  };\r\n  component.disconnectedCallback = function () {\r\n    // g_observer.disconnect();\r\n    // console.log('component.js disconn');\r\n    this.connected = false;\r\n  };\r\n  component.connectedCallback = function () {\r\n    var intf = this;\r\n    intf.parentDOMNode.innerHTML = '';\r\n    intf.parentDOMNode.appendChild(intf.canvas);\r\n    intf.connected = true;\r\n    // console.log('component.js conn');\r\n    component.observe(intf);\r\n    component.applyComponentStyle(true, intf);\r\n    intf.resize(true);\r\n  };\r\n  component.adoptedCallback = function () {\r\n    this.resize();\r\n  };\r\n  component.attributeChangedCallback = function (attrName, oldVal, newVal) {\r\n    var tfn,\r\n      intf = this,\r\n      def;\r\n    if (attrName === 'style') {\r\n      component.applyComponentStyle(false, intf);\r\n      return;\r\n    }\r\n    if (attrName === 'data') {\r\n      if (intf.dataType === 'application/x-canvas-datagrid') {\r\n        intf.dataType = 'application/json+x-canvas-datagrid';\r\n      }\r\n      intf.data = newVal;\r\n      return;\r\n    }\r\n    if (attrName === 'schema') {\r\n      intf.schema = typeMap.schema(newVal);\r\n      return;\r\n    }\r\n    if (attrName === 'name') {\r\n      intf.name = newVal;\r\n      return;\r\n    }\r\n    if (attrName === 'class' || attrName === 'className') {\r\n      return;\r\n    }\r\n    def = getDefaultItem('attributes', attrName);\r\n    if (def) {\r\n      tfn = typeMap[typeof def[1]];\r\n      intf.attributes[def[0]] = tfn(newVal);\r\n      return;\r\n    }\r\n    if (/^on/.test(attrName)) {\r\n      intf.addEventListener('on' + attrName, Function('e', newVal));\r\n    }\r\n    return;\r\n  };\r\n  component.observe = function (intf) {\r\n    // console.log('component.observe');\r\n    // var observer;\r\n    if (!window.MutationObserver) {\r\n      return;\r\n    }\r\n    intf.applyComponentStyle = function () {\r\n      component.applyComponentStyle(false, intf);\r\n      intf.resize();\r\n    };\r\n    /**\r\n     * Applies the computed css styles to the grid.  In some browsers, changing directives in attached style sheets does not automatically update the styles in this component.  It is necessary to call this method to update in these cases.\r\n     * @memberof canvasDatagrid\r\n     * @name applyComponentStyle\r\n     * @method\r\n     */\r\n    /*\r\n    g_observer = new window.MutationObserver(function (mutations) {\r\n      console.log('new window.MutationObserver');\r\n      var checkInnerHTML, checkStyle;\r\n      Array.prototype.forEach.call(mutations, function (mutation) {\r\n        if (\r\n          mutation.attributeName === 'class' ||\r\n          mutation.attributeName === 'style'\r\n        ) {\r\n          checkStyle = true;\r\n          return;\r\n        }\r\n        if (mutation.target.nodeName === 'STYLE') {\r\n          checkStyle = true;\r\n          return;\r\n        }\r\n        if (\r\n          mutation.target.parentNode &&\r\n          mutation.target.parentNode.nodeName === 'STYLE'\r\n        ) {\r\n          checkStyle = true;\r\n          return;\r\n        }\r\n        if (\r\n          mutation.target === intf &&\r\n          (mutation.addedNodes.length > 0 || mutation.type === 'characterData')\r\n        ) {\r\n          checkInnerHTML = true;\r\n        }\r\n      });\r\n      if (checkStyle) {\r\n        intf.applyComponentStyle(false, intf);\r\n      }\r\n      if (checkInnerHTML) {\r\n        if (intf.dataType === 'application/x-canvas-datagrid') {\r\n          intf.dataType = 'application/json+x-canvas-datagrid';\r\n        }\r\n        intf.data = intf.innerHTML;\r\n      }\r\n    });\r\n    // console.log(g_observer, 'component.js obs');\r\n    g_observer.observe(intf, {\r\n      characterData: true,\r\n      childList: true,\r\n      attributes: true,\r\n      subtree: true,\r\n    });\r\n    Array.prototype.forEach.call(\r\n      document.querySelectorAll('style'),\r\n      function (el) {\r\n        g_observer.observe(el, {\r\n          characterData: true,\r\n          childList: true,\r\n          attributes: true,\r\n          subtree: true,\r\n        });\r\n      },\r\n    );*/\r\n    // console.log(g_observer, 'component.js 2 obs');\r\n    // console.log(component, 'component.js 4 obs');\r\n  };\r\n  // console.log(component, 'component.js 3 obs');\r\n  return component;\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false, Event: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  var zIndexTop, hoverScrollTimeout, autoCompleteContext;\r\n  function applyContextItemStyle(contextItemContainer) {\r\n    self.createInlineStyle(\r\n      contextItemContainer,\r\n      'canvas-datagrid-context-menu-item' + (self.mobile ? '-mobile' : ''),\r\n    );\r\n    contextItemContainer.addEventListener('mouseover', function () {\r\n      self.createInlineStyle(\r\n        contextItemContainer,\r\n        'canvas-datagrid-context-menu-item:hover',\r\n      );\r\n    });\r\n    contextItemContainer.addEventListener('mouseout', function () {\r\n      self.createInlineStyle(\r\n        contextItemContainer,\r\n        'canvas-datagrid-context-menu-item',\r\n      );\r\n    });\r\n  }\r\n  function createContextMenu(ev, pos, items, parentContextMenu) {\r\n    var container = document.createElement('div'),\r\n      upArrow = document.createElement('div'),\r\n      downArrow = document.createElement('div'),\r\n      children = [],\r\n      selectedIndex = -1,\r\n      intf = {},\r\n      rect;\r\n    if (!Array.isArray(items)) {\r\n      throw new Error('createContextMenu expects an array.');\r\n    }\r\n    function createItems() {\r\n      items.forEach(function (item) {\r\n        var contextItemContainer = document.createElement('div'),\r\n          childMenuArrow;\r\n        function removeChildContext(e) {\r\n          if (\r\n            e.relatedTarget === container ||\r\n            item.contextMenu.container === e.relatedTarget ||\r\n            childMenuArrow === e.relatedTarget ||\r\n            contextItemContainer === e.relatedTarget ||\r\n            item.contextMenu.container.contains(e.relatedTarget)\r\n          ) {\r\n            return;\r\n          }\r\n          item.contextMenu.dispose();\r\n          children.splice(children.indexOf(item.contextMenu), 1);\r\n          item.contextMenu = undefined;\r\n          contextItemContainer.removeEventListener(\r\n            'mouseout',\r\n            removeChildContext,\r\n          );\r\n          container.removeEventListener('mouseout', removeChildContext);\r\n          contextItemContainer.setAttribute('contextOpen', '0');\r\n          contextItemContainer.setAttribute('opening', '0');\r\n        }\r\n        function contextAddCallback(items) {\r\n          // check yet again if the user hasn't moved off\r\n          if (\r\n            contextItemContainer.getAttribute('opening') !== '1' ||\r\n            contextItemContainer.getAttribute('contextOpen') === '1'\r\n          ) {\r\n            return;\r\n          }\r\n          var cPos = contextItemContainer.getBoundingClientRect();\r\n          cPos = {\r\n            left:\r\n              cPos.left +\r\n              self.style.childContextMenuMarginLeft +\r\n              container.offsetWidth,\r\n            top: cPos.top + self.style.childContextMenuMarginTop,\r\n            bottom: cPos.bottom,\r\n            right: cPos.right,\r\n          };\r\n          item.contextMenu = createContextMenu(ev, cPos, items, intf);\r\n          contextItemContainer.setAttribute('contextOpen', '1');\r\n          contextItemContainer.addEventListener('mouseout', removeChildContext);\r\n          container.addEventListener('mouseout', removeChildContext);\r\n          children.push(item.contextMenu);\r\n        }\r\n        function createChildContext() {\r\n          var i;\r\n          if (contextItemContainer.getAttribute('contextOpen') === '1') {\r\n            return;\r\n          }\r\n          contextItemContainer.setAttribute('opening', '1');\r\n          if (typeof item.items === 'function') {\r\n            i = item.items.apply(intf, [\r\n              function (items) {\r\n                contextAddCallback(items);\r\n              },\r\n            ]);\r\n            if (i !== undefined && Array.isArray(i)) {\r\n              contextAddCallback(i);\r\n            }\r\n            return;\r\n          }\r\n          contextAddCallback(item.items);\r\n        }\r\n        function addItem(item) {\r\n          function addContent(content) {\r\n            if (content === null) {\r\n              return;\r\n            }\r\n            if (typeof content === 'function') {\r\n              return addContent(content(ev));\r\n            }\r\n            if (typeof content === 'object') {\r\n              contextItemContainer.appendChild(content);\r\n              return;\r\n            }\r\n            applyContextItemStyle(contextItemContainer);\r\n            contextItemContainer.innerHTML = content;\r\n            return;\r\n          }\r\n          addContent(item.title);\r\n          item.contextItemContainer = contextItemContainer;\r\n          if (\r\n            (item.items && item.items.length > 0) ||\r\n            typeof item.items === 'function'\r\n          ) {\r\n            childMenuArrow = document.createElement('div');\r\n            self.createInlineStyle(\r\n              childMenuArrow,\r\n              'canvas-datagrid-context-child-arrow',\r\n            );\r\n            childMenuArrow.innerHTML = self.style.childContextMenuArrowHTML;\r\n            contextItemContainer.appendChild(childMenuArrow);\r\n            contextItemContainer.addEventListener(\r\n              'mouseover',\r\n              createChildContext,\r\n            );\r\n            contextItemContainer.addEventListener('mouseout', function () {\r\n              contextItemContainer.setAttribute('opening', '0');\r\n            });\r\n          }\r\n          if (item.click) {\r\n            contextItemContainer.addEventListener('click', function (ev) {\r\n              item.click.apply(self, [ev]);\r\n            });\r\n          }\r\n        }\r\n        addItem(item);\r\n        container.appendChild(contextItemContainer);\r\n      });\r\n    }\r\n    function clickIndex(idx) {\r\n      items[idx].contextItemContainer.dispatchEvent(new Event('click'));\r\n    }\r\n    function checkArrowVisibility() {\r\n      if (container.scrollTop > 0) {\r\n        self.parentDOMNode.appendChild(upArrow);\r\n      } else if (upArrow.parentNode) {\r\n        upArrow.parentNode.removeChild(upArrow);\r\n      }\r\n      if (\r\n        container.scrollTop >=\r\n          container.scrollHeight - container.offsetHeight &&\r\n        downArrow.parentNode\r\n      ) {\r\n        downArrow.parentNode.removeChild(downArrow);\r\n      } else if (\r\n        container.scrollHeight - container.offsetHeight > 0 &&\r\n        !(\r\n          container.scrollTop >=\r\n          container.scrollHeight - container.offsetHeight\r\n        )\r\n      ) {\r\n        self.parentDOMNode.appendChild(downArrow);\r\n      }\r\n    }\r\n    function fade(element) {\r\n      var opacity = 1;\r\n      var timer = setInterval(function () {\r\n        if (opacity <= 0.1) {\r\n          clearInterval(timer);\r\n          element.style.display = 'none';\r\n          if (element.parentNode) {\r\n            element.parentNode.removeChild(element);\r\n          }\r\n        }\r\n        element.style.opacity = opacity;\r\n        element.style.filter = 'alpha(opacity=' + opacity * 100 + ')';\r\n        opacity -= opacity * 0.1;\r\n      }, self.attributes.animationDurationHideContextMenu * 0.1);\r\n    }\r\n    function unfade(element) {\r\n      var opacity = 0.1;\r\n      element.style.display = 'block';\r\n      var timer = setInterval(function () {\r\n        if (opacity >= 1) {\r\n          clearInterval(timer);\r\n        }\r\n        element.style.opacity = opacity;\r\n        element.style.filter = 'alpha(opacity=' + opacity * 100 + ')';\r\n        opacity += opacity * 0.1;\r\n      }, self.attributes.animationDurationShowContextMenu * 0.1);\r\n    }\r\n    function startHoverScroll(type) {\r\n      return function t() {\r\n        var a = self.attributes.contextHoverScrollAmount;\r\n        if (type === 'up' && container.scrollTop === 0) {\r\n          return;\r\n        }\r\n        if (type === 'down' && container.scrollTop === container.scrollHeight) {\r\n          return;\r\n        }\r\n        container.scrollTop += type === 'up' ? -a : a;\r\n        hoverScrollTimeout = setTimeout(\r\n          t,\r\n          self.attributes.contextHoverScrollRateMs,\r\n          type,\r\n        );\r\n      };\r\n    }\r\n    function endHoverScroll(type) {\r\n      return function () {\r\n        clearTimeout(hoverScrollTimeout);\r\n      };\r\n    }\r\n    function init() {\r\n      var loc = {},\r\n        s = self.scrollOffset(self.canvas);\r\n      if (zIndexTop === undefined) {\r\n        zIndexTop = self.style.contextMenuZIndex;\r\n      }\r\n      createItems();\r\n      self.createInlineStyle(\r\n        container,\r\n        'canvas-datagrid-context-menu' + (self.mobile ? '-mobile' : ''),\r\n      );\r\n      loc.x = pos.left - s.left;\r\n      loc.y = pos.top - s.top;\r\n      loc.height = 0;\r\n      zIndexTop += 1;\r\n      container.style.opacity = 0;\r\n      container.style.position = 'absolute';\r\n      upArrow.style.color = self.style.contextMenuArrowColor;\r\n      downArrow.style.color = self.style.contextMenuArrowColor;\r\n      [upArrow, downArrow].forEach(function (el) {\r\n        el.style.textAlign = 'center';\r\n        el.style.position = 'absolute';\r\n        el.style.zIndex = zIndexTop + 1;\r\n      });\r\n      container.style.zIndex = zIndexTop;\r\n      if (parentContextMenu && parentContextMenu.inputDropdown) {\r\n        container.style.maxHeight =\r\n          window.innerHeight -\r\n          loc.y -\r\n          self.style.autocompleteBottomMargin +\r\n          'px';\r\n        container.style.minWidth = pos.width + 'px';\r\n        loc.y += pos.height;\r\n      }\r\n      if (self.mobile) {\r\n        container.style.width = pos.width + 'px';\r\n      }\r\n      container.style.left = loc.x + 'px';\r\n      container.style.top = loc.y + 'px';\r\n      container.addEventListener('scroll', checkArrowVisibility);\r\n      container.addEventListener('wheel', function (e) {\r\n        if (self.hasFocus) {\r\n          container.scrollTop += e.deltaY;\r\n          container.scrollLeft += e.deltaX;\r\n        }\r\n        checkArrowVisibility();\r\n      });\r\n      upArrow.innerHTML = self.style.contextMenuArrowUpHTML;\r\n      downArrow.innerHTML = self.style.contextMenuArrowDownHTML;\r\n      container.appendChild(upArrow);\r\n      document.body.appendChild(downArrow);\r\n      document.body.appendChild(container);\r\n      unfade(container);\r\n      rect = container.getBoundingClientRect();\r\n      // TODO: fix !(parentContextMenu && parentContextMenu.inputDropdown) state (autocomplete)\r\n      if (rect.bottom > window.innerHeight) {\r\n        if (!(parentContextMenu && parentContextMenu.inputDropdown)) {\r\n          loc.y -=\r\n            rect.bottom +\r\n            self.style.contextMenuWindowMargin -\r\n            window.innerHeight;\r\n        }\r\n        if (loc.y < 0) {\r\n          loc.y = self.style.contextMenuWindowMargin;\r\n        }\r\n        if (\r\n          container.offsetHeight >\r\n          window.innerHeight - self.style.contextMenuWindowMargin\r\n        ) {\r\n          container.style.height =\r\n            window.innerHeight - self.style.contextMenuWindowMargin * 2 + 'px';\r\n        }\r\n      }\r\n      if (rect.right > window.innerWidth) {\r\n        loc.x -=\r\n          rect.right - window.innerWidth + self.style.contextMenuWindowMargin;\r\n      }\r\n      if (loc.x < 0) {\r\n        loc.x = self.style.contextMenuWindowMargin;\r\n      }\r\n      if (loc.y < 0) {\r\n        loc.y = self.style.contextMenuWindowMargin;\r\n      }\r\n      container.style.left = loc.x + 'px';\r\n      container.style.top = loc.y + 'px';\r\n      rect = container.getBoundingClientRect();\r\n      upArrow.style.top = rect.top + 'px';\r\n      downArrow.style.top =\r\n        rect.top + rect.height - downArrow.offsetHeight + 'px';\r\n      upArrow.style.left = rect.left + 'px';\r\n      downArrow.style.left = rect.left + 'px';\r\n      downArrow.style.width = container.offsetWidth + 'px';\r\n      upArrow.style.width = container.offsetWidth + 'px';\r\n      downArrow.addEventListener('mouseover', startHoverScroll('down'));\r\n      downArrow.addEventListener('mouseout', endHoverScroll('down'));\r\n      upArrow.addEventListener('mouseover', startHoverScroll('up'));\r\n      upArrow.addEventListener('mouseout', endHoverScroll('up'));\r\n      checkArrowVisibility();\r\n    }\r\n    intf.parentGrid = self.intf;\r\n    intf.parentContextMenu = parentContextMenu;\r\n    intf.container = container;\r\n    init();\r\n    intf.clickIndex = clickIndex;\r\n    intf.rect = rect;\r\n    intf.items = items;\r\n    intf.upArrow = upArrow;\r\n    intf.downArrow = downArrow;\r\n    intf.dispose = function () {\r\n      clearTimeout(hoverScrollTimeout);\r\n      children.forEach(function (c) {\r\n        c.dispose();\r\n      });\r\n      [downArrow, upArrow, container].forEach(function (el) {\r\n        fade(el);\r\n      });\r\n    };\r\n    Object.defineProperty(intf, 'selectedIndex', {\r\n      get: function () {\r\n        return selectedIndex;\r\n      },\r\n      set: function (value) {\r\n        if (typeof value !== 'number' || isNaN(value || !isFinite(value))) {\r\n          throw new Error('Context menu selected index must be a sane number.');\r\n        }\r\n        selectedIndex = value;\r\n        if (selectedIndex > items.length - 1) {\r\n          selectedIndex = items.length - 1;\r\n        }\r\n        if (selectedIndex < 0) {\r\n          selectedIndex = 0;\r\n        }\r\n        items.forEach(function (item, index) {\r\n          if (index === selectedIndex) {\r\n            return self.createInlineStyle(\r\n              item.contextItemContainer,\r\n              'canvas-datagrid-context-menu-item:hover',\r\n            );\r\n          }\r\n          self.createInlineStyle(\r\n            item.contextItemContainer,\r\n            'canvas-datagrid-context-menu-item',\r\n          );\r\n        });\r\n      },\r\n    });\r\n    return intf;\r\n  }\r\n  function createFilterContextMenuItems(e) {\r\n    var filterContainer = document.createElement('div'),\r\n      filterLabel = document.createElement('div'),\r\n      filterAutoCompleteButton = document.createElement('button'),\r\n      filterInput = document.createElement('input'),\r\n      n =\r\n        e.cell && e.cell.header\r\n          ? e.cell.header.title || e.cell.header.name\r\n          : '',\r\n      iRect;\r\n    function checkRegExpErrorState() {\r\n      filterInput.style.background = self.style.contextFilterInputBackground;\r\n      filterInput.style.color = self.style.contextFilterInputColor;\r\n      if (self.invalidFilterRegEx) {\r\n        filterInput.style.background =\r\n          self.style.contextFilterInvalidRegExpBackground;\r\n        filterInput.style.color = self.style.contextFilterInvalidRegExpColor;\r\n      }\r\n    }\r\n    function fillAutoComplete() {\r\n      var count = 0;\r\n      var items = {};\r\n      var blanksItem = [];\r\n\r\n      self.viewData.forEach(function (row) {\r\n        var cellValue =\r\n          row[e.cell.header.name] == null\r\n            ? row[e.cell.header.name]\r\n            : String(row[e.cell.header.name]).trim();\r\n        var value = self.blankValues.includes(cellValue)\r\n          ? self.attributes.blanksText\r\n          : cellValue;\r\n\r\n        if (items[value] || count > self.attributes.maxAutoCompleteItems) {\r\n          return;\r\n        }\r\n        count += 1;\r\n        items[value] = {\r\n          title: self.formatters[e.cell.header.type || 'string']({\r\n            cell: { value: value },\r\n          }),\r\n          click: function (e) {\r\n            filterInput.value = value;\r\n            e.stopPropagation();\r\n            filterInput.dispatchEvent(new Event('keyup'));\r\n            self.disposeAutocomplete();\r\n            return;\r\n          },\r\n        };\r\n      });\r\n\r\n      if (Object.keys(items).indexOf(self.attributes.blanksText) !== -1) {\r\n        blanksItem.push(items[self.attributes.blanksText]);\r\n        delete items[self.attributes.blanksText];\r\n      }\r\n\r\n      return blanksItem.concat(\r\n        Object.keys(items).map(function (key) {\r\n          return items[key];\r\n        }),\r\n      );\r\n    }\r\n\r\n    function createAutoCompleteContext(ev) {\r\n      if (ev && ['ArrowDown', 'ArrowUp', 'Enter', 'Tab'].includes(ev.key)) {\r\n        return;\r\n      }\r\n\r\n      var autoCompleteItems = fillAutoComplete();\r\n\r\n      iRect = filterInput.getBoundingClientRect();\r\n      if (autoCompleteContext) {\r\n        autoCompleteContext.dispose();\r\n        autoCompleteContext = undefined;\r\n      }\r\n      autoCompleteContext = createContextMenu(\r\n        e,\r\n        {\r\n          left: iRect.left,\r\n          top: iRect.top,\r\n          right: iRect.right,\r\n          bottom: iRect.bottom,\r\n          height: iRect.height,\r\n          width: iRect.width,\r\n        },\r\n        autoCompleteItems,\r\n        { inputDropdown: true },\r\n      );\r\n      autoCompleteContext.selectedIndex = 0;\r\n    }\r\n    self.createInlineStyle(filterLabel, 'canvas-datagrid-context-menu-label');\r\n    self.createInlineStyle(\r\n      filterAutoCompleteButton,\r\n      'canvas-datagrid-context-menu-filter-button',\r\n    );\r\n    self.createInlineStyle(\r\n      filterInput,\r\n      'canvas-datagrid-context-menu-filter-input',\r\n    );\r\n    checkRegExpErrorState();\r\n    filterInput.onclick = self.disposeAutocomplete;\r\n    filterInput.addEventListener('keydown', function (e) {\r\n      if (e.key === 'ArrowDown') {\r\n        autoCompleteContext.selectedIndex += 1;\r\n      }\r\n\r\n      if (e.key === 'ArrowUp') {\r\n        autoCompleteContext.selectedIndex -= 1;\r\n      }\r\n\r\n      if (e.key === 'Enter') {\r\n        autoCompleteContext.clickIndex(autoCompleteContext.selectedIndex);\r\n        self.disposeContextMenu();\r\n      }\r\n\r\n      if (e.key === 'Tab') {\r\n        autoCompleteContext.clickIndex(autoCompleteContext.selectedIndex);\r\n        e.preventDefault();\r\n      }\r\n\r\n      if (e.key === 'Escape') {\r\n        self.disposeContextMenu();\r\n      }\r\n    });\r\n    filterInput.addEventListener('keyup', function () {\r\n      self.setFilter(e.cell.header.name, filterInput.value);\r\n    });\r\n    filterInput.addEventListener('keyup', createAutoCompleteContext);\r\n    ['focus', 'blur', 'keydown', 'keyup', 'change'].forEach(function (en) {\r\n      filterInput.addEventListener(en, checkRegExpErrorState);\r\n    });\r\n    filterInput.value = e.cell.header\r\n      ? self.columnFilters[e.cell.header.name] || ''\r\n      : '';\r\n    filterLabel.innerHTML = self.attributes.filterOptionText.replace(/%s/g, n);\r\n    filterAutoCompleteButton.onclick = function () {\r\n      if (autoCompleteContext) {\r\n        return self.disposeAutocomplete();\r\n      }\r\n      createAutoCompleteContext();\r\n    };\r\n    filterAutoCompleteButton.innerHTML = self.style.contextFilterButtonHTML;\r\n    filterContainer.addEventListener('click', function (e) {\r\n      return e.stopPropagation();\r\n    });\r\n    filterContainer.appendChild(filterLabel);\r\n    filterContainer.appendChild(filterInput);\r\n    filterContainer.appendChild(filterAutoCompleteButton);\r\n    e.items.push({\r\n      title: filterContainer,\r\n    });\r\n    if (Object.keys(self.columnFilters).length) {\r\n      Object.keys(self.columnFilters).forEach(function (cf) {\r\n        var h = self.getHeaderByName(cf);\r\n        e.items.push({\r\n          title: self.attributes.removeFilterOptionText.replace(\r\n            /%s/g,\r\n            h.title || h.name,\r\n          ),\r\n          click: function removeFilterClick(e) {\r\n            e.preventDefault();\r\n            self.setFilter(cf, '');\r\n            self.controlInput.focus();\r\n          },\r\n        });\r\n      });\r\n    }\r\n  }\r\n  function addDefaultContextMenuItem(e) {\r\n    var isNormalCell =\r\n      !(\r\n        e.cell.isBackground ||\r\n        e.cell.isColumnHeaderCellCap ||\r\n        e.cell.isScrollBar ||\r\n        e.cell.isCorner ||\r\n        e.cell.isRowHeader\r\n      ) && e.cell.header;\r\n    if (self.attributes.showFilter && isNormalCell) {\r\n      createFilterContextMenuItems(e);\r\n    }\r\n    if (\r\n      self.attributes.showCopy &&\r\n      self.selections.reduce(function (p, r) {\r\n        return p + r.length;\r\n      }, 0) > 0\r\n    ) {\r\n      e.items.push({\r\n        title: self.attributes.copyText,\r\n        click: function () {\r\n          document.execCommand('copy');\r\n          self.disposeContextMenu();\r\n          self.controlInput.focus();\r\n        },\r\n      });\r\n    }\r\n    if (self.attributes.showPaste && self.clipBoardData) {\r\n      e.items.push({\r\n        title: self.attributes.pasteText,\r\n        click: function () {\r\n          self.paste(self.clipBoardData, e.cell.columnIndex, e.cell.rowIndex);\r\n          self.draw();\r\n        },\r\n      });\r\n    }\r\n    if (self.attributes.showColumnSelector) {\r\n      e.items.push({\r\n        title: self.attributes.columnSelectorText,\r\n        items: function () {\r\n          var d = [];\r\n          self.getSchema().forEach(function (column) {\r\n            function toggleColumnVisibility(e) {\r\n              column.hidden = !column.hidden;\r\n              self.dispatchEvent('togglecolumn', {\r\n                column: column,\r\n                hidden: column.hidden,\r\n              });\r\n              e.preventDefault();\r\n              self.stopPropagation(e);\r\n              self.disposeContextMenu();\r\n              self.resize(true);\r\n              self.setStorageData();\r\n            }\r\n            var el = document.createElement('div');\r\n            applyContextItemStyle(el);\r\n            el.addEventListener('touchstart', toggleColumnVisibility);\r\n            el.addEventListener('click', toggleColumnVisibility);\r\n            el.innerHTML =\r\n              (column.hidden\r\n                ? self.attributes.columnSelectorHiddenText\r\n                : self.attributes.columnSelectorVisibleText) +\r\n              (column.title || column.name);\r\n            d.push({\r\n              title: el,\r\n            });\r\n          });\r\n          return d;\r\n        },\r\n      });\r\n      if (e.cell && e.cell.header && e.cell.columnIndex > -1) {\r\n        e.items.push({\r\n          title: self.attributes.hideColumnText.replace(\r\n            /%s/gi,\r\n            e.cell.header.title || e.cell.header.name,\r\n          ),\r\n          click: function (ev) {\r\n            self.getSchema()[e.cell.columnIndex].hidden = true;\r\n            ev.preventDefault();\r\n            self.stopPropagation(ev);\r\n            self.disposeContextMenu();\r\n            self.setStorageData();\r\n            setTimeout(function () {\r\n              self.resize(true);\r\n            }, 10);\r\n          },\r\n        });\r\n      }\r\n    }\r\n    if (\r\n      self.attributes.saveAppearance &&\r\n      self.attributes.showClearSettingsOption &&\r\n      (Object.keys(self.sizes.rows).length > 0 ||\r\n        Object.keys(self.sizes.columns).length > 0)\r\n    ) {\r\n      e.items.push({\r\n        title: self.attributes.clearSettingsOptionText,\r\n        click: function (e) {\r\n          e.preventDefault();\r\n          self.sizes.rows = {};\r\n          self.sizes.columns = {};\r\n          self.createRowOrders();\r\n          self.createColumnOrders();\r\n          self.storedSettings = undefined;\r\n          self.dispatchEvent('resizecolumn', {\r\n            columnWidth: self.style.cellWidth,\r\n          });\r\n          self.dispatchEvent('resizerow', {\r\n            cellHeight: self.style.cellHeight,\r\n          });\r\n          self.setStorageData();\r\n          self.resize(true);\r\n          self.disposeContextMenu();\r\n          self.controlInput.focus();\r\n        },\r\n      });\r\n    }\r\n    if (\r\n      self.attributes.allowSorting &&\r\n      self.attributes.showOrderByOption &&\r\n      isNormalCell\r\n    ) {\r\n      e.items.push({\r\n        title: self.attributes.showOrderByOptionTextAsc.replace(\r\n          '%s',\r\n          e.cell.header.title || e.cell.header.name,\r\n        ),\r\n        click: function (ev) {\r\n          ev.preventDefault();\r\n          self.order(e.cell.header.name, 'asc');\r\n          self.controlInput.focus();\r\n        },\r\n      });\r\n      e.items.push({\r\n        title: self.attributes.showOrderByOptionTextDesc.replace(\r\n          '%s',\r\n          e.cell.header.title || e.cell.header.name,\r\n        ),\r\n        click: function (ev) {\r\n          ev.preventDefault();\r\n          self.order(e.cell.header.name, 'desc');\r\n          self.disposeContextMenu();\r\n          self.controlInput.focus();\r\n        },\r\n      });\r\n    }\r\n  }\r\n  self.disposeAutocomplete = function () {\r\n    if (autoCompleteContext) {\r\n      autoCompleteContext.dispose();\r\n      autoCompleteContext = undefined;\r\n    }\r\n  };\r\n  self.disposeContextMenu = function (event) {\r\n    document.removeEventListener('click', self.disposeContextMenu);\r\n    zIndexTop = self.style.contextMenuZIndex;\r\n    self.disposeAutocomplete();\r\n    if (self.contextMenu) {\r\n      self.contextMenu.dispose();\r\n    }\r\n    self.contextMenu = undefined;\r\n    if (event) {\r\n      self.canvas.focus();\r\n      self.mousedown(event);\r\n      self.mouseup(event);\r\n    }\r\n  };\r\n  self.contextmenuEvent = function (e, overridePos) {\r\n    if (!self.hasFocus && e.target !== self.canvas) {\r\n      return;\r\n    }\r\n    function createDisposeEvent() {\r\n      requestAnimationFrame(function () {\r\n        document.addEventListener('click', self.disposeContextMenu);\r\n        document.removeEventListener('mouseup', createDisposeEvent);\r\n      });\r\n    }\r\n    var contextPosition,\r\n      items = [],\r\n      pos = overridePos || self.getLayerPos(e),\r\n      ev = {\r\n        NativeEvent: e,\r\n        cell: self.getCellAt(pos.x, pos.y),\r\n        items: items,\r\n      };\r\n    if (!ev.cell.isGrid) {\r\n      addDefaultContextMenuItem(ev);\r\n    }\r\n    if (e.type !== 'mousedown' && self.dispatchEvent('contextmenu', ev)) {\r\n      return;\r\n    }\r\n    if (!ev.cell.isGrid) {\r\n      if (self.contextMenu) {\r\n        self.disposeContextMenu();\r\n      }\r\n      contextPosition = {\r\n        left:\r\n          pos.x +\r\n          pos.rect.left +\r\n          self.style.contextMenuMarginLeft +\r\n          self.canvasOffsetLeft,\r\n        top:\r\n          pos.y +\r\n          pos.rect.top +\r\n          self.style.contextMenuMarginTop +\r\n          self.canvasOffsetTop,\r\n        right: ev.cell.width + ev.cell.x + pos.rect.left,\r\n        bottom: ev.cell.height + ev.cell.y + pos.rect.top,\r\n        height: ev.cell.height,\r\n        width: ev.cell.width,\r\n      };\r\n      if (self.mobile) {\r\n        contextPosition.left = self.style.mobileContextMenuMargin + 'px';\r\n        contextPosition.width =\r\n          self.width - self.style.mobileContextMenuMargin * 2 + 'px';\r\n      }\r\n      if (e.type == 'mousedown') {\r\n        contextPosition.top += self.style.filterButtonMenuOffsetTop;\r\n      }\r\n      self.contextMenu = createContextMenu(ev, contextPosition, items);\r\n      if (e.type == 'mousedown') {\r\n        document.addEventListener('mouseup', createDisposeEvent);\r\n      } else {\r\n        createDisposeEvent();\r\n      }\r\n      e.preventDefault();\r\n    }\r\n  };\r\n  return;\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n\r\n'use strict';\r\nexport default function (self) {\r\n  self.defaults = {\r\n    attributes: [\r\n      ['allowColumnReordering', true],\r\n      ['allowColumnResize', true],\r\n      ['allowColumnResizeFromCell', false],\r\n      ['allowFreezingRows', false],\r\n      ['allowFreezingColumns', false],\r\n      ['allowMovingSelection', true],\r\n      ['allowRowHeaderResize', true],\r\n      ['allowRowReordering', false],\r\n      ['allowRowResize', true],\r\n      ['allowRowResizeFromCell', false],\r\n      ['allowSorting', true],\r\n      ['animationDurationShowContextMenu', 50],\r\n      ['animationDurationHideContextMenu', 50],\r\n      ['autoGenerateSchema', false],\r\n      ['autoResizeColumns', false],\r\n      ['autoResizeRows', false],\r\n      ['autoScrollOnMousemove', false],\r\n      ['autoScrollMargin', 5],\r\n      ['blanksText', '(Blanks)'],\r\n      ['borderDragBehavior', 'none'],\r\n      ['borderResizeZone', 10],\r\n      ['clearSettingsOptionText', 'Clear saved settings'],\r\n      ['columnHeaderClickBehavior', 'sort'],\r\n      ['columnSelectorHiddenText', '&nbsp;&nbsp;&nbsp;'],\r\n      ['columnSelectorText', 'Add/Remove columns'],\r\n      ['columnSelectorVisibleText', '\\u2713'],\r\n      ['contextHoverScrollAmount', 2],\r\n      ['contextHoverScrollRateMs', 5],\r\n      ['copyHeadersOnSelectAll', true],\r\n      ['copyText', 'Copy'],\r\n      ['debug', false],\r\n      ['editable', true],\r\n      ['ellipsisText', '...'],\r\n      ['filterOptionText', 'Filter %s'],\r\n      ['filterTextPrefix', '(filtered) '],\r\n      ['filterFrozenRows', true],\r\n      ['globalRowResize', false],\r\n      ['hideColumnText', 'Hide %s'],\r\n      ['hoverMode', 'cell'],\r\n      ['keepFocusOnMouseOut', false],\r\n      ['maxAutoCompleteItems', 200],\r\n      ['multiLine', false],\r\n      ['name', ''],\r\n      ['pageUpDownOverlap', 1],\r\n      ['pasteText', 'Paste'],\r\n      ['persistantSelectionMode', false],\r\n      ['removeFilterOptionText', 'Remove filter on %s'],\r\n      ['reorderDeadZone', 3],\r\n      ['resizeScrollZone', 20],\r\n      ['rowGrabZoneSize', 5],\r\n      ['saveAppearance', true],\r\n      ['scrollAnimationPPSThreshold', 0.75],\r\n      ['scrollPointerLock', false],\r\n      ['scrollRepeatRate', 75],\r\n      ['selectionFollowsActiveCell', false],\r\n      ['selectionHandleBehavior', 'none'],\r\n      ['selectionMode', 'cell'],\r\n      ['selectionScrollIncrement', 20],\r\n      ['selectionScrollZone', 20],\r\n      ['showClearSettingsOption', true],\r\n      ['showColumnHeaders', true],\r\n      ['showColumnSelector', true],\r\n      ['showCopy', false],\r\n      ['showFilter', true],\r\n      ['showFilterInCell', false],\r\n      ['showNewRow', false],\r\n      ['showOrderByOption', true],\r\n      ['showOrderByOptionTextAsc', 'Order by %s ascending'],\r\n      ['showOrderByOptionTextDesc', 'Order by %s descending'],\r\n      ['showPaste', false],\r\n      ['showPerformance', false],\r\n      ['showRowHeaders', true],\r\n      ['showRowNumbers', true],\r\n      ['showRowNumberGaps', true],\r\n      ['singleSelectionMode', false],\r\n      ['snapToRow', false],\r\n      ['sortFrozenRows', true],\r\n      ['touchContextMenuTimeMs', 800],\r\n      ['touchDeadZone', 3],\r\n      ['touchEasingMethod', 'easeOutQuad'],\r\n      ['touchReleaseAcceleration', 1000],\r\n      ['touchReleaseAnimationDurationMs', 2000],\r\n      ['touchScrollZone', 20],\r\n      ['touchSelectHandleZone', 20],\r\n      ['touchZoomSensitivity', 0.005],\r\n      ['touchZoomMin', 0.5],\r\n      ['touchZoomMax', 1.75],\r\n      ['maxPixelRatio', 2],\r\n      ['tree', false],\r\n      ['treeHorizontalScroll', false],\r\n    ],\r\n    styles: [\r\n      ['activeCellBackgroundColor', 'rgba(255, 255, 255, 1)'],\r\n      ['activeCellBorderColor', 'rgba(110, 168, 255, 1)'],\r\n      ['activeCellBorderWidth', 1],\r\n      ['activeCellColor', 'rgba(0, 0, 0, 1)'],\r\n      ['activeCellFont', '16px sans-serif'],\r\n      ['activeCellHoverBackgroundColor', 'rgba(255, 255, 255, 1)'],\r\n      ['activeCellHorizontalAlignment', 'left'],\r\n      ['activeCellHoverColor', 'rgba(0, 0, 0, 1)'],\r\n      ['activeCellOverlayBorderColor', 'rgba(66, 133, 244, 1)'],\r\n      ['activeCellOverlayBorderWidth', 1],\r\n      ['activeCellPaddingBottom', 5],\r\n      ['activeCellPaddingLeft', 5],\r\n      ['activeCellPaddingRight', 5],\r\n      ['activeCellPaddingTop', 5],\r\n      ['activeCellSelectedBackgroundColor', 'rgba(236, 243, 255, 1)'],\r\n      ['activeCellSelectedColor', 'rgba(0, 0, 0, 1)'],\r\n      ['activeCellVerticalAlignment', 'center'],\r\n      ['activeColumnHeaderCellBackgroundColor', 'rgba(225, 225, 225, 1)'],\r\n      ['activeColumnHeaderCellColor', 'rgba(0, 0, 0, 1)'],\r\n      ['activeRowHeaderCellBackgroundColor', 'rgba(225, 225, 225, 1)'],\r\n      ['activeRowHeaderCellColor', 'rgba(0, 0, 0, 1)'],\r\n      ['autocompleteBottomMargin', 60],\r\n      ['autosizeHeaderCellPadding', 8],\r\n      ['autosizePadding', 5],\r\n      ['buttonActiveBackgroundColor', 'rgba(255, 255, 255, 1)'],\r\n      ['buttonActiveBorderColor', 'rgba(110, 168, 255, 1)'],\r\n      ['buttonArrowColor', 'rgba(50, 50, 50, 1)'],\r\n      ['buttonArrowDownHTML', '&#x25BC;'],\r\n      ['buttonZIndex', 10000],\r\n      ['buttonBackgroundColor', 'rgba(255, 255, 255, 1)'],\r\n      ['buttonBorderColor', 'rgba(172, 172, 172, 1)'],\r\n      ['buttonHoverBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['buttonMenuWindowMargin', 30],\r\n      ['buttonPadding', '3px'],\r\n      ['cellAutoResizePadding', 13],\r\n      ['cellBackgroundColor', 'rgba(255, 255, 255, 1)'],\r\n      ['cellBorderColor', 'rgba(195, 199, 202, 1)'],\r\n      ['cellBorderWidth', 1],\r\n      ['cellColor', 'rgba(0, 0, 0, 1)'],\r\n      ['cellFont', '16px sans-serif'],\r\n      ['cellGridHeight', 250],\r\n      ['cellHeight', 24],\r\n      ['cellHeightWithChildGrid', 150],\r\n      ['cellHorizontalAlignment', 'left'],\r\n      ['cellHoverBackgroundColor', 'rgba(255, 255, 255, 1)'],\r\n      ['cellHoverColor', 'rgba(0, 0, 0, 1)'],\r\n      ['cellPaddingBottom', 5],\r\n      ['cellPaddingLeft', 5],\r\n      ['cellPaddingRight', 5],\r\n      ['cellPaddingTop', 5],\r\n      ['cellSelectedBackgroundColor', 'rgba(236, 243, 255, 1)'],\r\n      ['cellSelectedColor', 'rgba(0, 0, 0, 1)'],\r\n      ['cellVerticalAlignment', 'center'],\r\n      ['cellWidth', 250],\r\n      ['cellWidthWithChildGrid', 250],\r\n      ['cellWhiteSpace', 'nowrap'],\r\n      ['cellLineHeight', 1],\r\n      ['cellLineSpacing', 3],\r\n      ['childContextMenuArrowColor', 'rgba(43, 48, 43, 1)'],\r\n      ['childContextMenuArrowHTML', '&#x25BA;'],\r\n      ['childContextMenuMarginLeft', -11],\r\n      ['childContextMenuMarginTop', -6],\r\n      ['columnHeaderCellBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['columnHeaderCellBorderColor', 'rgba(172, 172, 172, 1)'],\r\n      ['columnHeaderCellBorderWidth', 1],\r\n      ['columnHeaderCellCapBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['columnHeaderCellCapBorderColor', 'rgba(172, 172, 172, 1)'],\r\n      ['columnHeaderCellCapBorderWidth', 1],\r\n      ['columnHeaderCellColor', 'rgba(50, 50, 50, 1)'],\r\n      ['columnHeaderCellFont', '16px sans-serif'],\r\n      ['columnHeaderCellHeight', 25],\r\n      ['columnHeaderCellHorizontalAlignment', 'left'],\r\n      ['columnHeaderCellHoverBackgroundColor', 'rgba(235, 235, 235, 1)'],\r\n      ['columnHeaderCellHoverColor', 'rgba(0, 0, 0, 1)'],\r\n      ['columnHeaderCellPaddingBottom', 5],\r\n      ['columnHeaderCellPaddingLeft', 5],\r\n      ['columnHeaderCellPaddingRight', 5],\r\n      ['columnHeaderCellPaddingTop', 5],\r\n      ['columnHeaderCellVerticalAlignment', 'center'],\r\n      ['columnHeaderOrderByArrowBorderColor', 'rgba(195, 199, 202, 1)'],\r\n      ['columnHeaderOrderByArrowBorderWidth', 1],\r\n      ['columnHeaderOrderByArrowColor', 'rgba(155, 155, 155, 1)'],\r\n      ['columnHeaderOrderByArrowHeight', 8],\r\n      ['columnHeaderOrderByArrowMarginLeft', 0],\r\n      ['columnHeaderOrderByArrowMarginRight', 5],\r\n      ['columnHeaderOrderByArrowMarginTop', 6],\r\n      ['columnHeaderOrderByArrowWidth', 13],\r\n      ['contextFilterButtonBorder', 'solid 1px rgba(158, 163, 169, 1)'],\r\n      ['contextFilterButtonBorderRadius', '3px'],\r\n      ['contextFilterButtonHTML', '&#x25BC;'],\r\n      ['contextFilterInputBackground', 'rgba(255,255,255,1)'],\r\n      ['contextFilterInputBorder', 'solid 1px rgba(158, 163, 169, 1)'],\r\n      ['contextFilterInputBorderRadius', '0'],\r\n      ['contextFilterInputColor', 'rgba(0,0,0,1)'],\r\n      ['contextFilterInputFontFamily', 'sans-serif'],\r\n      ['contextFilterInputFontSize', '14px'],\r\n      ['contextFilterInvalidRegExpBackground', 'rgba(180, 6, 1, 1)'],\r\n      ['contextFilterInvalidRegExpColor', 'rgba(255, 255, 255, 1)'],\r\n      ['contextMenuArrowColor', 'rgba(43, 48, 43, 1)'],\r\n      ['contextMenuArrowDownHTML', '&#x25BC;'],\r\n      ['contextMenuArrowUpHTML', '&#x25B2;'],\r\n      ['contextMenuBackground', 'rgba(240, 240, 240, 1)'],\r\n      ['contextMenuBorder', 'solid 1px rgba(158, 163, 169, 1)'],\r\n      ['contextMenuBorderRadius', '3px'],\r\n      ['contextMenuChildArrowFontSize', '12px'],\r\n      ['contextMenuColor', 'rgba(43, 48, 43, 1)'],\r\n      ['contextMenuCursor', 'default'],\r\n      ['contextMenuFilterButtonFontFamily', 'sans-serif'],\r\n      ['contextMenuFilterButtonFontSize', '10px'],\r\n      ['contextMenuFilterInvalidExpresion', 'rgba(237, 155, 156, 1)'],\r\n      ['contextMenuFontFamily', 'sans-serif'],\r\n      ['contextMenuFontSize', '16px'],\r\n      ['contextMenuHoverBackground', 'rgba(182, 205, 250, 1)'],\r\n      ['contextMenuHoverColor', 'rgba(43, 48, 153, 1)'],\r\n      ['contextMenuItemBorderRadius', '3px'],\r\n      ['contextMenuItemMargin', '2px'],\r\n      ['contextMenuLabelDisplay', 'inline-block'],\r\n      ['contextMenuLabelMargin', '0 3px 0 0'],\r\n      ['contextMenuLabelMaxWidth', '700px'],\r\n      ['contextMenuLabelMinWidth', '75px'],\r\n      ['contextMenuMarginLeft', 3],\r\n      ['contextMenuMarginTop', -3],\r\n      ['contextMenuOpacity', '0.98'],\r\n      ['contextMenuPadding', '2px'],\r\n      ['contextMenuWindowMargin', 30],\r\n      ['contextMenuZIndex', 10000],\r\n      ['cornerCellBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['cornerCellBorderColor', 'rgba(202, 202, 202, 1)'],\r\n      ['debugBackgroundColor', 'rgba(0, 0, 0, .0)'],\r\n      ['debugColor', 'rgba(255, 15, 24, 1)'],\r\n      ['debugEntitiesColor', 'rgba(76, 231, 239, 1.00)'],\r\n      ['debugFont', '11px sans-serif'],\r\n      ['debugPerfChartBackground', 'rgba(29, 25, 26, 1.00)'],\r\n      ['debugPerfChartTextColor', 'rgba(255, 255, 255, 0.8)'],\r\n      ['debugPerformanceColor', 'rgba(252, 255, 37, 1.00)'],\r\n      ['debugScrollHeightColor', 'rgba(248, 33, 103, 1.00)'],\r\n      ['debugScrollWidthColor', 'rgba(66, 255, 27, 1.00)'],\r\n      ['debugTouchPPSXColor', 'rgba(246, 102, 24, 1.00)'],\r\n      ['debugTouchPPSYColor', 'rgba(186, 0, 255, 1.00)'],\r\n      ['display', 'inline-block'],\r\n      ['editCellBackgroundColor', 'white'],\r\n      ['editCellBorder', 'solid 1px rgba(110, 168, 255, 1)'],\r\n      ['editCellBoxShadow', '0 2px 5px rgba(0,0,0,0.4)'],\r\n      ['editCellColor', 'black'],\r\n      ['editCellFontFamily', 'sans-serif'],\r\n      ['editCellFontSize', '16px'],\r\n      ['editCellPaddingLeft', 4],\r\n      ['editCellZIndex', 10000],\r\n      ['filterButtonActiveBackgroundColor', 'rgba(225, 225, 225, 1)'],\r\n      ['filterButtonArrowBorderColor', 'rgba(195, 199, 202, 1)'],\r\n      ['filterButtonArrowBorderWidth', 1],\r\n      ['filterButtonArrowClickRadius', 5],\r\n      ['filterButtonArrowColor', 'rgba(50, 50, 50, 1)'],\r\n      ['filterButtonArrowHeight', 5],\r\n      ['filterButtonArrowWidth', 8],\r\n      ['filterButtonBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['filterButtonBorderColor', 'rgba(172, 172, 172, 1)'],\r\n      ['filterButtonBorderRadius', 3],\r\n      ['filterButtonHeight', 20],\r\n      ['filterButtonHoverBackgroundColor', 'rgba(235, 235, 235, 1)'],\r\n      ['filterButtonMenuOffsetTop', 10],\r\n      ['filterButtonWidth', 20],\r\n      ['frozenMarkerHoverColor', 'rgba(236, 243, 255, 1)'],\r\n      ['frozenMarkerHoverBorderColor', 'rgba(110, 168, 255, 1)'],\r\n      ['frozenMarkerActiveColor', 'rgba(236, 243, 255, 1)'],\r\n      ['frozenMarkerActiveBorderColor', 'rgba(110, 168, 255, 1)'],\r\n      ['frozenMarkerColor', 'rgba(222, 222, 222, 1)'],\r\n      ['frozenMarkerBorderColor', 'rgba(168, 168, 168, 1)'],\r\n      ['frozenMarkerBorderWidth', 1],\r\n      ['frozenMarkerWidth', 2],\r\n      ['gridBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['gridBorderCollapse', 'collapse'],\r\n      ['gridBorderColor', 'rgba(202, 202, 202, 1)'],\r\n      ['gridBorderWidth', 1],\r\n      ['height', 'auto'],\r\n      ['maxHeight', 'inherit'],\r\n      ['maxWidth', 'inherit'],\r\n      ['minColumnWidth', 45],\r\n      ['minHeight', 'inherit'],\r\n      ['minRowHeight', 24],\r\n      ['minWidth', 'inherit'],\r\n      ['mobileContextMenuMargin', 10],\r\n      ['mobileEditInputHeight', 30],\r\n      ['mobileEditFontFamily', 'sans-serif'],\r\n      ['mobileEditFontSize', '16px'],\r\n      ['moveOverlayBorderWidth', 1],\r\n      ['moveOverlayBorderColor', 'rgba(66, 133, 244, 1)'],\r\n      ['moveOverlayBorderSegments', '12, 7'],\r\n      ['name', 'default'],\r\n      ['overflowY', 'auto'],\r\n      ['overflowX', 'auto'],\r\n      ['reorderMarkerBackgroundColor', 'rgba(0, 0, 0, 0.1)'],\r\n      ['reorderMarkerBorderColor', 'rgba(0, 0, 0, 0.2)'],\r\n      ['reorderMarkerBorderWidth', 1.25],\r\n      ['reorderMarkerIndexBorderColor', 'rgba(66, 133, 244, 1)'],\r\n      ['reorderMarkerIndexBorderWidth', 2.75],\r\n      ['rowHeaderCellBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['rowHeaderCellBorderColor', 'rgba(200, 200, 200, 1)'],\r\n      ['rowHeaderCellBorderWidth', 1],\r\n      ['rowHeaderCellColor', 'rgba(50, 50, 50, 1)'],\r\n      ['rowHeaderCellFont', '16px sans-serif'],\r\n      ['rowHeaderCellHeight', 25],\r\n      ['rowHeaderCellHorizontalAlignment', 'left'],\r\n      ['rowHeaderCellHoverBackgroundColor', 'rgba(235, 235, 235, 1)'],\r\n      ['rowHeaderCellHoverColor', 'rgba(0, 0, 0, 1)'],\r\n      ['rowHeaderCellPaddingBottom', 5],\r\n      ['rowHeaderCellPaddingLeft', 5],\r\n      ['rowHeaderCellPaddingRight', 5],\r\n      ['rowHeaderCellPaddingTop', 5],\r\n      ['rowHeaderCellRowNumberGapHeight', 5],\r\n      ['rowHeaderCellRowNumberGapColor', 'rgba(50, 50, 50, 1)'],\r\n      ['rowHeaderCellSelectedBackgroundColor', 'rgba(217, 217, 217, 1)'],\r\n      ['rowHeaderCellSelectedColor', 'rgba(50, 50, 50, 1)'],\r\n      ['rowHeaderCellVerticalAlignment', 'center'],\r\n      ['rowHeaderCellWidth', 57],\r\n      ['scrollBarActiveColor', 'rgba(125, 125, 125, 1)'],\r\n      ['scrollBarBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['scrollBarBorderColor', 'rgba(202, 202, 202, 1)'],\r\n      ['scrollBarBorderWidth', 0.5],\r\n      ['scrollBarBoxBorderRadius', 4.125],\r\n      ['scrollBarBoxColor', 'rgba(192, 192, 192, 1)'],\r\n      ['scrollBarBoxMargin', 2],\r\n      ['scrollBarBoxMinSize', 15],\r\n      ['scrollBarBoxWidth', 8],\r\n      ['scrollBarCornerBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['scrollBarCornerBorderColor', 'rgba(202, 202, 202, 1)'],\r\n      ['scrollBarWidth', 11],\r\n      ['selectionHandleBorderColor', 'rgba(255, 255, 255, 1)'],\r\n      ['selectionHandleBorderWidth', 1.5],\r\n      ['selectionHandleColor', 'rgba(66, 133, 244, 1)'],\r\n      ['selectionHandleSize', 8],\r\n      ['selectionHandleType', 'square'],\r\n      ['selectionOverlayBorderColor', 'rgba(66, 133, 244, 1)'],\r\n      ['selectionOverlayBorderWidth', 1],\r\n      ['treeArrowBorderColor', 'rgba(195, 199, 202, 1)'],\r\n      ['treeArrowBorderWidth', 1],\r\n      ['treeArrowClickRadius', 5],\r\n      ['treeArrowColor', 'rgba(155, 155, 155, 1)'],\r\n      ['treeArrowHeight', 8],\r\n      ['treeArrowMarginLeft', 0],\r\n      ['treeArrowMarginRight', 5],\r\n      ['treeArrowMarginTop', 6],\r\n      ['treeArrowWidth', 13],\r\n      ['treeGridHeight', 250],\r\n      ['width', 'auto'],\r\n    ],\r\n  };\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  self.getClippingRect = function (ele) {\r\n    var boundingRect = self.position(self.parentNode),\r\n      eleRect = self.position(ele),\r\n      s = self.scrollOffset(self.canvas),\r\n      clipRect = {\r\n        x: 0,\r\n        y: 0,\r\n        h: 0,\r\n        w: 0,\r\n      },\r\n      parentRect = {\r\n        x: -Infinity,\r\n        y: -Infinity,\r\n        h: Infinity,\r\n        w: Infinity,\r\n      },\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight(),\r\n      rowHeaderCellWidth = self.getRowHeaderCellWidth();\r\n    boundingRect.top -= s.top;\r\n    boundingRect.left -= s.left;\r\n    eleRect.top -= s.top;\r\n    eleRect.left -= s.left;\r\n    clipRect.h =\r\n      boundingRect.top +\r\n      boundingRect.height -\r\n      ele.offsetTop -\r\n      self.style.scrollBarWidth;\r\n    clipRect.w =\r\n      boundingRect.left +\r\n      boundingRect.width -\r\n      ele.offsetLeft -\r\n      self.style.scrollBarWidth;\r\n    clipRect.x = boundingRect.left + eleRect.left * -1 + rowHeaderCellWidth;\r\n    clipRect.y = boundingRect.top + eleRect.top * -1 + columnHeaderCellHeight;\r\n    return {\r\n      x: clipRect.x > parentRect.x ? clipRect.x : parentRect.x,\r\n      y: clipRect.y > parentRect.y ? clipRect.y : parentRect.y,\r\n      h: clipRect.h < parentRect.h ? clipRect.h : parentRect.h,\r\n      w: clipRect.w < parentRect.w ? clipRect.w : parentRect.w,\r\n    };\r\n  };\r\n  self.clipElement = function (ele) {\r\n    var clipRect = self.getClippingRect(ele);\r\n    if (clipRect.w < 0) {\r\n      clipRect.w = 0;\r\n    }\r\n    if (clipRect.h < 0) {\r\n      clipRect.h = 0;\r\n    }\r\n    ele.style.clip =\r\n      'rect(' +\r\n      clipRect.y +\r\n      'px,' +\r\n      clipRect.w +\r\n      'px,' +\r\n      clipRect.h +\r\n      'px,' +\r\n      clipRect.x +\r\n      'px' +\r\n      ')';\r\n    // INFO https://developer.mozilla.org/en-US/docs/Web/CSS/clip\r\n    // clip has been \"deprecated\" for clipPath.  Of course nothing but chrome\r\n    // supports clip path, so we'll keep using clip until someday clipPath becomes\r\n    // more widely support.  The code below works correctly, but setting clipPath and clip\r\n    // at the same time has undesirable results.\r\n    // ele.style.clipPath = 'polygon('\r\n    //     + clipRect.x + 'px ' + clipRect.y + 'px,'\r\n    //     + clipRect.x + 'px ' + clipRect.h + 'px,'\r\n    //     + clipRect.w + 'px ' + clipRect.h + 'px,'\r\n    //     + clipRect.w + 'px ' + clipRect.y + 'px'\r\n    //     + ')';\r\n  };\r\n  self.scrollOffset = function (e) {\r\n    var x = 0,\r\n      y = 0,\r\n      scrollingElement = document.scrollingElement || {\r\n        scrollLeft: 0,\r\n        scrollTop: 0,\r\n      };\r\n    while (\r\n      e.parentNode &&\r\n      e.nodeName !== 'CANVAS-DATAGRID' &&\r\n      e !== self.intf\r\n    ) {\r\n      if (\r\n        e.nodeType !== 'canvas-datagrid-tree' &&\r\n        e.nodeType !== 'canvas-datagrid-cell'\r\n      ) {\r\n        x -= e.scrollLeft;\r\n        y -= e.scrollTop;\r\n      }\r\n      e = e.parentNode;\r\n    }\r\n    return {\r\n      left: x - scrollingElement.scrollLeft,\r\n      top: y - scrollingElement.scrollTop,\r\n    };\r\n  };\r\n  self.resizeEditInput = function () {\r\n    if (self.input && self.input.editCell) {\r\n      var pos = self.canvas.getBoundingClientRect(),\r\n        s = self.scrollOffset(self.intf),\r\n        bm = self.style.gridBorderCollapse === 'collapse' ? 1 : 2,\r\n        borderWidth = self.style.cellBorderWidth * bm,\r\n        cell = self.getVisibleCellByIndex(\r\n          self.input.editCell.columnIndex,\r\n          self.input.editCell.rowIndex,\r\n        ) || { x: -100, y: -100, height: 0, width: 0 };\r\n      if (self.mobile) {\r\n        self.input.style.left = '0';\r\n        self.input.style.top =\r\n          self.height -\r\n          self.style.mobileEditInputHeight -\r\n          borderWidth -\r\n          1 +\r\n          'px';\r\n        self.input.style.height = self.style.mobileEditInputHeight + 'px';\r\n        self.input.style.width = self.width - borderWidth - 1 + 'px';\r\n        return;\r\n      }\r\n      self.input.style.left =\r\n        pos.left + cell.x + self.canvasOffsetLeft - s.left + 'px';\r\n      self.input.style.top =\r\n        pos.top +\r\n        cell.y -\r\n        self.style.cellBorderWidth +\r\n        self.canvasOffsetTop -\r\n        s.top +\r\n        'px';\r\n      self.input.style.height = cell.height - borderWidth + 'px';\r\n      self.input.style.width = cell.width - self.style.cellPaddingLeft + 'px';\r\n      self.clipElement(self.input);\r\n    }\r\n  };\r\n  self.position = function (e, ignoreScrollOffset) {\r\n    var x = 0,\r\n      y = 0,\r\n      s = e,\r\n      h,\r\n      w;\r\n    while (e.offsetParent && e.nodeName !== 'CANVAS-DATAGRID') {\r\n      x += e.offsetLeft;\r\n      y += e.offsetTop;\r\n      h = e.offsetHeight;\r\n      w = e.offsetWidth;\r\n      e = e.offsetParent;\r\n    }\r\n    if (ignoreScrollOffset) {\r\n      return { left: x, top: y, height: h, width: w };\r\n    }\r\n    e = s;\r\n    s = self.scrollOffset(e);\r\n    return { left: x + s.left, top: y + s.top, height: h, width: w };\r\n  };\r\n  self.getLayerPos = function (e) {\r\n    var rect = self.canvas.getBoundingClientRect(),\r\n      pos = {\r\n        x: e.clientX - rect.left,\r\n        y: e.clientY - rect.top,\r\n      };\r\n    if (self.isChildGrid) {\r\n      pos.x -= self.canvasOffsetLeft;\r\n      pos.y -= self.canvasOffsetTop;\r\n    }\r\n    return {\r\n      x: pos.x,\r\n      y: pos.y,\r\n      rect: rect,\r\n    };\r\n  };\r\n  /**\r\n   * Ends editing, optionally aborting the edit.\r\n   * @memberof canvasDatagrid\r\n   * @name endEdit\r\n   * @method\r\n   * @param {boolean} abort When true, abort the edit.\r\n   */\r\n  self.endEdit = function (abort) {\r\n    var cell = self.input.editCell,\r\n      y = cell.rowIndex;\r\n    function abortEdit() {\r\n      abort = true;\r\n    }\r\n    if (\r\n      self.dispatchEvent('beforeendedit', {\r\n        cell: cell,\r\n        newValue: self.input.value,\r\n        oldValue: cell.value,\r\n        abort: abortEdit,\r\n        input: self.input,\r\n      })\r\n    ) {\r\n      return false;\r\n    }\r\n    if (self.input.value !== cell.value && !abort) {\r\n      self.changes[y] = self.changes[y] || {};\r\n      self.changes[y][cell.header.name] = self.input.value;\r\n      if (!cell.data) {\r\n        self.originalData[cell.boundRowIndex] = {};\r\n        cell.data = self.originalData[cell.boundRowIndex];\r\n      }\r\n      cell.data[cell.header.name] = self.input.value;\r\n      if (y === self.viewData.length) {\r\n        if (\r\n          self.dispatchEvent('newrow', {\r\n            value: self.input.value,\r\n            defaultValue: cell.value,\r\n            aborted: abort,\r\n            cell: cell,\r\n            input: self.input,\r\n          })\r\n        ) {\r\n          return false;\r\n        }\r\n        self.addRow(cell.data);\r\n        self.createNewRowData();\r\n      }\r\n      self.draw(true);\r\n    }\r\n    if (self.input.parentNode) {\r\n      self.input.parentNode.removeChild(self.input);\r\n    }\r\n    self.intf.focus();\r\n    self.dispatchEvent('endedit', {\r\n      cell: cell,\r\n      value: self.input.value,\r\n      aborted: abort,\r\n      input: self.input,\r\n    });\r\n    self.input = undefined;\r\n    return true;\r\n  };\r\n  /**\r\n   * Begins editing at cell x, row y.\r\n   * @memberof canvasDatagrid\r\n   * @name beginEditAt\r\n   * @method\r\n   * @param {number} x The column index of the cell to edit.\r\n   * @param {number} y The row index of the cell to edit.\r\n   * @param {boolean} inEnterMode If true, starting to type in cell will replace the\r\n   * cell's previous value instead of appending, and using the arrow keys will allow\r\n   * the user to navigate to adjacent cells instead of moving the text cursor around\r\n   * (default is false, and means user is in 'edit' mode).\r\n   */\r\n  self.beginEditAt = function (x, y, NativeEvent, inEnterMode = false) {\r\n    if (!self.attributes.editable) {\r\n      return;\r\n    }\r\n    if (self.input) {\r\n      self.endEdit();\r\n    }\r\n    var cell = self.getVisibleCellByIndex(x, y),\r\n      s = self.getSchema(),\r\n      adjacentCells,\r\n      enumItems,\r\n      enu,\r\n      option,\r\n      valueInEnum;\r\n    if (!(cell && cell.header)) {\r\n      return;\r\n    }\r\n    //HACK for IE10, does not like literal enum\r\n    enu = cell.header['enum'];\r\n    if (\r\n      self.dispatchEvent('beforebeginedit', {\r\n        cell: cell,\r\n        NativeEvent: NativeEvent,\r\n      })\r\n    ) {\r\n      return false;\r\n    }\r\n    self.scrollIntoView(x, y);\r\n    self.setActiveCell(x, y);\r\n    adjacentCells = self.getAdjacentCells();\r\n    if (enu) {\r\n      self.input = document.createElement('select');\r\n    } else {\r\n      self.input = document.createElement(\r\n        self.attributes.multiLine ? 'textarea' : 'input',\r\n      );\r\n    }\r\n    cell = self.getVisibleCellByIndex(x, y);\r\n    //HACK on mobile devices sometimes edit can begin without the cell being in view, I don't know how.\r\n    if (!cell) {\r\n      return;\r\n    }\r\n    if (enu) {\r\n      // add enums\r\n      if (typeof enu === 'function') {\r\n        enumItems = enu.apply(self.intf, [{ cell: cell }]);\r\n      } else if (Array.isArray(enu)) {\r\n        enumItems = enu;\r\n      }\r\n      enumItems.forEach(function (e) {\r\n        var i = document.createElement('option'),\r\n          val,\r\n          title;\r\n        if (Array.isArray(e)) {\r\n          val = e[0];\r\n          title = e[1];\r\n        } else {\r\n          val = e;\r\n          title = e;\r\n        }\r\n        if (val === cell.value) {\r\n          valueInEnum = true;\r\n        }\r\n        i.value = val;\r\n        i.innerHTML = title;\r\n        self.input.appendChild(i);\r\n      });\r\n      if (!valueInEnum) {\r\n        option = document.createElement('option');\r\n        option.value = cell.value;\r\n        option.innerHTML = cell.value;\r\n        self.input.appendChild(option);\r\n      }\r\n      self.input.addEventListener('change', function () {\r\n        self.endEdit();\r\n        self.draw(true);\r\n      });\r\n    }\r\n    // if the user has not prevented the default action, append to the body\r\n    if (\r\n      !self.dispatchEvent('appendeditinput', { cell: cell, input: self.input })\r\n    ) {\r\n      document.body.appendChild(self.input);\r\n    }\r\n    self.createInlineStyle(\r\n      self.input,\r\n      self.mobile\r\n        ? 'canvas-datagrid-edit-mobile-input'\r\n        : 'canvas-datagrid-edit-input',\r\n    );\r\n    self.input.style.position = 'absolute';\r\n    self.input.editCell = cell;\r\n    self.resizeEditInput();\r\n    self.input.style.zIndex = self.style.editCellZIndex;\r\n    self.input.style.fontSize =\r\n      parseInt(self.style.editCellFontSize, 10) * self.scale + 'px';\r\n\r\n    var cellValueIsEmpty = [null, undefined].indexOf(cell.value) !== -1;\r\n    var shouldClearCellValue = cellValueIsEmpty || inEnterMode;\r\n\r\n    self.input.value = shouldClearCellValue ? '' : cell.value;\r\n    self.input.focus();\r\n    self.input.addEventListener('click', self.stopPropagation);\r\n    self.input.addEventListener('dblclick', self.stopPropagation);\r\n    self.input.addEventListener('mouseup', self.stopPropagation);\r\n    self.input.addEventListener('mousedown', self.stopPropagation);\r\n    self.input.addEventListener('keydown', function (e) {\r\n      var nx = cell.columnIndex,\r\n        ny = cell.rowIndex;\r\n\r\n      if (e.key === 'Escape') {\r\n        self.endEdit(true); // end edit and abort the value change\r\n        self.draw(true);\r\n      } else if (e.key === 'Enter' && self.attributes.multiLine && e.altKey) {\r\n        self.input.value = self.input.value + '\\n';\r\n        self.input.scrollTop = self.input.scrollHeight;\r\n      } else if (e.key === 'Enter') {\r\n        self.endEdit();\r\n\r\n        // Move to cell in next or previous row\r\n        var nextRowIndex = e.shiftKey\r\n          ? Math.max(0, ny - 1)\r\n          : Math.min(ny + 1, self.viewData.length - 1);\r\n\r\n        if (nextRowIndex !== ny) {\r\n          self.scrollIntoView(nx, nextRowIndex);\r\n          self.setActiveCell(nx, nextRowIndex);\r\n        }\r\n\r\n        self.draw(true);\r\n      } else if (\r\n        ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key) &&\r\n        inEnterMode\r\n      ) {\r\n        switch (e.key) {\r\n          case 'ArrowUp':\r\n            ny = Math.max(0, ny - 1);\r\n            break;\r\n          case 'ArrowDown':\r\n            ny = Math.min(ny + 1, self.viewData.length - 1);\r\n            break;\r\n          case 'ArrowLeft':\r\n            nx = Math.max(nx - 1, 0);\r\n            break;\r\n          case 'ArrowRight':\r\n            nx = adjacentCells.right;\r\n            break;\r\n        }\r\n\r\n        self.endEdit();\r\n\r\n        self.scrollIntoView(nx, ny);\r\n        self.setActiveCell(nx, ny);\r\n\r\n        self.draw(true);\r\n      } else if (e.key === 'Tab') {\r\n        e.preventDefault();\r\n        if (!self.endEdit()) {\r\n          return;\r\n        }\r\n        if (e.shiftKey) {\r\n          nx = adjacentCells.left;\r\n        } else {\r\n          nx = adjacentCells.right;\r\n        }\r\n        if (adjacentCells.left === x && e.shiftKey) {\r\n          nx = adjacentCells.last;\r\n          ny -= 1;\r\n        }\r\n        if (adjacentCells.right === x && !e.shiftKey) {\r\n          nx = adjacentCells.first;\r\n          ny += 1;\r\n        }\r\n        if (ny < 0) {\r\n          ny = self.viewData.length - 1;\r\n        }\r\n        if (ny > self.viewData.length - 1) {\r\n          ny = 0;\r\n        }\r\n        self.scrollIntoView(nx, ny);\r\n        self.beginEditAt(nx, ny, e);\r\n      }\r\n    });\r\n\r\n    self.dispatchEvent('beginedit', { cell: cell, input: self.input });\r\n  };\r\n  self.createInlineStyle = function (el, className) {\r\n    var css = {\r\n      'canvas-datagrid-button-wrapper': {\r\n        display: 'inline-block',\r\n        padding: self.style.buttonPadding,\r\n        borderWidth: '1px',\r\n        borderStyle: 'solid',\r\n        borderColor: self.style.buttonBorderColor,\r\n        cursor: 'pointer',\r\n        background: self.style.buttonBackgroundColor,\r\n        userSelect: 'none',\r\n      },\r\n      'canvas-datagrid-button-wrapper:hover': {\r\n        borderColor: self.style.buttonBorderColor,\r\n        background: self.style.buttonHoverBackgroundColor,\r\n      },\r\n      'canvas-datagrid-button-wrapper:active': {\r\n        borderColor: self.style.buttonActiveBorderColor,\r\n        background: self.style.buttonActiveBackgroundColor,\r\n      },\r\n      'canvas-datagrid-button-icon': {\r\n        width: '18px',\r\n        height: '18px',\r\n        display: 'inline-block',\r\n        verticalAlign: 'middle',\r\n      },\r\n      'canvas-datagrid-button-arrow': {\r\n        display: 'inline-block',\r\n        color: self.style.buttonArrowColor,\r\n        fontSize: '9px',\r\n      },\r\n      'canvas-datagrid-button-menu-item-mobile': {\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n        color: 'inherit',\r\n        background: 'inherit',\r\n        margin: self.style.contextMenuItemMargin,\r\n        borderRadius: self.style.contextMenuItemBorderRadius,\r\n        verticalAlign: 'middle',\r\n      },\r\n      'canvas-datagrid-button-menu-item': {\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n        color: 'inherit',\r\n        background: 'inherit',\r\n        margin: self.style.contextMenuItemMargin,\r\n        borderRadius: self.style.contextMenuItemBorderRadius,\r\n        verticalAlign: 'middle',\r\n      },\r\n      'canvas-datagrid-button-menu-item:hover': {\r\n        background: self.style.contextMenuHoverBackground,\r\n        color: self.style.contextMenuHoverColor,\r\n      },\r\n      'canvas-datagrid-button-menu-label': {\r\n        margin: self.style.contextMenuLabelMargin,\r\n        display: self.style.contextMenuLabelDisplay,\r\n        minWidth: self.style.contextMenuLabelMinWidth,\r\n        maxWidth: self.style.contextMenuLabelMaxWidth,\r\n      },\r\n      'canvas-datagrid-button-menu-mobile': {\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n        background: self.style.contextMenuBackground,\r\n        color: self.style.contextMenuColor,\r\n        border: self.style.contextMenuBorder,\r\n        padding: self.style.contextMenuPadding,\r\n        borderRadius: self.style.contextMenuBorderRadius,\r\n        opacity: self.style.contextMenuOpacity,\r\n        overflow: 'hidden',\r\n        whiteSpace: 'nowrap',\r\n      },\r\n      'canvas-datagrid-button-menu': {\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n        background: self.style.contextMenuBackground,\r\n        color: self.style.contextMenuColor,\r\n        border: self.style.contextMenuBorder,\r\n        padding: self.style.contextMenuPadding,\r\n        borderRadius: self.style.contextMenuBorderRadius,\r\n        opacity: self.style.contextMenuOpacity,\r\n        overflow: 'hidden',\r\n        whiteSpace: 'nowrap',\r\n        cursor: self.style.contextMenuCursor,\r\n      },\r\n      'canvas-datagrid-context-menu-filter-input': {\r\n        height: '19px',\r\n        verticalAlign: 'bottom',\r\n        marginLeft: '2px',\r\n        padding: '0',\r\n        background: self.style.contextFilterInputBackground,\r\n        color: self.style.contextFilterInputColor,\r\n        border: self.style.contextFilterInputBorder,\r\n        borderRadius: self.style.contextFilterInputBorderRadius,\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextFilterInputFontFamily,\r\n        fontSize: self.style.contextFilterInputFontSize,\r\n      },\r\n      'canvas-datagrid-context-menu-filter-button': {\r\n        height: '19px',\r\n        verticalAlign: 'bottom',\r\n        marginLeft: '2px',\r\n        padding: '0',\r\n        background: self.style.contextMenuBackground,\r\n        color: self.style.contextMenuColor,\r\n        border: self.style.contextFilterButtonBorder,\r\n        borderRadius: self.style.contextFilterButtonBorderRadius,\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFilterButtonFontFamily,\r\n        fontSize: self.style.contextMenuFilterButtonFontSize,\r\n      },\r\n      'canvas-datagrid-context-child-arrow': {\r\n        cssFloat: 'right',\r\n        color: self.style.childContextMenuArrowColor,\r\n        fontSize: self.style.contextMenuChildArrowFontSize,\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        verticalAlign: 'middle',\r\n      },\r\n      'canvas-datagrid-autocomplete': {\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n        background: self.style.contextMenuBackground,\r\n        color: self.style.contextMenuColor,\r\n        border: self.style.contextMenuBorder,\r\n        padding: self.style.contextMenuPadding,\r\n        borderRadius: self.style.contextMenuBorderRadius,\r\n        opacity: self.style.contextMenuOpacity,\r\n        position: 'absolute',\r\n        zIndex: 9999,\r\n        overflow: 'hidden',\r\n      },\r\n      'canvas-datagrid-autocomplete-item': {\r\n        background: self.style.contextMenuBackground,\r\n        color: self.style.contextMenuColor,\r\n      },\r\n      'canvas-datagrid-autocomplete-item:hover': {\r\n        background: self.style.contextMenuHoverBackground,\r\n        color: self.style.contextMenuHoverColor,\r\n      },\r\n      'canvas-datagrid-canvas': {\r\n        position: 'absolute',\r\n        zIndex: '-1',\r\n      },\r\n      'canvas-datagrid': {\r\n        display: 'block',\r\n      },\r\n      'canvas-datagrid-control-input': {\r\n        position: 'fixed',\r\n        top: '-5px',\r\n        left: '-5px',\r\n        border: 'none',\r\n        opacity: '0',\r\n        cursor: 'pointer',\r\n        width: '1px',\r\n        height: '1px',\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n      },\r\n      'canvas-datagrid-edit-mobile-input': {\r\n        boxSizing: 'content-box',\r\n        outline: 'none',\r\n        margin: '0',\r\n        padding: '0 0 0 0',\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.mobileEditFontFamily,\r\n        fontSize: self.style.mobileEditFontSize,\r\n        border: self.style.editCellBorder,\r\n        color: self.style.editCellColor,\r\n        background: self.style.editCellBackgroundColor,\r\n        appearance: 'none',\r\n        webkitAppearance: 'none',\r\n        mozAppearance: 'none',\r\n        borderRadius: '0',\r\n      },\r\n      'canvas-datagrid-edit-input': {\r\n        boxSizing: 'content-box',\r\n        outline: 'none',\r\n        margin: '0',\r\n        padding: '0 0 0 ' + self.style.editCellPaddingLeft + 'px',\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.editCellFontFamily,\r\n        fontSize: self.style.editCellFontSize,\r\n        boxShadow: self.style.editCellBoxShadow,\r\n        border: self.style.editCellBorder,\r\n        color: self.style.editCellColor,\r\n        background: self.style.editCellBackgroundColor,\r\n        appearance: 'none',\r\n        webkitAppearance: 'none',\r\n        mozAppearance: 'none',\r\n        borderRadius: '0',\r\n      },\r\n      'canvas-datagrid-context-menu-item-mobile': {\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n        color: 'inherit',\r\n        background: 'inherit',\r\n        margin: self.style.contextMenuItemMargin,\r\n        borderRadius: self.style.contextMenuItemBorderRadius,\r\n        verticalAlign: 'middle',\r\n      },\r\n      'canvas-datagrid-context-menu-item': {\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n        color: 'inherit',\r\n        background: 'inherit',\r\n        margin: self.style.contextMenuItemMargin,\r\n        borderRadius: self.style.contextMenuItemBorderRadius,\r\n        verticalAlign: 'middle',\r\n      },\r\n      'canvas-datagrid-context-menu-item:hover': {\r\n        background: self.style.contextMenuHoverBackground,\r\n        color: self.style.contextMenuHoverColor,\r\n      },\r\n      'canvas-datagrid-context-menu-label': {\r\n        margin: self.style.contextMenuLabelMargin,\r\n        display: self.style.contextMenuLabelDisplay,\r\n        minWidth: self.style.contextMenuLabelMinWidth,\r\n        maxWidth: self.style.contextMenuLabelMaxWidth,\r\n      },\r\n      'canvas-datagrid-context-menu-mobile': {\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n        background: self.style.contextMenuBackground,\r\n        color: self.style.contextMenuColor,\r\n        border: self.style.contextMenuBorder,\r\n        padding: self.style.contextMenuPadding,\r\n        borderRadius: self.style.contextMenuBorderRadius,\r\n        opacity: self.style.contextMenuOpacity,\r\n        overflow: 'hidden',\r\n        whiteSpace: 'nowrap',\r\n      },\r\n      'canvas-datagrid-context-menu': {\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n        background: self.style.contextMenuBackground,\r\n        color: self.style.contextMenuColor,\r\n        border: self.style.contextMenuBorder,\r\n        padding: self.style.contextMenuPadding,\r\n        borderRadius: self.style.contextMenuBorderRadius,\r\n        opacity: self.style.contextMenuOpacity,\r\n        overflow: 'hidden',\r\n        whiteSpace: 'nowrap',\r\n        cursor: self.style.contextMenuCursor,\r\n      },\r\n      'canvas-datagrid-invalid-search-regExp': {\r\n        background: self.style.contextMenuFilterInvalidExpresion,\r\n      },\r\n    };\r\n    if (css[className]) {\r\n      Object.keys(css[className]).map(function (prop) {\r\n        el.style[prop] = css[className][prop];\r\n      });\r\n    }\r\n    return;\r\n  };\r\n  self.appendTo = function (e) {\r\n    self.parentNode = e;\r\n    self.setDom();\r\n  };\r\n  self.setDom = function () {\r\n    if (self.isChildGrid) {\r\n      self.parentGrid = self.parentNode.parentGrid;\r\n      self.ctx = self.parentGrid.context;\r\n      self.canvas = self.parentGrid.canvas;\r\n      self.controlInput = self.parentGrid.controlInput;\r\n      self.eventParent = self.canvas;\r\n    } else {\r\n      self.controlInput = self.controlInput || document.createElement('input');\r\n      self.controlInput.onblur = self.intf.blur;\r\n      self.createInlineStyle(\r\n        self.controlInput,\r\n        'canvas-datagrid-control-input',\r\n      );\r\n      self.isChildGrid = false;\r\n      self.parentDOMNode = self.parentNode;\r\n      self.parentIsCanvas = /^canvas$/i.test(self.parentDOMNode.tagName);\r\n      if (self.parentIsCanvas) {\r\n        self.canvas = self.parentDOMNode;\r\n      } else {\r\n        self.canvas = document.createElement('canvas');\r\n        self.parentDOMNode.appendChild(self.canvas);\r\n      }\r\n      document.body.appendChild(self.controlInput);\r\n      self.createInlineStyle(self.canvas, 'canvas-datagrid');\r\n      self.ctx = self.canvas.getContext('2d');\r\n      self.ctx.textBaseline = 'alphabetic';\r\n      self.eventParent = self.canvas;\r\n    }\r\n    self.parentNodeStyle = self.canvas.style;\r\n    self.controlInput.setAttribute('readonly', true);\r\n    self.controlInput.addEventListener('blur', function (e) {\r\n      if (e.target !== self.canvas) {\r\n        self.hasFocus = false;\r\n      }\r\n    });\r\n    self.eventParent.addEventListener('scroll', self.resize, false);\r\n    self.eventParent.addEventListener('touchstart', self.touchstart, false);\r\n    self.eventParent.addEventListener('mouseup', self.mouseup, false);\r\n    self.eventParent.addEventListener('mousedown', self.mousedown, false);\r\n    self.eventParent.addEventListener('dblclick', self.dblclick, false);\r\n    self.eventParent.addEventListener('click', self.click, false);\r\n    document.body.addEventListener('mousemove', self.mousemove);\r\n    self[self.isChildGrid ? 'parentGrid' : 'eventParent'].addEventListener(\r\n      'wheel',\r\n      self.scrollWheel,\r\n      false,\r\n    );\r\n    self.canvas.addEventListener('contextmenu', self.contextmenuEvent, false);\r\n    self.controlInput.addEventListener('copy', self.copy);\r\n    self.controlInput.addEventListener('cut', self.cut);\r\n    self.controlInput.addEventListener('paste', self.paste);\r\n    self.controlInput.addEventListener('keypress', self.keypress, false);\r\n    self.controlInput.addEventListener('keyup', self.keyup, false);\r\n    self.controlInput.addEventListener('keydown', self.keydown, false);\r\n    window.addEventListener('resize', self.resize);\r\n  };\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals XMLSerializer: false, define: true, Blob: false, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  var perfCounters = [],\r\n    cachedImagesDrawn = false,\r\n    drawCount = 0,\r\n    perfWindowSize = 300,\r\n    entityCount = [],\r\n    hiddenFrozenColumnCount = 0,\r\n    scrollDebugCounters = [],\r\n    touchPPSCounters = [];\r\n  self.htmlImageCache = {};\r\n  // more heavyweight version than fillArray defined in intf.js\r\n  function fillArray(low, high, step, def) {\r\n    step = step || 1;\r\n    var i = [],\r\n      x;\r\n    for (x = low; x <= high; x += step) {\r\n      i[x] = def === undefined ? x : typeof def === 'function' ? def(x) : def;\r\n    }\r\n    return i;\r\n  }\r\n  function drawPerfLine(w, h, x, y, perfArr, arrIndex, max, color, useAbs) {\r\n    var i = w / perfArr.length,\r\n      r = h / max;\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.beginPath();\r\n    self.ctx.moveTo(x, y + h);\r\n    perfArr.forEach(function (n) {\r\n      var val = arrIndex === undefined ? n : n[arrIndex],\r\n        cx,\r\n        cy;\r\n      if (useAbs) {\r\n        val = Math.abs(val);\r\n      }\r\n      cx = x + i;\r\n      cy = y + h - val * r;\r\n      self.ctx.lineTo(cx, cy);\r\n      x += i;\r\n    });\r\n    self.ctx.moveTo(x + w, y + h);\r\n    self.ctx.strokeStyle = color;\r\n    self.ctx.stroke();\r\n  }\r\n  function drawOnAllImagesLoaded() {\r\n    var loaded = true;\r\n    Object.keys(self.htmlImageCache).forEach(function (html) {\r\n      if (!self.htmlImageCache[html].img.complete) {\r\n        loaded = false;\r\n      }\r\n    });\r\n    if (loaded && !cachedImagesDrawn) {\r\n      cachedImagesDrawn = true;\r\n      self.draw();\r\n    }\r\n  }\r\n  function drawHtml(cell) {\r\n    var img,\r\n      v = cell.innerHTML || cell.formattedValue,\r\n      cacheKey =\r\n        v.toString() + cell.rowIndex.toString() + cell.columnIndex.toString(),\r\n      x = Math.round(cell.x + self.canvasOffsetLeft),\r\n      y = Math.round(cell.y + self.canvasOffsetTop);\r\n    if (self.htmlImageCache[cacheKey]) {\r\n      img = self.htmlImageCache[cacheKey].img;\r\n      if (\r\n        self.htmlImageCache[cacheKey].height !== cell.height ||\r\n        self.htmlImageCache[cacheKey].width !== cell.width\r\n      ) {\r\n        // height and width of the cell has changed, invalidate cache\r\n        self.htmlImageCache[cacheKey] = undefined;\r\n      } else {\r\n        if (!img.complete) {\r\n          return;\r\n        }\r\n        return self.ctx.drawImage(img, x, y);\r\n      }\r\n    } else {\r\n      cachedImagesDrawn = false;\r\n    }\r\n    img = new Image(cell.width, cell.height);\r\n    self.htmlImageCache[cacheKey] = {\r\n      img,\r\n      width: cell.width,\r\n      height: cell.height,\r\n    };\r\n    img.onload = function () {\r\n      self.ctx.drawImage(img, x, y);\r\n      drawOnAllImagesLoaded();\r\n    };\r\n    img.src =\r\n      'data:image/svg+xml;base64,' +\r\n      btoa(\r\n        '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"' +\r\n          cell.width +\r\n          '\" height=\"' +\r\n          cell.height +\r\n          '\">\\n' +\r\n          '<foreignObject class=\"node\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">\\n' +\r\n          '<body xmlns=\"http://www.w3.org/1999/xhtml\" style=\"margin:0;padding:0;\">\\n' +\r\n          v +\r\n          '\\n' +\r\n          '</body>' +\r\n          '</foreignObject>\\n' +\r\n          '</svg>\\n',\r\n      );\r\n  }\r\n  function drawOrderByArrow(x, y) {\r\n    var mt = self.style.columnHeaderOrderByArrowMarginTop * self.scale,\r\n      ml = self.style.columnHeaderOrderByArrowMarginLeft * self.scale,\r\n      mr = self.style.columnHeaderOrderByArrowMarginRight * self.scale,\r\n      aw = self.style.columnHeaderOrderByArrowWidth * self.scale,\r\n      ah = self.style.columnHeaderOrderByArrowHeight * self.scale;\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.fillStyle = self.style.columnHeaderOrderByArrowColor;\r\n    self.ctx.strokeStyle = self.style.columnHeaderOrderByArrowBorderColor;\r\n    self.ctx.beginPath();\r\n    x = x + ml;\r\n    y = y + mt;\r\n    if (self.orderDirection === 'asc') {\r\n      self.ctx.lineTo(x, y + ah);\r\n      self.ctx.lineTo(x + aw, y + ah);\r\n      self.ctx.lineTo(x + aw * 0.5, y);\r\n      self.ctx.lineTo(x, y + ah);\r\n    } else {\r\n      self.ctx.moveTo(x, y);\r\n      self.ctx.lineTo(x + aw, y);\r\n      self.ctx.lineTo(x + aw * 0.5, y + ah);\r\n      self.ctx.moveTo(x, y);\r\n    }\r\n    self.ctx.stroke();\r\n    self.ctx.fill();\r\n    return ml + aw + mr;\r\n  }\r\n  function drawTreeArrow(cell, x, y) {\r\n    var mt = self.style.treeArrowMarginTop * self.scale,\r\n      mr = self.style.treeArrowMarginRight * self.scale,\r\n      ml = self.style.treeArrowMarginLeft * self.scale,\r\n      aw = self.style.treeArrowWidth * self.scale,\r\n      ah = self.style.treeArrowHeight * self.scale;\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.fillStyle = self.style.treeArrowColor;\r\n    self.ctx.strokeStyle = self.style.treeArrowBorderColor;\r\n    self.ctx.beginPath();\r\n    x = x + ml;\r\n    y = y + mt;\r\n    if (self.openChildren[cell.rowIndex]) {\r\n      self.ctx.moveTo(x, y);\r\n      self.ctx.lineTo(x + aw, y);\r\n      self.ctx.lineTo(x + aw * 0.5, y + ah);\r\n      self.ctx.moveTo(x, y);\r\n    } else {\r\n      self.ctx.lineTo(x, y);\r\n      self.ctx.lineTo(x + ah, y + aw * 0.5);\r\n      self.ctx.lineTo(x, y + aw);\r\n      self.ctx.lineTo(x, y);\r\n    }\r\n    self.ctx.stroke();\r\n    self.ctx.fill();\r\n    return ml + aw + mr;\r\n  }\r\n  function drawFilterButtonArrow(x, y) {\r\n    var mt =\r\n        ((self.style.filterButtonHeight - self.style.filterButtonArrowHeight) /\r\n          2) *\r\n        self.scale,\r\n      ml =\r\n        ((self.style.filterButtonWidth - self.style.filterButtonArrowWidth) /\r\n          2) *\r\n        self.scale,\r\n      aw = self.style.filterButtonArrowWidth * self.scale,\r\n      ah = self.style.filterButtonArrowHeight * self.scale;\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.fillStyle = self.style.filterButtonArrowColor;\r\n    self.ctx.strokeStyle = self.style.filterButtonArrowBorderColor;\r\n    self.ctx.beginPath();\r\n    x = x + ml;\r\n    y = y + mt;\r\n\r\n    self.ctx.moveTo(x, y);\r\n    self.ctx.lineTo(x + aw, y);\r\n    self.ctx.lineTo(x + aw * 0.5, y + ah);\r\n    self.ctx.moveTo(x, y);\r\n\r\n    self.ctx.stroke();\r\n    self.ctx.fill();\r\n    return ml + aw;\r\n  }\r\n  function radiusRect(x, y, w, h, radius) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    var r = x + w,\r\n      b = y + h;\r\n    self.ctx.beginPath();\r\n    self.ctx.moveTo(x + radius, y);\r\n    self.ctx.lineTo(r - radius, y);\r\n    self.ctx.quadraticCurveTo(r, y, r, y + radius);\r\n    self.ctx.lineTo(r, y + h - radius);\r\n    self.ctx.quadraticCurveTo(r, b, r - radius, b);\r\n    self.ctx.lineTo(x + radius, b);\r\n    self.ctx.quadraticCurveTo(x, b, x, b - radius);\r\n    self.ctx.lineTo(x, y + radius);\r\n    self.ctx.quadraticCurveTo(x, y, x + radius, y);\r\n  }\r\n  function fillRect(x, y, w, h) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.fillRect(x, y, w, h);\r\n  }\r\n  function strokeRect(x, y, w, h) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.strokeRect(x, y, w, h);\r\n  }\r\n  function fillText(text, x, y) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.fillText(text, x, y);\r\n  }\r\n  function fillCircle(x, y, r) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.beginPath();\r\n    self.ctx.arc(x, y, r, 0, 2 * Math.PI);\r\n    self.ctx.fill();\r\n  }\r\n  function strokeCircle(x, y, r) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.beginPath();\r\n    self.ctx.arc(x, y, r, 0, 2 * Math.PI);\r\n    self.ctx.stroke();\r\n  }\r\n  function clipFrozenArea(mode) {\r\n    // 0 both, 1 rows, 2 cols\r\n    // self.lastFrozenColumnPixel;\r\n    // self.lastFrozenRowPixel;\r\n    self.ctx.beginPath();\r\n    if (mode === 0) {\r\n      self.ctx.moveTo(self.lastFrozenColumnPixel, self.lastFrozenRowPixel);\r\n      self.ctx.lineTo(self.lastFrozenColumnPixel, self.height);\r\n      self.ctx.lineTo(self.width, self.height);\r\n      self.ctx.lineTo(self.width, self.lastFrozenRowPixel);\r\n    }\r\n    if (mode === 1) {\r\n      self.ctx.moveTo(0, self.lastFrozenRowPixel);\r\n      self.ctx.lineTo(0, self.height);\r\n      self.ctx.lineTo(self.width, self.height);\r\n      self.ctx.lineTo(self.width, self.lastFrozenRowPixel);\r\n    }\r\n    if (mode === 2) {\r\n      self.ctx.moveTo(self.lastFrozenColumnPixel, 0);\r\n      self.ctx.lineTo(self.width, 0);\r\n      self.ctx.lineTo(self.width, self.height);\r\n      self.ctx.lineTo(self.lastFrozenColumnPixel, self.height);\r\n    }\r\n    self.ctx.clip();\r\n  }\r\n  function fillHandle(x, y, r) {\r\n    if (self.style.selectionHandleType === 'circle') {\r\n      return fillCircle(x, y, r * 0.5);\r\n    }\r\n    fillRect(x - r * 0.5, y - r * 0.5, r, r);\r\n  }\r\n  function strokeHandle(x, y, r) {\r\n    if (self.style.selectionHandleType === 'circle') {\r\n      return strokeCircle(x, y, r * 0.5);\r\n    }\r\n    strokeRect(x - r * 0.5, y - r * 0.5, r, r);\r\n  }\r\n  function addselectionHandle(c, pos) {\r\n    var hw = self.style.selectionHandleSize,\r\n      p = {\r\n        tr: function () {\r\n          fillHandle(c.x + c.width, c.y, hw);\r\n          strokeHandle(c.x + c.width, c.y, hw);\r\n        },\r\n        br: function () {\r\n          fillHandle(c.x + c.width, c.y + c.height, hw);\r\n          strokeHandle(c.x + c.width, c.y + c.height, hw);\r\n        },\r\n        tl: function () {\r\n          fillHandle(c.x, c.y, hw);\r\n          strokeHandle(c.x, c.y, hw);\r\n        },\r\n        bl: function () {\r\n          fillHandle(c.x, c.y + c.height, hw);\r\n          strokeHandle(c.x, c.y + c.height, hw);\r\n        },\r\n      };\r\n    p[pos]();\r\n  }\r\n  function addBorderLine(c, pos) {\r\n    self.ctx.beginPath();\r\n    var p = {\r\n      t: function () {\r\n        self.ctx.moveTo(\r\n          c.x + self.canvasOffsetLeft,\r\n          c.y + self.canvasOffsetTop,\r\n        );\r\n        self.ctx.lineTo(\r\n          c.x + self.canvasOffsetLeft + c.width,\r\n          c.y + self.canvasOffsetTop,\r\n        );\r\n      },\r\n      r: function () {\r\n        self.ctx.moveTo(\r\n          c.x + self.canvasOffsetLeft + c.width,\r\n          c.y + self.canvasOffsetTop,\r\n        );\r\n        self.ctx.lineTo(\r\n          c.x + self.canvasOffsetLeft + c.width,\r\n          c.y + self.canvasOffsetTop + c.height,\r\n        );\r\n      },\r\n      b: function () {\r\n        self.ctx.moveTo(\r\n          c.x + self.canvasOffsetLeft,\r\n          c.y + self.canvasOffsetTop + c.height,\r\n        );\r\n        self.ctx.lineTo(\r\n          c.x + self.canvasOffsetLeft + c.width,\r\n          c.y + self.canvasOffsetTop + c.height,\r\n        );\r\n      },\r\n      l: function () {\r\n        self.ctx.moveTo(\r\n          c.x + self.canvasOffsetLeft,\r\n          c.y + self.canvasOffsetTop,\r\n        );\r\n        self.ctx.lineTo(\r\n          c.x + self.canvasOffsetLeft,\r\n          c.y + self.canvasOffsetTop + c.height,\r\n        );\r\n      },\r\n    };\r\n    p[pos]();\r\n    self.ctx.stroke();\r\n  }\r\n  function addEllipsis(text, width) {\r\n    var c,\r\n      w = 0;\r\n    if (self.ellipsisCache[text] && self.ellipsisCache[text][width]) {\r\n      return self.ellipsisCache[text][width];\r\n    }\r\n    //TODO Add ellipsis back when there is a fast way to do it\r\n    w = self.ctx.measureText(text).width;\r\n    self.ellipsisCache[text] = self.ellipsisCache[text] || {};\r\n    c = { value: text, width: w };\r\n    self.ellipsisCache[text][width] = c;\r\n    return c;\r\n  }\r\n  function wrapText(cell, splitChar) {\r\n    if (!cell.formattedValue) {\r\n      return {\r\n        lines: [{ width: 0, value: '' }],\r\n        width: 0,\r\n        height: cell.calculatedLineHeight,\r\n      };\r\n    }\r\n    var max = 0,\r\n      n = '\\n',\r\n      x,\r\n      word,\r\n      words = cell.formattedValue.split(splitChar),\r\n      textHeight = cell.calculatedLineHeight,\r\n      lines = [],\r\n      out = [],\r\n      wrap = self.style.cellWhiteSpace !== 'nowrap',\r\n      autoResize = self.attributes.autoResizeRows && wrap,\r\n      elWidth,\r\n      et = self.attributes.ellipsisText,\r\n      elClipLength,\r\n      plWidth,\r\n      clippedVal,\r\n      ogWordWidth,\r\n      previousLine,\r\n      line = {\r\n        width: 0,\r\n        value: '',\r\n      },\r\n      cHeight = wrap ? cell.paddedHeight : cell.calculatedLineHeight;\r\n    lines.push(line);\r\n    elWidth = self.ctx.measureText(' ' + et).width;\r\n    for (x = 0; x < words.length; x += 1) {\r\n      word = words[x];\r\n      var curSplitChar = word[word.length - 1] === '-' ? '' : splitChar;\r\n      var measure = self.ctx.measureText(word + curSplitChar);\r\n      if (line.width + measure.width + elWidth < cell.paddedWidth) {\r\n        line.value += word + curSplitChar;\r\n        line.width += measure.width;\r\n        continue;\r\n      }\r\n      // if there is a hyphenated word that is too long\r\n      // split it and add the split set to the array\r\n      // then back up and re-read new split set\r\n      // this behavior seems right, it might not be\r\n      if (/\\w-\\w/.test(word) && cell.paddedWidth < measure.width) {\r\n        var arr = word.split('-');\r\n        arr = arr.map((item, index) => {\r\n          return index === arr.length - 1 ? item : item + '-';\r\n        });\r\n        words.splice(x, 1, ...arr);\r\n        x -= 1;\r\n        continue;\r\n      }\r\n      line = {\r\n        width: measure.width,\r\n        value: word + curSplitChar,\r\n      };\r\n      if (x === 0) {\r\n        lines = [];\r\n        lines.push(line);\r\n      }\r\n      textHeight += cell.calculatedLineHeight;\r\n      if (textHeight > cHeight && !autoResize) {\r\n        if (lines.length === 0) {\r\n          break;\r\n        }\r\n        elClipLength = 1;\r\n        previousLine = lines[lines.length - 1];\r\n        if (previousLine.width < cell.paddedWidth && words.length === 1) {\r\n          break;\r\n        }\r\n        clippedVal = previousLine.value + word;\r\n        plWidth = self.ctx.measureText(clippedVal + et).width;\r\n        var originText = clippedVal;\r\n        if (plWidth > cell.paddedWidth) {\r\n          var stepLength = parseInt(clippedVal.length / 2);\r\n          var direction = -1;\r\n          while (stepLength > 0) {\r\n            clippedVal = originText.substr(\r\n              0,\r\n              stepLength * direction + clippedVal.length,\r\n            );\r\n            plWidth = self.ctx.measureText(clippedVal + et).width;\r\n            direction = plWidth > cell.paddedWidth ? -1 : 1;\r\n            stepLength = parseInt(stepLength / 2);\r\n          }\r\n        }\r\n        clippedVal =\r\n          clippedVal + (originText.length != clippedVal.length ? et : '');\r\n        previousLine.value = clippedVal;\r\n        previousLine.width = plWidth;\r\n        break;\r\n      }\r\n      if (x > 0) {\r\n        lines.push(line);\r\n      }\r\n    }\r\n    return {\r\n      lines: lines,\r\n      width: max,\r\n      height: cell.calculatedLineHeight * lines.length,\r\n    };\r\n  }\r\n  function drawText(cell) {\r\n    var ll = cell.text.lines.length,\r\n      h = cell.fontHeight * cell.lineHeight,\r\n      x,\r\n      line,\r\n      wrap = self.style.cellWhiteSpace !== 'nowrap',\r\n      textHeight = 0;\r\n    for (x = 0; x < cell.text.lines.length; x += 1) {\r\n      line = cell.text.lines[x];\r\n      var vPos =\r\n          Math.max(\r\n            (cell.height -\r\n              (wrap ? cell.text.height : cell.calculatedLineHeight)) *\r\n              0.5,\r\n            0,\r\n          ) + h,\r\n        hPos = cell.paddingLeft + cell.treeArrowWidth + cell.orderByArrowWidth;\r\n      if (cell.horizontalAlignment === 'right') {\r\n        hPos = cell.paddingLeft + cell.paddedWidth - line.width;\r\n      } else if (cell.horizontalAlignment === 'center') {\r\n        hPos =\r\n          cell.paddingLeft +\r\n          (cell.paddedWidth + cell.paddingRight) / 2 -\r\n          line.width / 2;\r\n      }\r\n      if (cell.verticalAlignment === 'top') {\r\n        vPos = cell.calculatedLineHeight;\r\n      } else if (cell.verticalAlignment === 'bottom') {\r\n        vPos = cell.height - cell.paddingBottom - cell.text.height;\r\n      }\r\n      line.height = h + cell.lineSpacing;\r\n      line.offsetLeft = hPos;\r\n      line.offsetTop = vPos;\r\n      line.x = cell.x + hPos;\r\n      line.y = cell.y + textHeight + vPos;\r\n      textHeight += line.height;\r\n      fillText(line.value, line.x, line.y);\r\n    }\r\n    if (self.attributes.debug && cell.active) {\r\n      requestAnimationFrame(function () {\r\n        self.ctx.font = self.style.debugFont;\r\n        self.ctx.fillStyle = self.style.debugColor;\r\n        fillText(\r\n          JSON.stringify(\r\n            {\r\n              x: cell.x,\r\n              y: cell.y,\r\n              h: cell.height,\r\n              w: cell.width,\r\n              pw: cell.paddedWidth,\r\n              idx: cell.columnIndex,\r\n              idx_ord: cell.sortColumnIndex,\r\n            },\r\n            null,\r\n            '\\t',\r\n          ),\r\n          cell.x + 14,\r\n          cell.y + 14,\r\n        );\r\n        fillText(\r\n          JSON.stringify(\r\n            cell.text.lines.map(function (l) {\r\n              return { w: l.width, v: l.value.length };\r\n            }),\r\n            null,\r\n            '\\t',\r\n          ),\r\n          cell.x + 14,\r\n          cell.y + 30,\r\n        );\r\n      });\r\n    }\r\n  }\r\n  function getFrozenColumnsWidth() {\r\n    var w = 0,\r\n      s = self.getSchema(),\r\n      x = 0,\r\n      n = Math.min(self.frozenColumn, s.length),\r\n      column;\r\n    hiddenFrozenColumnCount = 0;\r\n    while (x < n) {\r\n      column = s[x];\r\n      if (column.hidden) {\r\n        hiddenFrozenColumnCount += 1;\r\n      } else {\r\n        w += self.getColumnWidth(x);\r\n      }\r\n      x += 1;\r\n    }\r\n    return w;\r\n  }\r\n  /**\r\n   * Redraws the grid. No matter what the change, this is the only method required to refresh everything.\r\n   * @memberof canvasDatagrid\r\n   * @name draw\r\n   * @method\r\n   */\r\n  // r = literal row index\r\n  // rd = row data array\r\n  // i = user order index\r\n  // o = literal data index\r\n  // y = y drawing cursor\r\n  // x = x drawing cursor\r\n  // s = visible schema array\r\n  // cx = current x drawing cursor sub calculation var\r\n  // cy = current y drawing cursor sub calculation var\r\n  // a = static cell (like corner cell)\r\n  // p = perf counter\r\n  // l = data length\r\n  // u = current cell\r\n  // h = current height\r\n  // w = current width\r\n  self.draw = function (internal) {\r\n    if (self.dispatchEvent('beforedraw', {})) {\r\n      return;\r\n    }\r\n    if (!self.isChildGrid && (!self.height || !self.width)) {\r\n      return;\r\n    }\r\n    if (self.isChildGrid && internal) {\r\n      requestAnimationFrame(self.parentGrid.draw);\r\n      return;\r\n    }\r\n    if (self.intf.visible === false) {\r\n      return;\r\n    }\r\n    // initial values\r\n    var checkScrollHeight,\r\n      rowHeaderCell,\r\n      p,\r\n      cx,\r\n      cy,\r\n      treeGrid,\r\n      rowOpen,\r\n      rowHeight,\r\n      cornerCell,\r\n      y,\r\n      x,\r\n      c,\r\n      h,\r\n      w,\r\n      schema,\r\n      rowIndex,\r\n      rowData,\r\n      aCell,\r\n      viewData = self.viewData || [],\r\n      bc = self.style.gridBorderCollapse === 'collapse',\r\n      selectionBorders = [],\r\n      moveBorders = [],\r\n      selectionHandles = [],\r\n      rowHeaders = [],\r\n      l = viewData.length,\r\n      u = self.currentCell || {},\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight(),\r\n      rowHeaderCellWidth = self.getRowHeaderCellWidth(),\r\n      cellHeight = self.style.cellHeight;\r\n    drawCount += 1;\r\n    p = performance.now();\r\n    self.visibleRowHeights = [];\r\n    // if data length has changed, there is no way to know\r\n    if (viewData.length > self.orders.rows.length) {\r\n      self.createRowOrders();\r\n    }\r\n    function drawScrollBars() {\r\n      var drawCorner,\r\n        en = self.scrollBox.entities,\r\n        m = self.style.scrollBarBoxMargin * 2;\r\n      self.ctx.strokeStyle = self.style.scrollBarBorderColor;\r\n      self.ctx.lineWidth = self.style.scrollBarBorderWidth;\r\n      if (self.frozenColumn > 0) {\r\n        en.horizontalBox.x =\r\n          rowHeaderCellWidth +\r\n          self.style.scrollBarBoxMargin +\r\n          self.scrollCache.x[self.frozenColumn - 1] +\r\n          (en.horizontalBar.width -\r\n            self.scrollCache.x[self.frozenColumn - 1] -\r\n            self.scrollBox.scrollBoxWidth) *\r\n            (self.scrollBox.scrollLeft / self.scrollBox.scrollWidth);\r\n      } else {\r\n        en.horizontalBox.x =\r\n          rowHeaderCellWidth +\r\n          self.style.scrollBarBoxMargin +\r\n          (en.horizontalBar.width - self.scrollBox.scrollBoxWidth) *\r\n            (self.scrollBox.scrollLeft / self.scrollBox.scrollWidth);\r\n      }\r\n      en.verticalBox.y =\r\n        columnHeaderCellHeight +\r\n        self.style.scrollBarBoxMargin +\r\n        self.scrollCache.y[self.frozenRow] +\r\n        (en.verticalBar.height -\r\n          self.scrollBox.scrollBoxHeight -\r\n          self.scrollCache.y[self.frozenRow]) *\r\n          (self.scrollBox.scrollTop / self.scrollBox.scrollHeight);\r\n      if (self.scrollBox.horizontalBarVisible) {\r\n        self.ctx.fillStyle = self.style.scrollBarBackgroundColor;\r\n        fillRect(\r\n          en.horizontalBar.x,\r\n          en.horizontalBar.y,\r\n          en.horizontalBar.width + m,\r\n          en.horizontalBar.height,\r\n        );\r\n        strokeRect(\r\n          en.horizontalBar.x,\r\n          en.horizontalBar.y,\r\n          en.horizontalBar.width + m,\r\n          en.horizontalBar.height,\r\n        );\r\n        self.ctx.fillStyle = self.style.scrollBarBoxColor;\r\n        if (self.scrollBox.horizontalBoxVisible) {\r\n          if (/horizontal/.test(u.context)) {\r\n            self.ctx.fillStyle = self.style.scrollBarActiveColor;\r\n          }\r\n          radiusRect(\r\n            en.horizontalBox.x,\r\n            en.horizontalBox.y,\r\n            en.horizontalBox.width,\r\n            en.horizontalBox.height,\r\n            self.style.scrollBarBoxBorderRadius,\r\n          );\r\n          self.ctx.stroke();\r\n          self.ctx.fill();\r\n        }\r\n        drawCorner = true;\r\n        self.visibleCells.unshift(en.horizontalBar);\r\n        self.visibleCells.unshift(en.horizontalBox);\r\n      }\r\n      if (self.scrollBox.verticalBarVisible) {\r\n        self.ctx.fillStyle = self.style.scrollBarBackgroundColor;\r\n        fillRect(\r\n          en.verticalBar.x,\r\n          en.verticalBar.y,\r\n          en.verticalBar.width,\r\n          en.verticalBar.height + m,\r\n        );\r\n        strokeRect(\r\n          en.verticalBar.x,\r\n          en.verticalBar.y,\r\n          en.verticalBar.width,\r\n          en.verticalBar.height + m,\r\n        );\r\n        if (self.scrollBox.verticalBoxVisible) {\r\n          self.ctx.fillStyle = self.style.scrollBarBoxColor;\r\n          if (/vertical/.test(u.context)) {\r\n            self.ctx.fillStyle = self.style.scrollBarActiveColor;\r\n          }\r\n          radiusRect(\r\n            en.verticalBox.x,\r\n            en.verticalBox.y,\r\n            en.verticalBox.width,\r\n            en.verticalBox.height,\r\n            self.style.scrollBarBoxBorderRadius,\r\n          );\r\n          self.ctx.stroke();\r\n          self.ctx.fill();\r\n        }\r\n        drawCorner = true;\r\n        self.visibleCells.unshift(en.verticalBar);\r\n        self.visibleCells.unshift(en.verticalBox);\r\n      }\r\n      if (drawCorner) {\r\n        //corner\r\n        self.ctx.strokeStyle = self.style.scrollBarCornerBorderColor;\r\n        self.ctx.fillStyle = self.style.scrollBarCornerBackgroundColor;\r\n        radiusRect(\r\n          en.corner.x,\r\n          en.corner.y,\r\n          en.corner.width,\r\n          en.corner.height,\r\n          0,\r\n        );\r\n        self.ctx.stroke();\r\n        self.ctx.fill();\r\n        self.visibleCells.unshift(en.corner);\r\n      }\r\n    }\r\n    function createHandlesOverlayArray(cell) {\r\n      if (self.attributes.allowMovingSelection || self.mobile) {\r\n        if (\r\n          cell.selectionBorderTop &&\r\n          cell.selectionBorderRight &&\r\n          self.mobile\r\n        ) {\r\n          selectionHandles.push([cell, 'tr']);\r\n          cell.selectionHandle = 'tr';\r\n        }\r\n        if (\r\n          cell.selectionBorderTop &&\r\n          cell.selectionBorderLeft &&\r\n          self.mobile\r\n        ) {\r\n          selectionHandles.push([cell, 'tl']);\r\n          cell.selectionHandle = 'tl';\r\n        }\r\n        if (\r\n          cell.selectionBorderBottom &&\r\n          cell.selectionBorderLeft &&\r\n          self.mobile\r\n        ) {\r\n          selectionHandles.push([cell, 'bl']);\r\n          cell.selectionHandle = 'bl';\r\n        }\r\n        if (\r\n          cell.selectionBorderBottom &&\r\n          cell.selectionBorderRight &&\r\n          (self.attributes.selectionHandleBehavior !== 'none' || self.mobile)\r\n        ) {\r\n          selectionHandles.push([cell, 'br']);\r\n          cell.selectionHandle = 'br';\r\n        }\r\n      }\r\n    }\r\n    function createBorderOverlayArray(\r\n      cell,\r\n      drawArray,\r\n      propPrefix,\r\n      offsetPoint,\r\n    ) {\r\n      offsetPoint = offsetPoint || { x: 0, y: 0 };\r\n      cell.selectionBorder = '';\r\n      if (\r\n        !cell.isRowHeader &&\r\n        self.selections[cell.rowIndex + -offsetPoint.y] &&\r\n        self.selections[cell.rowIndex + -offsetPoint.y].indexOf(\r\n          cell.columnIndex + -offsetPoint.x,\r\n        ) !== -1\r\n      ) {\r\n        if (\r\n          (!self.selections[cell.rowIndex - 1 + -offsetPoint.y] ||\r\n            self.selections[cell.rowIndex - 1 + -offsetPoint.y].indexOf(\r\n              cell.columnIndex + -offsetPoint.x,\r\n            ) === -1 ||\r\n            cell.rowIndex === 0) &&\r\n          !cell.isHeader\r\n        ) {\r\n          drawArray.push([cell, 't']);\r\n          cell[propPrefix + 'BorderTop'] = true;\r\n          cell[propPrefix + 'Border'] += 't';\r\n        }\r\n        if (\r\n          !self.selections[cell.rowIndex + 1 + -offsetPoint.y] ||\r\n          self.selections[cell.rowIndex + 1 + -offsetPoint.y].indexOf(\r\n            cell.columnIndex + -offsetPoint.x,\r\n          ) === -1\r\n        ) {\r\n          drawArray.push([cell, 'b']);\r\n          cell[propPrefix + 'BorderBottom'] = true;\r\n          cell[propPrefix + 'Border'] += 'b';\r\n        }\r\n        if (\r\n          !self.selections[cell.rowIndex + -offsetPoint.y] ||\r\n          cell.columnIndex === 0 ||\r\n          self.selections[cell.rowIndex + -offsetPoint.y].indexOf(\r\n            cell.columnIndex - 1 + -offsetPoint.x,\r\n          ) === -1\r\n        ) {\r\n          drawArray.push([cell, 'l']);\r\n          cell[propPrefix + 'BorderLeft'] = true;\r\n          cell[propPrefix + 'Border'] += 'l';\r\n        }\r\n        if (\r\n          !self.selections[cell.rowIndex + -offsetPoint.y] ||\r\n          cell.columnIndex === schema.length ||\r\n          self.selections[cell.rowIndex + -offsetPoint.y].indexOf(\r\n            cell.columnIndex + 1 + -offsetPoint.x,\r\n          ) === -1\r\n        ) {\r\n          drawArray.push([cell, 'r']);\r\n          cell[propPrefix + 'BorderRight'] = true;\r\n          cell[propPrefix + 'Border'] += 'r';\r\n        }\r\n      }\r\n    }\r\n    function drawCell(rowData, rowOrderIndex, rowIndex) {\r\n      return function drawEach(header, headerIndex, columnOrderIndex) {\r\n        if (header.hidden) {\r\n          return 0;\r\n        }\r\n        var cellStyle = header.style || 'cell',\r\n          cellGridAttributes,\r\n          cell,\r\n          isHeader = /HeaderCell/.test(cellStyle),\r\n          isCorner = /cornerCell/.test(cellStyle),\r\n          isRowHeader = 'rowHeaderCell' === cellStyle,\r\n          isColumnHeader = 'columnHeaderCell' === cellStyle,\r\n          isFilterable =\r\n            self.filterable.rows.includes(rowIndex) &&\r\n            self.filterable.columns.includes(headerIndex),\r\n          wrap = self.style.cellWhiteSpace !== 'nowrap',\r\n          selected =\r\n            self.selections[rowOrderIndex] &&\r\n            self.selections[rowOrderIndex].indexOf(columnOrderIndex) !== -1,\r\n          hovered =\r\n            self.hovers.rowIndex === rowOrderIndex &&\r\n            (self.attributes.hoverMode === 'row' ||\r\n              self.hovers.columnIndex === columnOrderIndex),\r\n          openedFilter =\r\n            self.selectedFilterButton.rowIndex == rowIndex &&\r\n            self.selectedFilterButton.columnIndex == headerIndex,\r\n          active =\r\n            self.activeCell.rowIndex === rowOrderIndex &&\r\n            self.activeCell.columnIndex === columnOrderIndex,\r\n          isColumnHeaderCellCap = cellStyle === 'columnHeaderCellCap',\r\n          rawValue = rowData ? rowData[header.name] : undefined,\r\n          isGrid = header.type === 'canvas-datagrid',\r\n          activeHeader =\r\n            (self.orders.rows[self.activeCell.rowIndex] === rowOrderIndex ||\r\n              self.orders.columns[self.activeCell.columnIndex] ===\r\n                headerIndex) &&\r\n            (columnOrderIndex === -1 || rowOrderIndex === -1)\r\n              ? isRowHeader\r\n                ? 'activeRowHeaderCell'\r\n                : 'activeColumnHeaderCell'\r\n              : false,\r\n          val,\r\n          f = self.formatters[header.type || 'string'],\r\n          orderByArrowSize = 0,\r\n          treeArrowSize = 0,\r\n          cellWidth = self.sizes.columns[headerIndex] || header.width,\r\n          ev = {\r\n            value: rawValue,\r\n            row: rowData,\r\n            header: header,\r\n          };\r\n        if (isColumnHeaderCellCap) {\r\n          cellWidth = w - x;\r\n        }\r\n        // if no data or schema are defined, a width is provided to the stub column\r\n        if (cellWidth === undefined) {\r\n          cellWidth = self.style.cellWidth;\r\n        }\r\n        cellWidth = cellWidth * self.scale;\r\n        if (x + cellWidth + self.style.cellBorderWidth < 0) {\r\n          x += cellWidth + self.style.cellBorderWidth;\r\n        }\r\n        if (active && cellStyle !== 'cornerCell') {\r\n          cellStyle = 'activeCell';\r\n        }\r\n        if (self.visibleRows.indexOf(rowIndex) === -1 && !isHeader) {\r\n          self.visibleRows.push(rowIndex);\r\n        }\r\n        val = self.dispatchEvent('formatcellvalue', ev);\r\n        cx = x;\r\n        cy = y;\r\n        if (cellStyle === 'cornerCell') {\r\n          cx = 0;\r\n          cy = 0;\r\n        } else if (isRowHeader) {\r\n          cx = 0;\r\n        } else if (isHeader) {\r\n          cy = 0;\r\n        }\r\n        cell = {\r\n          type: isGrid ? 'canvas-datagrid-cell' : header.type,\r\n          style: cellStyle,\r\n          nodeType: 'canvas-datagrid-cell',\r\n          x: cx,\r\n          y: cy,\r\n          fontHeight: (self.style[cellStyle + 'FontHeight'] || 0) * self.scale,\r\n          horizontalAlignment: self.style[cellStyle + 'HorizontalAlignment'],\r\n          verticalAlignment: self.style[cellStyle + 'VerticalAlignment'],\r\n          paddingLeft:\r\n            (self.style[cellStyle + 'PaddingLeft'] || 0) * self.scale,\r\n          paddingTop: (self.style[cellStyle + 'PaddingTop'] || 0) * self.scale,\r\n          paddingRight:\r\n            (self.style[cellStyle + 'PaddingRight'] || 0) * self.scale,\r\n          paddingBottom:\r\n            (self.style[cellStyle + 'PaddingBottom'] || 0) * self.scale,\r\n          whiteSpace: self.style.cellWhiteSpace,\r\n          lineHeight: self.style.cellLineHeight,\r\n          lineSpacing: self.style.cellLineSpacing,\r\n          offsetTop: self.canvasOffsetTop + cy,\r\n          offsetLeft: self.canvasOffsetLeft + cx,\r\n          scrollTop: self.scrollBox.scrollTop,\r\n          scrollLeft: self.scrollBox.scrollLeft,\r\n          active: active || activeHeader,\r\n          hovered: hovered,\r\n          selected: selected,\r\n          width: cellWidth,\r\n          height: cellHeight,\r\n          offsetWidth: cellWidth,\r\n          offsetHeight: cellHeight,\r\n          parentNode: self.intf.parentNode,\r\n          offsetParent: self.intf.parentNode,\r\n          data: rowData,\r\n          isCorner: isCorner,\r\n          isHeader: isHeader,\r\n          isColumnHeader: isColumnHeader,\r\n          isColumnHeaderCellCap: isColumnHeaderCellCap,\r\n          isRowHeader: isRowHeader,\r\n          isFilterable: isFilterable,\r\n          openedFilter: openedFilter,\r\n          rowOpen: rowOpen,\r\n          header: header,\r\n\r\n          columnIndex: columnOrderIndex,\r\n          rowIndex: rowOrderIndex,\r\n\r\n          viewRowIndex: rowOrderIndex,\r\n          viewColumnIndex: columnOrderIndex,\r\n\r\n          boundRowIndex: self.getBoundRowIndexFromViewRowIndex(rowOrderIndex),\r\n          boundColumnIndex: self.getBoundColumnIndexFromViewColumnIndex(\r\n            columnOrderIndex,\r\n          ),\r\n\r\n          sortColumnIndex: headerIndex,\r\n          sortRowIndex: rowIndex,\r\n\r\n          isGrid: isGrid,\r\n          isNormal: !isGrid && !isCorner && !isHeader,\r\n          gridId: (self.attributes.name || '') + rowIndex + ':' + headerIndex,\r\n          parentGrid: self.intf,\r\n          innerHTML: '',\r\n          activeHeader: activeHeader,\r\n          value:\r\n            isHeader && !isRowHeader ? header.title || header.name : rawValue,\r\n        };\r\n        cell.calculatedLineHeight =\r\n          cell.fontHeight * cell.lineHeight + cell.lineSpacing;\r\n        cell.paddedWidth = cell.width - cell.paddingRight - cell.paddingLeft;\r\n        cell.paddedHeight = cell.height - cell.paddingTop - cell.paddingBottom;\r\n        ev.cell = cell;\r\n        cell.userHeight = cell.isHeader ? self.sizes.rows[-1] : rowHeight;\r\n        cell.userWidth = cell.isHeader\r\n          ? self.sizes.columns.cornerCell\r\n          : self.sizes.columns[headerIndex];\r\n        self.visibleCells.unshift(cell);\r\n        if (self.dispatchEvent('beforerendercell', ev)) {\r\n          return;\r\n        }\r\n        self.ctx.fillStyle = self.style[cellStyle + 'BackgroundColor'];\r\n        self.ctx.strokeStyle = self.style[cellStyle + 'BorderColor'];\r\n        self.ctx.lineWidth = self.style[cellStyle + 'BorderWidth'];\r\n        if (hovered) {\r\n          self.ctx.fillStyle = self.style[cellStyle + 'HoverBackgroundColor'];\r\n          self.ctx.strokeStyle = self.style[cellStyle + 'HoverBorderColor'];\r\n        }\r\n        if (selected) {\r\n          self.ctx.fillStyle =\r\n            self.style[cellStyle + 'SelectedBackgroundColor'];\r\n          self.ctx.strokeStyle = self.style[cellStyle + 'SelectedBorderColor'];\r\n        }\r\n        if (activeHeader) {\r\n          self.ctx.fillStyle = self.style[activeHeader + 'BackgroundColor'];\r\n        }\r\n        self.dispatchEvent('rendercell', ev);\r\n        if (cell.isGrid) {\r\n          if (cell.height !== rowHeight) {\r\n            cell.height = rowHeight || self.style.cellHeightWithChildGrid;\r\n            checkScrollHeight = true;\r\n          }\r\n          cell.width =\r\n            self.sizes.columns[headerIndex] ||\r\n            self.style.cellWidthWithChildGrid;\r\n        }\r\n        if (rowOpen && !cell.isRowHeader) {\r\n          cell.height = self.sizes.rows[rowIndex] || self.style.cellHeight;\r\n        }\r\n        if (!cell.isGrid) {\r\n          fillRect(cx, cy, cell.width, cell.height);\r\n          strokeRect(cx, cy, cell.width, cell.height);\r\n        }\r\n        self.ctx.save();\r\n        radiusRect(cell.x, cell.y, cell.width, cell.height, 0);\r\n        self.ctx.clip();\r\n        self.dispatchEvent('afterrendercell', ev);\r\n        if (cell.height !== cellHeight && !(rowOpen && !cell.isRowHeader)) {\r\n          self.sizes.rows[isHeader ? -1 : rowIndex] = cell.height;\r\n          checkScrollHeight = true;\r\n        }\r\n        if (cell.width !== cellWidth) {\r\n          self.sizes.columns[headerIndex] = cell.width;\r\n          checkScrollHeight = true;\r\n        }\r\n        if (isRowHeader && self.attributes.tree) {\r\n          if (!self.dispatchEvent('rendertreearrow', ev)) {\r\n            treeArrowSize = drawTreeArrow(\r\n              cell,\r\n              self.style[cellStyle + 'PaddingLeft'],\r\n              cy,\r\n              0,\r\n            );\r\n          }\r\n        }\r\n        if ((self.attributes.showRowNumbers && isRowHeader) || !isRowHeader) {\r\n          if (cell.isGrid && !self.dispatchEvent('beforerendercellgrid', ev)) {\r\n            if (!self.childGrids[cell.gridId]) {\r\n              // HACK: this only allows setting of the child grids styles if data is set _after_\r\n              // this is less than desirable.  An interface needs to be made to effect the\r\n              // style of all cell grids.  One for individual grids already exists.\r\n              cellGridAttributes = self.cellGridAttributes;\r\n              cellGridAttributes.name = self.attributes.saveAppearance\r\n                ? cell.gridId\r\n                : undefined;\r\n              cellGridAttributes.component = false;\r\n              cellGridAttributes.parentNode = cell;\r\n              cellGridAttributes.data = rawValue;\r\n              ev.cellGridAttributes = cellGridAttributes;\r\n              if (self.dispatchEvent('beforecreatecellgrid', ev)) {\r\n                return;\r\n              }\r\n              self.childGrids[cell.gridId] = self.createGrid(\r\n                cellGridAttributes,\r\n              );\r\n              self.sizes.rows[rowIndex] =\r\n                self.sizes.rows[rowIndex] || self.style.cellGridHeight;\r\n              checkScrollHeight = true;\r\n            }\r\n            cell.grid = self.childGrids[cell.gridId];\r\n            cell.grid.parentNode = cell;\r\n            cell.grid.visible = true;\r\n            cell.grid.draw();\r\n            self.dispatchEvent('rendercellgrid', ev);\r\n          } else if (!cell.isGrid) {\r\n            if (self.childGrids[cell.gridId]) {\r\n              self.childGrids[cell.gridId].parentNode.offsetHeight = 0;\r\n            }\r\n            if (isHeader && self.orderBy === header.name) {\r\n              if (!self.dispatchEvent('renderorderbyarrow', ev)) {\r\n                orderByArrowSize = drawOrderByArrow(\r\n                  cx + self.style[cellStyle + 'PaddingLeft'],\r\n                  0,\r\n                );\r\n              }\r\n            }\r\n            self.ctx.fillStyle = self.style[cellStyle + 'Color'];\r\n            if (hovered) {\r\n              self.ctx.fillStyle = self.style[cellStyle + 'HoverColor'];\r\n            }\r\n            if (selected) {\r\n              self.ctx.fillStyle = self.style[cellStyle + 'SelectedColor'];\r\n            }\r\n            if (activeHeader) {\r\n              self.ctx.fillStyle = self.style[activeHeader + 'Color'];\r\n            }\r\n            cell.treeArrowWidth = treeArrowSize;\r\n            cell.orderByArrowWidth = orderByArrowSize;\r\n            // create text ref to see if height needs to expand\r\n            val = val !== undefined ? val : f ? f(ev) : '';\r\n            if (val === undefined && !f) {\r\n              val = '';\r\n              console.warn(\r\n                'canvas-datagrid: Unknown format ' +\r\n                  header.type +\r\n                  ' add a cellFormater',\r\n              );\r\n            }\r\n            cell.formattedValue = (val !== undefined && val !== null\r\n              ? val\r\n              : ''\r\n            ).toString();\r\n            if (\r\n              self.columnFilters &&\r\n              self.columnFilters[val] !== undefined &&\r\n              isHeader\r\n            ) {\r\n              cell.formattedValue = self.attributes.filterTextPrefix + val;\r\n            }\r\n            self.ctx.font =\r\n              self.style[cellStyle + 'FontHeight'] * self.scale +\r\n              'px ' +\r\n              self.style[cellStyle + 'FontName'];\r\n            if (!self.dispatchEvent('formattext', ev)) {\r\n              cell.text = wrapText(cell, ' ');\r\n            }\r\n            if (!self.dispatchEvent('rendertext', ev)) {\r\n              if (cell.innerHTML || header.type === 'html') {\r\n                drawHtml(cell);\r\n              } else {\r\n                drawText(cell);\r\n              }\r\n\r\n              if (wrap && cell.text && cell.text.height > rowHeight) {\r\n                self.sizes.rows[isHeader ? -1 : rowIndex] = cell.text.height;\r\n                checkScrollHeight = true;\r\n              }\r\n            }\r\n          }\r\n        }\r\n        if (active) {\r\n          aCell = cell;\r\n        }\r\n        createBorderOverlayArray(cell, selectionBorders, 'selection');\r\n        // createBorderOverlayArray calculates data for createHandlesOverlayArray so it must go 2nd\r\n        createHandlesOverlayArray(cell);\r\n        if (self.movingSelection) {\r\n          createBorderOverlayArray(cell, moveBorders, 'move', self.moveOffset);\r\n        }\r\n        self.ctx.restore();\r\n\r\n        if (isFilterable) {\r\n          drawFilterButton(cell);\r\n        }\r\n\r\n        // Gaps may occur in row numbers between consecutively rendered rows\r\n        // when we are filtering. We draw attention to this by drawing a thick\r\n        // border overlapping the two consecutive row headers. If sorting, visible\r\n        // row numbers stay the same (i.e. they don't correspond to the underlying\r\n        // data's row number), so we do not show row gaps in that case.\r\n        const isSorting =\r\n          self.orderings.columns && self.orderings.columns.length > 0;\r\n\r\n        if (\r\n          isRowHeader &&\r\n          self.attributes.showRowNumbers &&\r\n          self.attributes.showRowNumberGaps &&\r\n          isSorting === false\r\n        ) {\r\n          const previousRowNumber = self.getBoundRowIndexFromViewRowIndex(\r\n            rowOrderIndex - 1,\r\n          );\r\n          const hasRowGap =\r\n            previousRowNumber !== undefined &&\r\n            cell.boundRowIndex > 0 &&\r\n            cell.boundRowIndex - previousRowNumber > 1;\r\n\r\n          if (hasRowGap) {\r\n            const barHeight = self.style.rowHeaderCellRowNumberGapHeight;\r\n            const barColor = self.style.rowHeaderCellRowNumberGapColor;\r\n\r\n            self.ctx.save();\r\n\r\n            self.ctx.fillStyle = barColor;\r\n\r\n            fillRect(cell.x, cell.y - barHeight / 2, cell.width, barHeight);\r\n\r\n            self.ctx.restore();\r\n          }\r\n        }\r\n\r\n        x += cell.width + (bc ? 0 : self.style.cellBorderWidth);\r\n        return cell.width;\r\n      };\r\n    }\r\n    function drawFilterButton(cell, ev) {\r\n      var posX = cell.x + cell.width - self.style.filterButtonWidth - 1;\r\n      var posY = cell.y + cell.height - self.style.filterButtonHeight - 2;\r\n      if (self.dispatchEvent('beforerenderfilterbutton', ev)) {\r\n        return;\r\n      }\r\n      self.ctx.save();\r\n      self.ctx.strokeStyle = self.style.filterButtonBorderColor;\r\n      self.ctx.fillStyle = self.style.filterButtonBackgroundColor;\r\n      if (cell.openedFilter) {\r\n        self.ctx.fillStyle = self.style.filterButtonActiveBackgroundColor;\r\n      } else if (cell.hovered && self.hovers.onFilterButton) {\r\n        self.ctx.fillStyle = self.style.filterButtonHoverBackgroundColor;\r\n      }\r\n      radiusRect(\r\n        posX,\r\n        posY,\r\n        self.style.filterButtonWidth,\r\n        self.style.filterButtonHeight,\r\n        self.style.filterButtonBorderRadius,\r\n      );\r\n      self.ctx.stroke();\r\n      self.ctx.fill();\r\n      drawFilterButtonArrow(posX, posY);\r\n      self.ctx.clip();\r\n      self.dispatchEvent('afterrenderfilterbutton', ev);\r\n      self.ctx.restore();\r\n    }\r\n    function drawRowHeader(rowData, rowIndex, rowOrderIndex) {\r\n      if (self.attributes.showRowHeaders) {\r\n        x = 0;\r\n\r\n        // When filtering we'd like to display the actual row numbers,\r\n        // as it is in the unfiltered data, instead of simply the viewed\r\n        // row index + 1. If rowIndex > viewData.length, it's a new row\r\n        // added to the end, and we want to render that new row's number\r\n        const filteredRowNumber =\r\n          self.viewData && rowIndex < self.viewData.length\r\n            ? self.getBoundRowIndexFromViewRowIndex(rowIndex) + 1\r\n            : self.originalData\r\n            ? self.originalData.length + 1\r\n            : rowOrderIndex + 1;\r\n\r\n        const rowHeaderValue = self.hasActiveFilters()\r\n          ? filteredRowNumber\r\n          : rowIndex + 1;\r\n\r\n        const rowHeaderCell = { rowHeaderCell: rowHeaderValue };\r\n        const headerDescription = {\r\n          name: 'rowHeaderCell',\r\n          width: self.sizes.columns[-1] || self.style.rowHeaderCellWidth,\r\n          style: 'rowHeaderCell',\r\n          type: 'string',\r\n          data: rowHeaderValue,\r\n          index: -1,\r\n        };\r\n        rowOpen = self.openChildren[rowIndex];\r\n        drawCell(rowHeaderCell, rowOrderIndex, rowIndex)(\r\n          headerDescription,\r\n          -1,\r\n          -1,\r\n        );\r\n      }\r\n    }\r\n    function drawHeaders() {\r\n      var d,\r\n        g = schema.length,\r\n        i,\r\n        o,\r\n        columnHeaderCell,\r\n        header,\r\n        nonFrozenHeaderWidth;\r\n      function drawHeaderColumnRange(start, end) {\r\n        end = Math.min(end, g);\r\n        for (o = start; o < end; o += 1) {\r\n          i = self.orders.columns[o];\r\n          header = schema[i];\r\n          if (!header.hidden) {\r\n            d = {\r\n              title: header.title,\r\n              name: header.name,\r\n              width: header.width || self.style.cellWidth,\r\n              style: 'columnHeaderCell',\r\n              type: 'string',\r\n              index: o,\r\n              order: i,\r\n            };\r\n            columnHeaderCell = {\r\n              columnHeaderCell: header.title || header.name,\r\n            };\r\n            x += drawCell(columnHeaderCell, -1, -1)(d, i, o);\r\n            if (x > self.width + self.scrollBox.scrollLeft) {\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      rowHeaders.forEach(function (rArgs, rhIndex) {\r\n        y = rArgs[3];\r\n        cellHeight = rArgs[4];\r\n        if (rhIndex === self.frozenRow) {\r\n          self.ctx.save();\r\n          radiusRect(\r\n            0,\r\n            self.lastFrozenRowPixel,\r\n            self.width,\r\n            self.height - self.lastFrozenRowPixel,\r\n            0,\r\n          );\r\n          self.ctx.clip();\r\n        }\r\n        drawRowHeader(rArgs[0], rArgs[1], rArgs[2]);\r\n      });\r\n      self.ctx.restore();\r\n      if (self.attributes.showColumnHeaders) {\r\n        x =\r\n          -self.scrollBox.scrollLeft +\r\n          self.scrollPixelLeft +\r\n          self.style.columnHeaderCellBorderWidth;\r\n        if (self.attributes.showRowHeaders) {\r\n          x += rowHeaderCellWidth;\r\n        }\r\n        y = 0;\r\n        // cell height might have changed during drawing\r\n        cellHeight = self.getColumnHeaderCellHeight();\r\n        drawHeaderColumnRange(self.scrollIndexLeft, g);\r\n        nonFrozenHeaderWidth = x;\r\n        x = self.style.columnHeaderCellBorderWidth;\r\n        if (self.attributes.showRowHeaders) {\r\n          x += rowHeaderCellWidth;\r\n        }\r\n        drawHeaderColumnRange(0, self.frozenColumn);\r\n        // fill in the space right of the headers\r\n        x = nonFrozenHeaderWidth;\r\n        if (x < w) {\r\n          c = {\r\n            name: '',\r\n            width: self.style.scrollBarWidth,\r\n            style: 'columnHeaderCellCap',\r\n            isColumnHeaderCell: true,\r\n            isColumnHeaderCellCap: true,\r\n            type: 'string',\r\n            index: schema.length,\r\n          };\r\n          drawCell({ endCap: '' }, -1, -1)(c, -1, -1);\r\n        }\r\n        // fill in the space right of the headers\r\n        if (self.attributes.showRowHeaders) {\r\n          cornerCell = { cornerCell: '' };\r\n          x = 0;\r\n          c = {\r\n            name: 'cornerCell',\r\n            width: self.style.rowHeaderCellWidth,\r\n            style: 'cornerCell',\r\n            type: 'string',\r\n            index: -1,\r\n          };\r\n          drawCell(cornerCell, -1, -1)(c, -1, -1);\r\n        }\r\n      }\r\n    }\r\n    function drawRow(rowOrderIndex, rowIndex) {\r\n      var headerIndex,\r\n        treeHeight,\r\n        rowSansTreeHeight,\r\n        columnOrderIndex,\r\n        g = schema.length;\r\n      if (y - cellHeight * 2 > h) {\r\n        return false;\r\n      }\r\n      rowData = viewData[rowOrderIndex];\r\n      rowOpen = self.openChildren[rowOrderIndex];\r\n      rowSansTreeHeight =\r\n        (self.sizes.rows[rowOrderIndex] || self.style.cellHeight) * self.scale;\r\n      treeHeight = (rowOpen ? self.sizes.trees[rowOrderIndex] : 0) * self.scale;\r\n      rowHeight = rowSansTreeHeight + treeHeight;\r\n      if (y < -rowHeight) {\r\n        return false;\r\n      }\r\n      if (self.attributes.showRowHeaders) {\r\n        x += rowHeaderCellWidth;\r\n      }\r\n      cellHeight = rowHeight;\r\n      //draw normal columns\r\n      for (\r\n        columnOrderIndex = self.scrollIndexLeft;\r\n        columnOrderIndex < g;\r\n        columnOrderIndex += 1\r\n      ) {\r\n        headerIndex = self.orders.columns[columnOrderIndex];\r\n        x += drawCell(rowData, rowOrderIndex, rowIndex)(\r\n          schema[headerIndex],\r\n          headerIndex,\r\n          columnOrderIndex,\r\n        );\r\n        if (x > self.width) {\r\n          self.scrollIndexRight = columnOrderIndex;\r\n          self.scrollPixelRight = x;\r\n          break;\r\n        }\r\n      }\r\n      //draw frozen columns\r\n      x = 0;\r\n      if (self.attributes.showRowHeaders) {\r\n        x += rowHeaderCellWidth;\r\n      }\r\n      for (\r\n        columnOrderIndex = 0;\r\n        columnOrderIndex < self.frozenColumn;\r\n        columnOrderIndex += 1\r\n      ) {\r\n        headerIndex = self.orders.columns[columnOrderIndex];\r\n        x += drawCell(rowData, rowOrderIndex, rowIndex)(\r\n          schema[headerIndex],\r\n          headerIndex,\r\n          columnOrderIndex,\r\n        );\r\n        if (x > self.width) {\r\n          break;\r\n        }\r\n      }\r\n      self.lastFrozenColumnPixel = x;\r\n      // cell height might have changed during drawing\r\n      cellHeight = rowHeight;\r\n      x =\r\n        -self.scrollBox.scrollLeft +\r\n        self.scrollPixelLeft +\r\n        self.style.cellBorderWidth;\r\n      // don't draw a tree for the new row\r\n      treeGrid = self.childGrids[rowOrderIndex];\r\n      if (rowOrderIndex !== viewData.length && rowOpen) {\r\n        treeGrid.visible = true;\r\n        treeGrid.parentNode = {\r\n          offsetTop: y + rowSansTreeHeight + self.canvasOffsetTop,\r\n          offsetLeft: rowHeaderCellWidth - 1 + self.canvasOffsetLeft,\r\n          offsetHeight: treeHeight,\r\n          offsetWidth:\r\n            self.width - rowHeaderCellWidth - self.style.scrollBarWidth - 1,\r\n          offsetParent: self.intf.parentNode,\r\n          parentNode: self.intf.parentNode,\r\n          style: self.style,\r\n          nodeType: 'canvas-datagrid-tree',\r\n          scrollTop: self.scrollBox.scrollTop,\r\n          scrollLeft: self.scrollBox.scrollLeft,\r\n          rowIndex: rowOrderIndex,\r\n        };\r\n        self.visibleCells.unshift({\r\n          rowIndex: rowOrderIndex,\r\n          columnIndex: 0,\r\n          y: treeGrid.parentNode.offsetTop,\r\n          x: treeGrid.parentNode.offsetLeft,\r\n          height: treeGrid.height,\r\n          width: treeGrid.width,\r\n          style: 'tree-grid',\r\n          type: treeGrid.parentNode.nodeType,\r\n        });\r\n        treeGrid.draw();\r\n      } else if (treeGrid) {\r\n        treeGrid.parentNode.offsetHeight = 0;\r\n        delete self.sizes.trees[rowOrderIndex];\r\n      }\r\n      rowHeaders.push([rowData, rowOrderIndex, rowIndex, y, rowHeight]);\r\n      self.visibleRowHeights[rowOrderIndex] = rowHeight;\r\n      y += cellHeight + (bc ? 0 : self.style.cellBorderWidth);\r\n      return true;\r\n    }\r\n    function initDraw() {\r\n      self.visibleRows = [];\r\n      schema = self.getSchema();\r\n      self.visibleCells = [];\r\n      self.canvasOffsetTop = self.isChildGrid ? self.parentNode.offsetTop : 0.5;\r\n      self.canvasOffsetLeft = self.isChildGrid\r\n        ? self.parentNode.offsetLeft\r\n        : -0.5;\r\n      h = self.height;\r\n      w = self.width;\r\n    }\r\n    function drawBackground() {\r\n      radiusRect(0, 0, w, h, 0);\r\n      self.ctx.clip();\r\n      self.ctx.fillStyle = self.style.gridBackgroundColor;\r\n      fillRect(0, 0, w, h);\r\n    }\r\n    function drawFrozenRows() {\r\n      var rowOrderIndex,\r\n        ln = Math.min(viewData.length, self.frozenRow);\r\n      x =\r\n        -self.scrollBox.scrollLeft +\r\n        self.scrollPixelLeft +\r\n        self.style.cellBorderWidth;\r\n      y = columnHeaderCellHeight;\r\n      for (rowIndex = 0; rowIndex < ln; rowIndex += 1) {\r\n        rowOrderIndex = self.orders.rows[rowIndex];\r\n        if (!drawRow(rowOrderIndex, rowIndex)) {\r\n          break;\r\n        }\r\n      }\r\n      if (self.attributes.allowFreezingRows) {\r\n        // HACK great, another stupid magic number.\r\n        // Background will appear as a 0.5px artifact behind the row freeze bar without this hack\r\n        y +=\r\n          self.style.frozenMarkerBorderWidth +\r\n          self.style.frozenMarkerWidth -\r\n          0.4999999999;\r\n      }\r\n      self.lastFrozenRowPixel = y;\r\n    }\r\n    function drawRows() {\r\n      self.ctx.save();\r\n      if (self.frozenRow > 0) {\r\n        radiusRect(\r\n          0,\r\n          self.lastFrozenRowPixel,\r\n          self.width,\r\n          self.height - self.lastFrozenRowPixel,\r\n          0,\r\n        );\r\n        self.ctx.clip();\r\n      }\r\n      var columnOrderIndex,\r\n        rowOrderIndex,\r\n        headerIndex,\r\n        g = schema.length;\r\n      x =\r\n        -self.scrollBox.scrollLeft +\r\n        self.scrollPixelLeft +\r\n        self.style.cellBorderWidth;\r\n      if (!self.attributes.snapToRow) {\r\n        y +=\r\n          -self.scrollBox.scrollTop +\r\n          self.scrollPixelTop +\r\n          self.style.cellBorderWidth;\r\n      }\r\n      for (\r\n        rowIndex = self.frozenRow + self.scrollIndexTop;\r\n        rowIndex < l;\r\n        rowIndex += 1\r\n      ) {\r\n        rowOrderIndex = self.orders.rows[rowIndex];\r\n        self.scrollIndexBottom = rowIndex;\r\n        self.scrollPixelBottom = y;\r\n        if (!drawRow(rowOrderIndex, rowIndex)) {\r\n          break;\r\n        }\r\n      }\r\n      if (self.attributes.showNewRow) {\r\n        if (self.attributes.showRowHeaders) {\r\n          x += rowHeaderCellWidth;\r\n        }\r\n        rowHeight = cellHeight = self.style.cellHeight;\r\n        rowOpen = false;\r\n        for (\r\n          columnOrderIndex = self.scrollIndexLeft;\r\n          columnOrderIndex < g;\r\n          columnOrderIndex += 1\r\n        ) {\r\n          headerIndex = self.orders.columns[columnOrderIndex];\r\n          x += drawCell(self.newRow, viewData.length, viewData.length)(\r\n            schema[headerIndex],\r\n            headerIndex,\r\n            columnOrderIndex,\r\n          );\r\n          if (x > self.width + self.scrollBox.scrollLeft) {\r\n            break;\r\n          }\r\n        }\r\n        rowHeaders.push([\r\n          self.newRow,\r\n          viewData.length,\r\n          viewData.length,\r\n          y,\r\n          rowHeight,\r\n        ]);\r\n      }\r\n      self.ctx.restore();\r\n    }\r\n    function drawMoveMarkers() {\r\n      if (!self.movingSelection) {\r\n        return;\r\n      }\r\n      self.ctx.lineWidth = self.style.moveOverlayBorderWidth;\r\n      self.ctx.strokeStyle = self.style.moveOverlayBorderColor;\r\n      self.ctx.setLineDash(self.style.moveOverlayBorderSegments);\r\n      moveBorders.forEach(function (c) {\r\n        addBorderLine(c[0], c[1]);\r\n      });\r\n      self.ctx.setLineDash([]);\r\n    }\r\n    function drawReorderMarkers() {\r\n      if (!self.reorderObject) {\r\n        return;\r\n      }\r\n      var b = {\r\n          height: self.reorderObject.height,\r\n          width: self.reorderObject.width,\r\n          x: self.reorderObject.x + self.reorderObject.dragOffset.x,\r\n          y: self.reorderObject.y + self.reorderObject.dragOffset.y,\r\n        },\r\n        m = {\r\n          width: w,\r\n          height: h,\r\n          x: 0,\r\n          y: 0,\r\n        };\r\n      self.ctx.fillStyle = self.style.reorderMarkerBackgroundColor;\r\n      self.ctx.lineWidth = self.style.reorderMarkerBorderWidth;\r\n      self.ctx.strokeStyle = self.style.reorderMarkerBorderColor;\r\n      if (self.dragMode === 'row-reorder') {\r\n        for (var k = 0; k < self.selections.length; k++) {\r\n          if (!self.selections[k] || k == self.reorderObject.rowIndex) continue;\r\n          b.height += self.getRowHeight(k);\r\n        }\r\n        b.width = w;\r\n        b.x = 0;\r\n        m.width = w;\r\n        m.height = self.currentCell.height;\r\n        m.y = self.currentCell.y;\r\n        fillRect(b.x, b.y, b.width, b.height);\r\n        strokeRect(b.x, b.y, b.width, b.height);\r\n        self.ctx.lineWidth = self.style.reorderMarkerIndexBorderWidth;\r\n        self.ctx.strokeStyle = self.style.reorderMarkerIndexBorderColor;\r\n        if (\r\n          self.currentCell.rowIndex !== self.reorderObject.rowIndex &&\r\n          self.currentCell.rowIndex > -1 &&\r\n          self.currentCell.rowIndex < l\r\n        ) {\r\n          addBorderLine(\r\n            m,\r\n            self.reorderTarget.sortRowIndex > self.reorderObject.sortRowIndex\r\n              ? 'b'\r\n              : 't',\r\n          );\r\n        }\r\n      } else if (self.dragMode === 'column-reorder' && self.reorderObject) {\r\n        var selectedColumns = self.selections[0];\r\n        for (var k = 1; k < selectedColumns.length; k++) {\r\n          b.width += self.getColumnWidth(\r\n            self.orders.columns[selectedColumns[k]],\r\n          );\r\n        }\r\n        b.height = h;\r\n        b.y = 0;\r\n        m.height = h;\r\n        m.width = self.currentCell.width;\r\n        m.y = 0;\r\n        m.x = self.currentCell.x;\r\n        fillRect(b.x, b.y, b.width, b.height);\r\n        strokeRect(b.x, b.y, b.width, b.height);\r\n        self.ctx.lineWidth = self.style.reorderMarkerIndexBorderWidth;\r\n        self.ctx.strokeStyle = self.style.reorderMarkerIndexBorderColor;\r\n        if (\r\n          self.currentCell.sortColumnIndex !==\r\n            self.reorderObject.sortColumnIndex &&\r\n          self.currentCell.sortColumnIndex > -1 &&\r\n          self.currentCell.sortColumnIndex < schema.length\r\n        ) {\r\n          addBorderLine(\r\n            m,\r\n            self.reorderTarget.columnIndex > self.reorderObject.columnIndex\r\n              ? 'r'\r\n              : 'l',\r\n          );\r\n        }\r\n      }\r\n    }\r\n    function drawBorder() {\r\n      self.ctx.lineWidth = self.style.gridBorderWidth;\r\n      self.ctx.strokeStyle = self.style.gridBorderColor;\r\n      strokeRect(0, 0, self.width, self.height);\r\n    }\r\n    function drawSelectionBorders() {\r\n      self.ctx.lineWidth = self.style.selectionOverlayBorderWidth;\r\n      self.ctx.strokeStyle = self.style.selectionOverlayBorderColor;\r\n      function dsb(c) {\r\n        addBorderLine(c[0], c[1]);\r\n      }\r\n      selectionBorders\r\n        .filter(function (c) {\r\n          return (\r\n            c[0].rowIndex < self.frozenRow &&\r\n            c[0].columnIndex < self.frozenColumn\r\n          );\r\n        })\r\n        .forEach(dsb);\r\n      self.ctx.save();\r\n      clipFrozenArea(0);\r\n      selectionBorders\r\n        .filter(function (c) {\r\n          return (\r\n            c[0].rowIndex >= self.frozenRow &&\r\n            c[0].columnIndex >= self.frozenColumn\r\n          );\r\n        })\r\n        .forEach(dsb);\r\n      self.ctx.restore();\r\n      self.ctx.save();\r\n      clipFrozenArea(1);\r\n      selectionBorders\r\n        .filter(function (c) {\r\n          return (\r\n            c[0].rowIndex >= self.frozenRow &&\r\n            c[0].columnIndex < self.frozenColumn\r\n          );\r\n        })\r\n        .forEach(dsb);\r\n      self.ctx.restore();\r\n      self.ctx.save();\r\n      clipFrozenArea(2);\r\n      selectionBorders\r\n        .filter(function (c) {\r\n          return (\r\n            c[0].rowIndex < self.frozenRow &&\r\n            c[0].columnIndex >= self.frozenColumn\r\n          );\r\n        })\r\n        .forEach(dsb);\r\n      self.ctx.restore();\r\n    }\r\n    function drawSelectionHandles() {\r\n      if (self.mobile || self.attributes.allowMovingSelection) {\r\n        self.ctx.lineWidth = self.style.selectionHandleBorderWidth;\r\n        self.ctx.strokeStyle = self.style.selectionHandleBorderColor;\r\n        self.ctx.fillStyle = self.style.selectionHandleColor;\r\n        selectionHandles.forEach(function (c) {\r\n          addselectionHandle(c[0], c[1]);\r\n          var az = self.attributes.touchSelectHandleZone / 2,\r\n            ax =\r\n              c[0].x + (c[1] === 'tl' || c[1] === 'bl' ? 0 : c[0].width) - az,\r\n            ay =\r\n              c[0].y + (c[1] === 'bl' || c[1] === 'br' ? c[0].height : 0) - az;\r\n          self.visibleCells.unshift({\r\n            x: ax,\r\n            y: ay,\r\n            height: self.style.selectionHandleSize + az,\r\n            width: self.style.selectionHandleSize + az,\r\n            style: 'selection-handle-' + c[1],\r\n          });\r\n        });\r\n      }\r\n    }\r\n    function drawActiveCell() {\r\n      if (!aCell) {\r\n        return;\r\n      }\r\n      self.ctx.save();\r\n      var cl =\r\n          self.activeCell.columnIndex + 1 > self.frozenColumn ||\r\n          self.activeCell.rowIndex + 1 > self.frozenRow,\r\n        acx = cl ? self.lastFrozenColumnPixel : 0,\r\n        acy = cl ? self.lastFrozenRowPixel : 0,\r\n        acw = cl ? self.width - self.lastFrozenColumnPixel : self.width,\r\n        ach = cl ? self.height - self.lastFrozenRowPixel : self.height;\r\n      radiusRect(acx, acy, acw, ach, 0);\r\n      self.ctx.clip();\r\n      if (self.attributes.selectionMode === 'row') {\r\n        if (self.activeCell && self.activeCell.rowIndex === aCell.rowIndex) {\r\n          self.ctx.lineWidth = self.style.activeCellOverlayBorderWidth;\r\n          self.ctx.strokeStyle = self.style.activeCellOverlayBorderColor;\r\n          strokeRect(\r\n            1,\r\n            aCell.y,\r\n            self.getHeaderWidth() + rowHeaderCellWidth,\r\n            self.visibleRowHeights[aCell.rowIndex],\r\n          );\r\n        }\r\n      } else {\r\n        self.ctx.lineWidth = self.style.activeCellOverlayBorderWidth;\r\n        self.ctx.strokeStyle = self.style.activeCellOverlayBorderColor;\r\n        strokeRect(aCell.x, aCell.y, aCell.width, aCell.height);\r\n      }\r\n      self.ctx.restore();\r\n    }\r\n    function drawFrozenMarkers() {\r\n      var my = self.lastFrozenRowPixel - self.style.frozenMarkerWidth,\r\n        mx = self.lastFrozenColumnPixel - self.style.frozenMarkerBorderWidth,\r\n        xHover =\r\n          self.currentCell && self.currentCell.style === 'frozen-row-marker',\r\n        yHover =\r\n          self.currentCell && self.currentCell.style === 'frozen-column-marker';\r\n      self.ctx.lineWidth = self.style.frozenMarkerBorderWidth;\r\n      if (self.attributes.allowFreezingColumns) {\r\n        self.ctx.fillStyle = yHover\r\n          ? self.style.frozenMarkerHoverColor\r\n          : self.style.frozenMarkerColor;\r\n        self.ctx.strokeStyle = yHover\r\n          ? self.style.frozenMarkerHoverBorderColor\r\n          : self.style.frozenMarkerBorderColor;\r\n        fillRect(mx, 0, self.style.frozenMarkerWidth, self.height);\r\n        strokeRect(mx, 0, self.style.frozenMarkerWidth, self.height);\r\n        self.visibleCells.unshift({\r\n          x: mx,\r\n          y: 0,\r\n          height: self.height,\r\n          width:\r\n            self.style.frozenMarkerWidth + self.style.frozenMarkerBorderWidth,\r\n          style: 'frozen-column-marker',\r\n        });\r\n      }\r\n      if (self.attributes.allowFreezingRows) {\r\n        self.ctx.fillStyle = xHover\r\n          ? self.style.frozenMarkerHoverColor\r\n          : self.style.frozenMarkerColor;\r\n        self.ctx.strokeStyle = xHover\r\n          ? self.style.frozenMarkerHoverBorderColor\r\n          : self.style.frozenMarkerBorderColor;\r\n        fillRect(0, my, self.width, self.style.frozenMarkerWidth);\r\n        strokeRect(0, my, self.width, self.style.frozenMarkerWidth);\r\n        self.visibleCells.unshift({\r\n          x: 0,\r\n          y: my,\r\n          height:\r\n            self.style.frozenMarkerWidth + self.style.frozenMarkerBorderWidth,\r\n          width: self.width,\r\n          style: 'frozen-row-marker',\r\n        });\r\n      }\r\n      if (self.freezeMarkerPosition) {\r\n        self.ctx.fillStyle = self.style.frozenMarkerActiveColor;\r\n        self.ctx.strokeStyle = self.style.frozenMarkerActiveBorderColor;\r\n        if (self.dragMode === 'frozen-column-marker') {\r\n          fillRect(\r\n            self.freezeMarkerPosition.x,\r\n            0,\r\n            self.style.frozenMarkerWidth,\r\n            self.height,\r\n          );\r\n          strokeRect(\r\n            self.freezeMarkerPosition.x,\r\n            0,\r\n            self.style.frozenMarkerWidth,\r\n            self.height,\r\n          );\r\n        } else {\r\n          fillRect(\r\n            0,\r\n            self.freezeMarkerPosition.y,\r\n            self.width,\r\n            self.style.frozenMarkerWidth,\r\n          );\r\n          strokeRect(\r\n            0,\r\n            self.freezeMarkerPosition.y,\r\n            self.width,\r\n            self.style.frozenMarkerWidth,\r\n          );\r\n        }\r\n      }\r\n    }\r\n    function drawPerfLines() {\r\n      if (!self.attributes.showPerformance) {\r\n        return;\r\n      }\r\n      var pw = 250,\r\n        px =\r\n          self.width -\r\n          pw -\r\n          self.style.scrollBarWidth -\r\n          self.style.scrollBarBorderWidth * 2,\r\n        py = columnHeaderCellHeight,\r\n        ph = 100;\r\n      if (scrollDebugCounters.length === 0) {\r\n        scrollDebugCounters = fillArray(0, perfWindowSize, 1, function () {\r\n          return [0, 0];\r\n        });\r\n      }\r\n      if (touchPPSCounters.length === 0) {\r\n        touchPPSCounters = fillArray(0, perfWindowSize, 1, function () {\r\n          return [0, 0];\r\n        });\r\n      }\r\n      if (entityCount.length === 0) {\r\n        entityCount = fillArray(0, perfWindowSize, 1, 0);\r\n      }\r\n      self.ctx.lineWidth = 0.5;\r\n      function dpl(name, perfArr, arrIndex, max, color, useAbs, rowIndex) {\r\n        var v;\r\n        drawPerfLine(pw, ph, px, py, perfArr, arrIndex, max, color, useAbs);\r\n        self.ctx.fillStyle = color;\r\n        fillRect(3 + px, py + 9 + rowIndex * 11, 8, 8);\r\n        self.ctx.fillStyle = self.style.debugPerfChartTextColor;\r\n        v = arrIndex !== undefined ? perfArr[0][arrIndex] : perfArr[0];\r\n        fillText(\r\n          name + ' ' + (isNaN(v) ? 0 : v).toFixed(3),\r\n          14 + px,\r\n          py + 16 + rowIndex * 11,\r\n        );\r\n      }\r\n      self.ctx.textAlign = 'left';\r\n      self.ctx.font = self.style.debugFont;\r\n      self.ctx.fillStyle = self.style.debugPerfChartBackground;\r\n      fillRect(px, py, pw, ph);\r\n      [\r\n        [\r\n          'Scroll Height',\r\n          scrollDebugCounters,\r\n          0,\r\n          self.scrollBox.scrollHeight,\r\n          self.style.debugScrollHeightColor,\r\n          false,\r\n        ],\r\n        [\r\n          'Scroll Width',\r\n          scrollDebugCounters,\r\n          1,\r\n          self.scrollBox.scrollWidth,\r\n          self.style.debugScrollWidthColor,\r\n          false,\r\n        ],\r\n        [\r\n          'Performance',\r\n          perfCounters,\r\n          undefined,\r\n          200,\r\n          self.style.debugPerformanceColor,\r\n          false,\r\n        ],\r\n        [\r\n          'Entities',\r\n          entityCount,\r\n          undefined,\r\n          1500,\r\n          self.style.debugEntitiesColor,\r\n          false,\r\n        ],\r\n        [\r\n          'TouchPPSX',\r\n          touchPPSCounters,\r\n          0,\r\n          1000,\r\n          self.style.debugTouchPPSXColor,\r\n          true,\r\n        ],\r\n        [\r\n          'TouchPPSY',\r\n          touchPPSCounters,\r\n          1,\r\n          1000,\r\n          self.style.debugTouchPPSYColor,\r\n          true,\r\n        ],\r\n      ].forEach(function (i, index) {\r\n        i.push(index);\r\n        dpl.apply(null, i);\r\n      });\r\n      self.ctx.fillStyle = self.style.debugPerfChartBackground;\r\n      entityCount.pop();\r\n      entityCount.unshift(self.visibleCells.length);\r\n      scrollDebugCounters.pop();\r\n      scrollDebugCounters.unshift([\r\n        self.scrollBox.scrollTop,\r\n        self.scrollBox.scrollLeft,\r\n      ]);\r\n      touchPPSCounters.pop();\r\n      touchPPSCounters.unshift([self.yPPS, self.xPPS]);\r\n    }\r\n    function drawDebug() {\r\n      self.ctx.save();\r\n      var d;\r\n      if (self.attributes.showPerformance || self.attributes.debug) {\r\n        if (perfCounters.length === 0) {\r\n          perfCounters = fillArray(0, perfWindowSize, 1, 0);\r\n        }\r\n        perfCounters.pop();\r\n        perfCounters.unshift(performance.now() - p);\r\n      }\r\n      if (!self.attributes.debug) {\r\n        self.ctx.restore();\r\n        return;\r\n      }\r\n      self.ctx.font = self.style.debugFont;\r\n      d = {};\r\n      d.perf = (\r\n        perfCounters.reduce(function (a, b) {\r\n          return a + b;\r\n        }, 0) / Math.min(drawCount, perfCounters.length)\r\n      ).toFixed(1);\r\n      d.perfDelta = perfCounters[0].toFixed(1);\r\n      d.frozenColumnsWidth = getFrozenColumnsWidth();\r\n      d.htmlImages = Object.keys(self.htmlImageCache).length;\r\n      d.reorderObject =\r\n        'x: ' +\r\n        (self.reorderObject || { columnIndex: 0 }).columnIndex +\r\n        ', y: ' +\r\n        (self.reorderObject || { rowIndex: 0 }).rowIndex;\r\n      d.reorderTarget =\r\n        'x: ' +\r\n        (self.reorderTarget || { columnIndex: 0 }).columnIndex +\r\n        ', y: ' +\r\n        (self.reorderTarget || { rowIndex: 0 }).rowIndex;\r\n      d.scale = self.scale;\r\n      d.startScale = self.startScale;\r\n      d.scaleDelta = self.scaleDelta;\r\n      d.zoomDeltaStart = self.zoomDeltaStart;\r\n      d.touchLength = self.touchLength;\r\n      d.touches =\r\n        'y0: ' +\r\n        (self.touchPosition || { y: 0 }).y +\r\n        ' y1: ' +\r\n        (self.touchPosition1 || { y: 0 }).y;\r\n      d.scrollBox = self.scrollBox.toString();\r\n      d.scrollIndex =\r\n        'x: ' + self.scrollIndexLeft + ', y: ' + self.scrollIndexTop;\r\n      d.scrollPixel =\r\n        'x: ' + self.scrollPixelLeft + ', y: ' + self.scrollPixelTop;\r\n      d.canvasOffset =\r\n        'x: ' + self.canvasOffsetLeft + ', y: ' + self.canvasOffsetTop;\r\n      d.touchDelta = 'x: ' + self.touchDelta.x + ', y: ' + self.touchDelta.y;\r\n      d.touchAnimateTo =\r\n        'x: ' + self.touchAnimateTo.x + ', y: ' + self.touchAnimateTo.y;\r\n      d.scrollAnimation =\r\n        'x: ' + self.scrollAnimation.x + ', y: ' + self.scrollAnimation.y;\r\n      d.touchPPS = 'x: ' + self.xPPS + ', y: ' + self.yPPS;\r\n      d.touchPPST = 'x: ' + self.xPPST + ', y: ' + self.yPPST;\r\n      d.touchDuration = self.touchDuration;\r\n      d.pointerLockPosition = self.pointerLockPosition\r\n        ? self.pointerLockPosition.x + ', ' + self.pointerLockPosition.y\r\n        : '';\r\n      d.size = 'w: ' + self.width + ', h: ' + self.height;\r\n      d.mouse = 'x: ' + self.mouse.x + ', y: ' + self.mouse.y;\r\n      d.touch = !self.touchStart\r\n        ? ''\r\n        : 'x: ' + self.touchStart.x + ', y: ' + self.touchStart.y;\r\n      d.entities = self.visibleCells.length;\r\n      d.hasFocus = self.hasFocus;\r\n      d.dragMode = self.dragMode;\r\n      if (self.currentCell) {\r\n        d.columnIndex = self.currentCell.columnIndex;\r\n        d.rowIndex = self.currentCell.rowIndex;\r\n        d.sortColumnIndex = self.currentCell.sortColumnIndex;\r\n        d.sortRowIndex = self.currentCell.sortRowIndex;\r\n        d.context = self.currentCell.context;\r\n        d.dragContext = self.currentCell.dragContext;\r\n        d.style = self.currentCell.style;\r\n        d.type = self.currentCell.type;\r\n      }\r\n      self.ctx.textAlign = 'right';\r\n      self.ctx.fillStyle = self.style.debugBackgroundColor;\r\n      fillRect(0, 0, self.width, self.height);\r\n      Object.keys(d).forEach(function (key, index) {\r\n        var m = key + ': ' + d[key],\r\n          lh = 14;\r\n        self.ctx.fillStyle = self.style.debugColor;\r\n        fillText(\r\n          m,\r\n          w - 20,\r\n          (self.attributes.showPerformance ? 140 : 24) + index * lh,\r\n        );\r\n      });\r\n      self.ctx.restore();\r\n    }\r\n    self.ctx.save();\r\n    initDraw();\r\n    drawBackground();\r\n    drawFrozenRows();\r\n    drawRows();\r\n    drawActiveCell();\r\n    drawHeaders();\r\n    drawFrozenMarkers();\r\n    drawSelectionHandles();\r\n    drawReorderMarkers();\r\n    drawMoveMarkers();\r\n    drawBorder();\r\n    drawSelectionBorders();\r\n    drawScrollBars();\r\n    if (checkScrollHeight) {\r\n      self.resize(true);\r\n    }\r\n    drawDebug();\r\n    drawPerfLines();\r\n    if (self.dispatchEvent('afterdraw', {})) {\r\n      return;\r\n    }\r\n    self.ctx.restore();\r\n  };\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true, plusplus: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nimport isPrintableKeyEvent from 'is-printable-key-event';\r\nimport { isSupportedHtml, parseData } from './util';\r\n\r\nexport default function (self) {\r\n  var wheeling;\r\n  self.stopPropagation = function (e) {\r\n    e.stopPropagation();\r\n  };\r\n  /**\r\n   * Adds an event listener to the given event.\r\n   * @memberof canvasDatagrid\r\n   * @name addEventListener\r\n   * @method\r\n   * @param {string} ev The name of the event to subscribe to.\r\n   * @param {function} fn The event procedure to execute when the event is raised.\r\n   */\r\n  self.addEventListener = function (ev, fn) {\r\n    self.events[ev] = self.events[ev] || [];\r\n    self.events[ev].unshift(fn);\r\n  };\r\n  /**\r\n   * Removes the given listener function from the given event.  Must be an actual reference to the function that was bound.\r\n   * @memberof canvasDatagrid\r\n   * @name removeEventListener\r\n   * @method\r\n   * @param {string} ev The name of the event to unsubscribe from.\r\n   * @param {function} fn The event procedure to execute when the event is raised.\r\n   */\r\n  self.removeEventListener = function (ev, fn) {\r\n    (self.events[ev] || []).forEach(function removeEachListener(sfn, idx) {\r\n      if (fn === sfn) {\r\n        self.events[ev].splice(idx, 1);\r\n      }\r\n    });\r\n  };\r\n  /**\r\n   * Fires the given event, passing an event object to the event subscribers.\r\n   * @memberof canvasDatagrid\r\n   * @name dispatchEvent\r\n   * @method\r\n   * @param {number} ev The name of the event to dispatch.\r\n   * @param {number} e The event object.\r\n   */\r\n  self.dispatchEvent = function (ev, e) {\r\n    e = ev.type ? ev : e || {};\r\n    ev = ev.type || ev;\r\n    var defaultPrevented;\r\n    function preventDefault() {\r\n      defaultPrevented = true;\r\n    }\r\n    if (!self.events[ev]) {\r\n      return;\r\n    }\r\n    self.events[ev].forEach(function dispatchEachEvent(fn) {\r\n      e.ctx = self.ctx;\r\n      e.preventDefault = preventDefault;\r\n      fn.apply(self.intf, [e]);\r\n    });\r\n    return defaultPrevented;\r\n  };\r\n  self.getRatio = function () {\r\n    return Math.min(\r\n      self.attributes.maxPixelRatio,\r\n      (window.devicePixelRatio || 1) /\r\n        (self.ctx.webkitBackingStorePixelRatio ||\r\n          self.ctx.mozBackingStorePixelRatio ||\r\n          self.ctx.msBackingStorePixelRatio ||\r\n          self.ctx.oBackingStorePixelRatio ||\r\n          self.ctx.backingStorePixelRatio ||\r\n          1),\r\n    );\r\n  };\r\n  self.resize = function (drawAfterResize) {\r\n    if (!self.canvas) {\r\n      return;\r\n    }\r\n    var x,\r\n      v = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        style: 'vertical-scroll-bar',\r\n      },\r\n      n = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        style: 'horizontal-scroll-bar',\r\n      },\r\n      vb = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        style: 'vertical-scroll-box',\r\n      },\r\n      nb = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        style: 'horizontal-scroll-box',\r\n      },\r\n      co = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        isCorner: true,\r\n        isScrollBoxCorner: true,\r\n        style: 'scroll-box-corner',\r\n      },\r\n      m = self.style.scrollBarBoxMargin * 2,\r\n      b = self.style.scrollBarBorderWidth * 2,\r\n      d = self.style.scrollBarBoxMargin * 0.5,\r\n      sbw = self.style.scrollBarWidth + self.style.scrollBarBorderWidth * 2,\r\n      ratio = self.getRatio(),\r\n      bm = self.style.gridBorderCollapse === 'collapse' ? 1 : 2,\r\n      cellBorder = self.style.cellBorderWidth * bm,\r\n      columnHeaderCellBorder = self.style.columnHeaderCellBorderWidth * bm,\r\n      dataHeight = 0,\r\n      dataWidth = 0,\r\n      dims,\r\n      l = (self.viewData || []).length,\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight(),\r\n      rowHeaderCellWidth = self.getRowHeaderCellWidth(),\r\n      ch = self.style.cellHeight,\r\n      s = self.getSchema();\r\n    // sets actual DOM canvas element\r\n    function checkScrollBoxVisibility() {\r\n      self.scrollBox.horizontalBarVisible =\r\n        (self.style.width !== 'auto' &&\r\n          dataWidth > self.scrollBox.width &&\r\n          self.style.overflowX !== 'hidden') ||\r\n        self.style.overflowX === 'scroll';\r\n      self.scrollBox.horizontalBoxVisible = dataWidth > self.scrollBox.width;\r\n      self.scrollBox.verticalBarVisible =\r\n        (self.style.height !== 'auto' &&\r\n          dataHeight > self.scrollBox.height &&\r\n          self.style.overflowY !== 'hidden') ||\r\n        self.style.overflowY === 'scroll';\r\n      self.scrollBox.verticalBoxVisible = dataHeight > self.scrollBox.height;\r\n    }\r\n    function setScrollBoxSize() {\r\n      self.scrollBox.width = self.width - rowHeaderCellWidth;\r\n      self.scrollBox.height = self.height - columnHeaderCellHeight;\r\n    }\r\n    function setCanvasSize() {\r\n      if (self.isChildGrid) {\r\n        return;\r\n      }\r\n      dims = {\r\n        // HACK +1 ? maybe it's a magic cell border?  Required to line up properly in auto height mode.\r\n        height: columnHeaderCellHeight + dataHeight + cellBorder + 1,\r\n        width: dataWidth + rowHeaderCellWidth + cellBorder,\r\n      };\r\n      ['width', 'height'].forEach(function (dim) {\r\n        //TODO: support inherit\r\n        if (\r\n          ['auto', undefined].indexOf(self.style[dim]) !== -1 &&\r\n          ['auto', undefined].indexOf(self.appliedInlineStyles[dim]) !== -1\r\n        ) {\r\n          self.parentNodeStyle[dim] = dims[dim] + 'px';\r\n        } else if (\r\n          ['auto', undefined].indexOf(self.style[dim]) == -1 &&\r\n          ['auto', undefined].indexOf(self.appliedInlineStyles[dim]) == -1\r\n        ) {\r\n          self.parentNodeStyle[dim] = self.style[dim];\r\n          if (self.isComponent) {\r\n            self.canvas.style[dim] = self.style[dim];\r\n          }\r\n        }\r\n      });\r\n    }\r\n    self.scrollCache.x = [];\r\n    self.scrollCache.y = [];\r\n    for (x = 0; x < l; x += 1) {\r\n      self.scrollCache.y[x] = dataHeight;\r\n      dataHeight +=\r\n        ((self.sizes.rows[x] || ch) + (self.sizes.trees[x] || 0)) * self.scale +\r\n        // HACK? if an expanded tree row is frozen it is necessary to add the tree row's height a second time.\r\n        (self.frozenRow > x ? self.sizes.trees[x] || 0 : 0);\r\n    }\r\n    if (l > 1) {\r\n      self.scrollCache.y[x] = dataHeight;\r\n    }\r\n    dataWidth =\r\n      s.reduce(function reduceSchema(accumulator, column, columnIndex) {\r\n        // intentional redefintion of column.  This causes scrollCache to be in the correct order\r\n        column = s[self.orders.columns[columnIndex]];\r\n        if (column.hidden) {\r\n          self.scrollCache.x[columnIndex] = accumulator;\r\n          return accumulator;\r\n        }\r\n        var va =\r\n          accumulator + self.getColumnWidth(self.orders.columns[columnIndex]);\r\n        self.scrollCache.x[columnIndex] = va;\r\n        return va;\r\n      }, 0) || 0;\r\n    if (self.attributes.showNewRow) {\r\n      dataHeight += ch;\r\n    }\r\n    if (self.attributes.snapToRow) {\r\n      dataHeight += self.style.cellHeight;\r\n    }\r\n    setCanvasSize();\r\n    if (self.isChildGrid) {\r\n      self.width = self.parentNode.offsetWidth;\r\n      self.height = self.parentNode.offsetHeight;\r\n    } else if (\r\n      self.height !== self.canvas.offsetHeight ||\r\n      self.width !== self.canvas.offsetWidth\r\n    ) {\r\n      self.height = self.canvas.offsetHeight;\r\n      self.width = self.canvas.offsetWidth;\r\n      self.canvasOffsetLeft = self.args.canvasOffsetLeft || 0;\r\n      self.canvasOffsetTop = self.args.canvasOffsetTop || 0;\r\n    }\r\n    /// calculate scroll bar dimensions\r\n    // non-controversial\r\n    self.scrollBox.top = columnHeaderCellHeight + columnHeaderCellBorder;\r\n    self.scrollBox.left = rowHeaderCellWidth;\r\n    // width and height of scroll box\r\n    setScrollBoxSize();\r\n    // is the data larger than the scroll box\r\n    checkScrollBoxVisibility();\r\n    // if the scroll box is visible, make room for it by expanding the size of the element\r\n    // if the other dimension is set to auto\r\n    if (self.scrollBox.horizontalBarVisible) {\r\n      if (self.style.height === 'auto' && !self.isChildGrid) {\r\n        self.height += sbw;\r\n      }\r\n      dataHeight += sbw;\r\n      setCanvasSize();\r\n      setScrollBoxSize();\r\n      checkScrollBoxVisibility();\r\n    }\r\n    if (self.scrollBox.verticalBarVisible) {\r\n      if (self.style.width === 'auto' && !self.isChildGrid) {\r\n        self.width += sbw;\r\n      }\r\n      dataWidth += sbw;\r\n      setCanvasSize();\r\n      setScrollBoxSize();\r\n      checkScrollBoxVisibility();\r\n    }\r\n    // set again after bar visibility checks\r\n    setScrollBoxSize();\r\n    self.scrollBox.scrollWidth = dataWidth - self.scrollBox.width;\r\n    self.scrollBox.scrollHeight = dataHeight - self.scrollBox.height;\r\n    if (self.frozenColumn > 0) {\r\n      self.scrollBox.widthBoxRatio =\r\n        (self.scrollBox.width - self.scrollCache.x[self.frozenColumn - 1]) /\r\n        dataWidth;\r\n    } else {\r\n      self.scrollBox.widthBoxRatio = self.scrollBox.width / dataWidth;\r\n    }\r\n    self.scrollBox.scrollBoxWidth =\r\n      self.scrollBox.width * self.scrollBox.widthBoxRatio -\r\n      self.style.scrollBarWidth -\r\n      b -\r\n      d;\r\n    // TODO: This heightBoxRatio number is terribly wrong.\r\n    // They should be a result of the size of the grid/canvas?\r\n    // it being off causes the scroll bar to \"slide\" under\r\n    // the dragged mouse.\r\n    // https://github.com/TonyGermaneri/canvas-datagrid/issues/97\r\n    self.scrollBox.heightBoxRatio =\r\n      (self.scrollBox.height -\r\n        columnHeaderCellHeight -\r\n        self.scrollCache.y[self.frozenRow]) /\r\n      dataHeight;\r\n    self.scrollBox.scrollBoxHeight =\r\n      self.scrollBox.height * self.scrollBox.heightBoxRatio -\r\n      self.style.scrollBarWidth -\r\n      b -\r\n      d;\r\n    self.scrollBox.scrollBoxWidth = Math.max(\r\n      self.scrollBox.scrollBoxWidth,\r\n      self.style.scrollBarBoxMinSize,\r\n    );\r\n    self.scrollBox.scrollBoxHeight = Math.max(\r\n      self.scrollBox.scrollBoxHeight,\r\n      self.style.scrollBarBoxMinSize,\r\n    );\r\n    // horizontal\r\n    n.x += rowHeaderCellWidth;\r\n    n.y += self.height - self.style.scrollBarWidth - d;\r\n    n.width =\r\n      self.width - self.style.scrollBarWidth - rowHeaderCellWidth - d - m;\r\n    n.height = self.style.scrollBarWidth + self.style.scrollBarBorderWidth + d;\r\n    // horizontal box\r\n    nb.y = n.y + self.style.scrollBarBoxMargin;\r\n    nb.width = self.scrollBox.scrollBoxWidth;\r\n    nb.height = self.style.scrollBarBoxWidth;\r\n    // vertical\r\n    v.x +=\r\n      self.width -\r\n      self.style.scrollBarWidth -\r\n      self.style.scrollBarBorderWidth -\r\n      d;\r\n    v.y += columnHeaderCellHeight + self.scrollCache.y[self.frozenRow];\r\n    v.width = self.style.scrollBarWidth + self.style.scrollBarBorderWidth + d;\r\n    v.height =\r\n      self.height - columnHeaderCellHeight - self.style.scrollBarWidth - d - m;\r\n    // vertical box\r\n    vb.x = v.x + self.style.scrollBarBoxMargin;\r\n    vb.y += self.scrollCache.y[self.frozenRow];\r\n    vb.width = self.style.scrollBarBoxWidth;\r\n    vb.height = self.scrollBox.scrollBoxHeight;\r\n    // corner\r\n    co.x = n.x + n.width + m;\r\n    co.y = v.y + v.height + m;\r\n    co.width = self.style.scrollBarWidth + self.style.scrollBarBorderWidth;\r\n    co.height = self.style.scrollBarWidth + self.style.scrollBarBorderWidth;\r\n    self.scrollBox.entities = {\r\n      horizontalBar: n,\r\n      horizontalBox: nb,\r\n      verticalBar: v,\r\n      verticalBox: vb,\r\n      corner: co,\r\n    };\r\n    self.scrollBox.bar = {\r\n      v: v,\r\n      h: n,\r\n    };\r\n    self.scrollBox.box = {\r\n      v: vb,\r\n      h: nb,\r\n    };\r\n    /// calculate page and dom elements\r\n    self.page = Math.max(\r\n      1,\r\n      self.visibleRows.length - 3 - self.attributes.pageUpDownOverlap,\r\n    );\r\n    // set canvas drawing related items\r\n    if (!self.isChildGrid) {\r\n      self.canvas.width = self.width * ratio;\r\n      self.canvas.height = self.height * ratio;\r\n      self.ctx.scale(ratio, ratio);\r\n    }\r\n    // resize any open dom elements (input/textarea)\r\n    self.resizeEditInput();\r\n    self.scroll(true);\r\n    if (drawAfterResize) {\r\n      self.draw(true);\r\n    }\r\n    self.dispatchEvent('resize', {});\r\n    return true;\r\n  };\r\n  self.scroll = function (dontDraw) {\r\n    var s = self.getSchema(),\r\n      l = (self.viewData || []).length,\r\n      ch = self.style.cellHeight;\r\n    // go too far in leaps, then get focused\r\n    self.scrollIndexTop = Math.floor(\r\n      l * (self.scrollBox.scrollTop / self.scrollBox.scrollHeight) - 100,\r\n    );\r\n    self.scrollIndexTop = Math.max(self.scrollIndexTop, 0);\r\n    self.scrollPixelTop = self.scrollCache.y[self.scrollIndexTop];\r\n    // sometimes the grid is rendered but the height is zero\r\n    if (self.scrollBox.scrollHeight === 0) {\r\n      self.scrollIndexTop = 0;\r\n    }\r\n    self.scrollPixelTop = 0;\r\n    self.scrollIndexLeft = self.frozenColumn;\r\n    self.scrollPixelLeft = 0;\r\n    while (\r\n      self.scrollPixelTop < self.scrollBox.scrollTop &&\r\n      self.scrollIndexTop < self.viewData.length\r\n    ) {\r\n      // start on index +1 since index 0 was used in \"go too far\" section above\r\n      self.scrollIndexTop += 1;\r\n      self.scrollPixelTop = self.scrollCache.y[self.scrollIndexTop];\r\n    }\r\n    while (\r\n      self.scrollPixelLeft < self.scrollBox.scrollLeft + 1 &&\r\n      self.scrollIndexLeft < s.length\r\n    ) {\r\n      self.scrollPixelLeft = self.scrollCache.x[self.scrollIndexLeft];\r\n      self.scrollIndexLeft += 1;\r\n    }\r\n    if (s.length > 0) {\r\n      self.scrollIndexLeft = Math.max(self.scrollIndexLeft - 1, 0);\r\n      self.scrollPixelLeft -= self.getColumnWidth(\r\n        self.orders.columns[self.scrollIndexLeft],\r\n      );\r\n    }\r\n    if ((self.viewData || []).length > 0) {\r\n      self.scrollIndexTop = Math.max(self.scrollIndexTop - 1, 0);\r\n      self.scrollPixelTop = Math.max(\r\n        self.scrollPixelTop -\r\n          (self.viewData[self.scrollIndexTop]\r\n            ? (self.sizes.rows[self.scrollIndexTop] || ch) +\r\n              (self.sizes.trees[self.scrollIndexTop] || 0)\r\n            : ch) *\r\n            self.scale,\r\n        0,\r\n      );\r\n    }\r\n    self.ellipsisCache = {};\r\n    if (!dontDraw) {\r\n      self.draw(true);\r\n    }\r\n    //TODO: figure out why this has to be delayed for child grids\r\n    //BUG: wheeling event on 3rd level hierarchy fails to move input box\r\n    requestAnimationFrame(self.resizeEditInput);\r\n    self.dispatchEvent('scroll', {\r\n      top: self.scrollBox.scrollTop,\r\n      left: self.scrollBox.scrollLeft,\r\n    });\r\n  };\r\n  self.mousemove = function (e, overridePos) {\r\n    if (self.contextMenu || self.input) {\r\n      return;\r\n    }\r\n    self.mouse = overridePos || self.getLayerPos(e);\r\n    var ctrl =\r\n        (e.ctrlKey || e.metaKey || self.attributes.persistantSelectionMode) &&\r\n        !self.attributes.singleSelectionMode,\r\n      i,\r\n      s = self.getSchema(),\r\n      dragBounds,\r\n      sBounds,\r\n      x = self.mouse.x,\r\n      y = self.mouse.y,\r\n      cell = self.getCellAt(x, y),\r\n      delta,\r\n      ev = { NativeEvent: e, cell: cell, x: x, y: y },\r\n      previousCell = self.currentCell;\r\n    clearTimeout(self.scrollTimer);\r\n    if (!self.isInGrid({ x: x, y: y })) {\r\n      self.hasFocus = false;\r\n    }\r\n    if (self.dispatchEvent('mousemove', ev)) {\r\n      return;\r\n    }\r\n    if (cell && self.currentCell) {\r\n      self.rowBoundaryCrossed = self.currentCell.rowIndex !== cell.rowIndex;\r\n      self.columnBoundaryCrossed =\r\n        self.currentCell.columnIndex !== cell.columnIndex;\r\n      self.cellBoundaryCrossed =\r\n        self.rowBoundaryCrossed || self.columnBoundaryCrossed;\r\n      ['row', 'column', 'cell'].forEach(function (prefix) {\r\n        if (self[prefix + 'BoundaryCrossed']) {\r\n          ev.cell = previousCell;\r\n          self.dispatchEvent(prefix + 'mouseout', ev);\r\n          ev.cell = cell;\r\n          self.dispatchEvent(prefix + 'mouseover', ev);\r\n        }\r\n      });\r\n    }\r\n    self.currentCell = cell;\r\n\r\n    self.hovers = {};\r\n    if (!self.draggingItem && cell) {\r\n      self.dragItem = cell;\r\n      self.dragMode = cell.dragContext;\r\n      self.cursor = cell.context;\r\n      if (cell.context === 'cell') {\r\n        self.cursor = 'default';\r\n        self.hovers = {\r\n          rowIndex: cell.rowIndex,\r\n          columnIndex: cell.columnIndex,\r\n          onFilterButton: false,\r\n        };\r\n        if (\r\n          cell.isFilterable &&\r\n          x >\r\n            cell.x +\r\n              cell.width +\r\n              self.canvasOffsetLeft -\r\n              self.style.filterButtonWidth &&\r\n          x < cell.x + cell.width + self.canvasOffsetLeft &&\r\n          y >\r\n            cell.y +\r\n              cell.height +\r\n              self.canvasOffsetTop -\r\n              self.style.filterButtonHeight &&\r\n          y < cell.y + cell.height + self.canvasOffsetTop\r\n        ) {\r\n          self.hovers.onFilterButton = true;\r\n          self.draw();\r\n        }\r\n      }\r\n      if (self.selecting || self.reorderObject) {\r\n        delta = {\r\n          x: Math.abs(self.dragStart.x - x),\r\n          y: Math.abs(self.dragStart.y - y),\r\n        };\r\n        if (self.dragStartObject.columnIndex !== -1 && e.shiftKey) {\r\n          self.dragStartObject = {\r\n            rowIndex: self.activeCell.rowIndex,\r\n            columnIndex: self.activeCell.columnIndex,\r\n          };\r\n        }\r\n        dragBounds = {\r\n          top: Math.min(self.dragStartObject.rowIndex, cell.rowIndex),\r\n          left: Math.min(self.dragStartObject.columnIndex, cell.columnIndex),\r\n          bottom: Math.max(self.dragStartObject.rowIndex, cell.rowIndex),\r\n          right: Math.max(self.dragStartObject.columnIndex, cell.columnIndex),\r\n        };\r\n        if (self.dragStartObject.columnIndex === -1) {\r\n          sBounds = self.getSelectionBounds();\r\n          dragBounds.left = -1;\r\n          dragBounds.right = s.length - 1;\r\n          dragBounds.top = Math.min(sBounds.top, cell.rowIndex);\r\n          dragBounds.bottom = Math.max(sBounds.bottom, cell.rowIndex);\r\n        }\r\n        if (\r\n          self.dragStartObject.rowIndex !== cell.rowIndex ||\r\n          self.dragStartObject.columnIndex !== cell.columnIndex\r\n        ) {\r\n          self.ignoreNextClick = true;\r\n        }\r\n        if (\r\n          self.cellBoundaryCrossed ||\r\n          (delta.x === 0 && delta.y === 0) ||\r\n          self.attributes.selectionMode === 'row'\r\n        ) {\r\n          if (\r\n            (self.attributes.selectionMode === 'row' ||\r\n              self.dragStartObject.columnIndex === -1) &&\r\n            self.rowBoundaryCrossed\r\n          ) {\r\n            self.selectRow(cell.rowIndex, ctrl, null, true);\r\n          } else if (self.attributes.selectionMode !== 'row') {\r\n            if (cell.hovered && self.hovers.onFilterButton) {\r\n              if (cell.openedFilter) {\r\n                cell.openedFilter = false;\r\n                self.selectedFilterButton = {\r\n                  columnIndex: -1,\r\n                  rowIndex: -1,\r\n                };\r\n              } else {\r\n                self.selectedFilterButton.rowIndex = cell.rowIndex;\r\n                self.selectedFilterButton.columnIndex = cell.columnIndex;\r\n                self.contextmenuEvent(e, {\r\n                  x: cell.x + cell.width - self.style.filterButtonWidth,\r\n                  y: cell.y + cell.height,\r\n                  rect: { left: 0, top: 0 },\r\n                });\r\n              }\r\n              self.draw();\r\n              return;\r\n            } else {\r\n              self.selectedFilterButton = {\r\n                columnIndex: -1,\r\n                rowIndex: -1,\r\n              };\r\n              if (self.hovers.onFilterButton) return;\r\n              if (!self.dragAddToSelection && cell.rowIndex !== undefined) {\r\n                if (\r\n                  self.selections[cell.rowIndex] &&\r\n                  self.selections[cell.rowIndex].indexOf(cell.columnIndex) !==\r\n                    -1\r\n                ) {\r\n                  self.selections[cell.rowIndex].splice(\r\n                    self.selections[cell.rowIndex].indexOf(cell.columnIndex),\r\n                    1,\r\n                  );\r\n                }\r\n              } else {\r\n                self.selections[cell.rowIndex] =\r\n                  self.selections[cell.rowIndex] || [];\r\n                if (\r\n                  self.selections[cell.rowIndex].indexOf(cell.columnIndex) ===\r\n                  -1\r\n                ) {\r\n                  self.selections[cell.rowIndex].push(cell.columnIndex);\r\n                  var event = {\r\n                    selections: self.selections,\r\n                    selectedData: self.getSelectedData(),\r\n                    selectedCells: self.getSelectedCells(),\r\n                    selectionBounds: self.getSelectionBounds(),\r\n                  };\r\n                  self.dispatchEvent('selectionchanged', event);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n        if (\r\n          (!self.selectionBounds ||\r\n            dragBounds.top !== self.selectionBounds.top ||\r\n            dragBounds.left !== self.selectionBounds.left ||\r\n            dragBounds.bottom !== self.selectionBounds.bottom ||\r\n            dragBounds.right !== self.selectionBounds.right) &&\r\n          !ctrl\r\n        ) {\r\n          if (!(cell.hovered && self.hovers.onFilterButton)) {\r\n            self.selections = [];\r\n          }\r\n          if (dragBounds.top === -1) {\r\n            dragBounds.top = 0;\r\n          }\r\n          sBounds = dragBounds;\r\n          if (self.attributes.selectionMode === 'row') {\r\n            for (i = sBounds.top; i <= sBounds.bottom; i += 1) {\r\n              self.selectRow(i, true, null, true);\r\n            }\r\n          } else {\r\n            self.selectArea(sBounds, true);\r\n            if (sBounds.left == -1 && sBounds.top !== sBounds.bottom)\r\n              self.isMultiRowsSelected = true;\r\n          }\r\n        }\r\n\r\n        if (self.attributes.autoScrollOnMousemove) {\r\n          var movedVertically = delta.y > self.attributes.autoScrollMargin;\r\n          var movedHorizontally = delta.x > self.attributes.autoScrollMargin;\r\n\r\n          if (movedVertically && !movedHorizontally)\r\n            self.autoScrollZone(e, -1, y, ctrl);\r\n          else if (movedHorizontally && !movedVertically)\r\n            self.autoScrollZone(e, x, -1, ctrl);\r\n          else if (movedHorizontally && movedVertically)\r\n            self.autoScrollZone(e, x, y, ctrl);\r\n        } else {\r\n          self.autoScrollZone(e, x, y, ctrl);\r\n        }\r\n      }\r\n    }\r\n    self.cellBoundaryCrossed = false;\r\n    self.rowBoundaryCrossed = false;\r\n    self.columnBoundaryCrossed = false;\r\n    self.draw(true);\r\n  };\r\n  self.click = function (e, overridePos) {\r\n    var i,\r\n      startingBounds = JSON.stringify(self.getSelectionBounds()),\r\n      ctrl =\r\n        (e.ctrlKey || e.metaKey || self.attributes.persistantSelectionMode) &&\r\n        !self.attributes.singleSelectionMode,\r\n      pos = overridePos || self.getLayerPos(e);\r\n    self.currentCell = self.getCellAt(pos.x, pos.y);\r\n    if (self.currentCell.grid !== undefined) {\r\n      return;\r\n    }\r\n    function checkSelectionChange() {\r\n      var ev,\r\n        sb = self.getSelectionBounds();\r\n\r\n      if (startingBounds === JSON.stringify(sb)) {\r\n        return;\r\n      }\r\n      ev = {\r\n        selections: self.selections,\r\n        selectionBounds: self.getSelectionBounds(),\r\n        selectedCells: self.getSelectedCells(),\r\n      };\r\n      Object.defineProperty(ev, 'selectedData', {\r\n        get: function () {\r\n          return self.getSelectedData();\r\n        },\r\n      });\r\n      self.dispatchEvent('selectionchanged', ev);\r\n    }\r\n    if (self.input) {\r\n      self.endEdit();\r\n    }\r\n    if (self.ignoreNextClick) {\r\n      self.ignoreNextClick = false;\r\n      return;\r\n    }\r\n    i = self.currentCell;\r\n    if (\r\n      self.dispatchEvent('click', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n    if (\r\n      ['rowHeaderCell', 'columnHeaderCell'].indexOf(self.currentCell.style) ===\r\n        -1 &&\r\n      !ctrl\r\n    ) {\r\n      if (!self.hovers.onFilterButton) {\r\n        self.setActiveCell(i.columnIndex, i.rowIndex);\r\n      }\r\n    }\r\n    if (self.currentCell.context === 'cell') {\r\n      if (self.currentCell.style === 'cornerCell') {\r\n        self.selectAll();\r\n        self.draw();\r\n        checkSelectionChange();\r\n        return;\r\n      }\r\n      if (self.currentCell.style === 'columnHeaderCell') {\r\n        if (self.attributes.columnHeaderClickBehavior === 'sort') {\r\n          if (self.orderBy === i.header.name) {\r\n            self.orderDirection =\r\n              self.orderDirection === 'asc' ? 'desc' : 'asc';\r\n          } else {\r\n            self.orderDirection = 'asc';\r\n          }\r\n          self.order(i.header.name, self.orderDirection);\r\n          checkSelectionChange();\r\n          return;\r\n        }\r\n      }\r\n      self.selections[i.rowIndex] = self.selections[i.rowIndex] || [];\r\n      if (\r\n        self.attributes.selectionMode === 'row' ||\r\n        self.currentCell.style === 'rowHeaderCell'\r\n      ) {\r\n        if (\r\n          self.currentCell.style === 'rowHeaderCell' &&\r\n          self.attributes.tree &&\r\n          pos.x > 0 &&\r\n          pos.x - self.currentCell.x <\r\n            self.style.treeArrowWidth +\r\n              self.style.treeArrowMarginLeft +\r\n              self.style.treeArrowMarginRight +\r\n              self.style.treeArrowClickRadius &&\r\n          pos.y - self.currentCell.y <\r\n            self.style.treeArrowHeight +\r\n              self.style.treeArrowMarginTop +\r\n              self.style.treeArrowClickRadius &&\r\n          pos.y > 0\r\n        ) {\r\n          self.toggleTree(i.rowIndex);\r\n          return;\r\n        }\r\n      }\r\n      if (e.shiftKey && !ctrl) {\r\n        self.selectionBounds = self.getSelectionBounds();\r\n        self.selectArea(undefined, false);\r\n      }\r\n    }\r\n    checkSelectionChange();\r\n    self.draw(true);\r\n  };\r\n  self.dragResizeColumn = function (e) {\r\n    var pos, x, y;\r\n    pos = self.getLayerPos(e);\r\n    x = self.resizingStartingWidth + pos.x - self.dragStart.x;\r\n    y = self.resizingStartingHeight + pos.y - self.dragStart.y;\r\n    if (x < self.style.minColumnWidth) {\r\n      x = self.style.minColumnWidth;\r\n    }\r\n    if (y < self.style.minRowHeight) {\r\n      y = self.style.minRowHeight;\r\n    }\r\n    if (\r\n      self.dispatchEvent('resizecolumn', {\r\n        x: x,\r\n        y: y,\r\n        draggingItem: self.draggingItem,\r\n      })\r\n    ) {\r\n      return false;\r\n    }\r\n    if (\r\n      self.scrollBox.scrollLeft >\r\n        self.scrollBox.scrollWidth - self.attributes.resizeScrollZone &&\r\n      self.dragMode === 'ew-resize'\r\n    ) {\r\n      self.resize(true);\r\n      self.scrollBox.scrollLeft += x;\r\n    }\r\n    if (self.dragMode === 'ew-resize') {\r\n      self.sizes.columns[\r\n        self.draggingItem.header.style === 'rowHeaderCell'\r\n          ? 'cornerCell'\r\n          : self.draggingItem.sortColumnIndex\r\n      ] = x;\r\n      if (\r\n        ['rowHeaderCell', 'cornerCell'].indexOf(\r\n          self.draggingItem.header.style,\r\n        ) !== -1\r\n      ) {\r\n        self.resize(true);\r\n      }\r\n      self.resizeChildGrids();\r\n      return;\r\n    }\r\n    if (self.dragMode === 'ns-resize') {\r\n      if (self.draggingItem.rowOpen) {\r\n        self.sizes.trees[self.draggingItem.rowIndex] = y;\r\n      } else if (self.attributes.globalRowResize) {\r\n        self.style.cellHeight = y;\r\n      } else {\r\n        self.sizes.rows[self.draggingItem.rowIndex] = y;\r\n      }\r\n      self.dispatchEvent('resizerow', { row: y });\r\n      self.resizeChildGrids();\r\n      return;\r\n    }\r\n    self.ellipsisCache = {};\r\n  };\r\n  self.stopDragResize = function (event) {\r\n    const pos = self.getLayerPos(event);\r\n\r\n    if (self.dragMode === 'ew-resize') {\r\n      const hasMoved = !!(pos.x - self.dragStart.x);\r\n      // Check that dragItem is selected or part of selection.\r\n      const dragItemIsSelected = self.isColumnSelected(\r\n        self.dragItem.columnIndex,\r\n      );\r\n\r\n      if (hasMoved && dragItemIsSelected) {\r\n        const width = Math.max(\r\n          self.resizingStartingWidth + pos.x - self.dragStart.x,\r\n          self.style.minColumnWidth,\r\n        );\r\n        // If the column is selected, resize it to width plus any other selected columns.\r\n        self.fitSelectedColumns(width);\r\n      }\r\n    }\r\n\r\n    self.resize();\r\n    document.body.removeEventListener(\r\n      'mousemove',\r\n      self.dragResizeColumn,\r\n      false,\r\n    );\r\n    document.body.removeEventListener('mouseup', self.stopDragResize, false);\r\n    self.setStorageData();\r\n    self.draw(true);\r\n    self.ignoreNextClick = true;\r\n  };\r\n  self.scrollGrid = function (e) {\r\n    var pos = self.getLayerPos(e);\r\n    if (\r\n      self.attributes.scrollPointerLock &&\r\n      self.pointerLockPosition &&\r\n      ['horizontal-scroll-box', 'vertical-scroll-box'].indexOf(\r\n        self.scrollStartMode,\r\n      ) !== -1\r\n    ) {\r\n      self.pointerLockPosition.x += e.movementX;\r\n      self.pointerLockPosition.y += e.movementY;\r\n      self.pointerLockPosition.x = Math.min(\r\n        self.width - self.style.scrollBarWidth,\r\n        Math.max(0, self.pointerLockPosition.x),\r\n      );\r\n      self.pointerLockPosition.y = Math.min(\r\n        self.height - self.style.scrollBarWidth,\r\n        Math.max(0, self.pointerLockPosition.y),\r\n      );\r\n      pos = self.pointerLockPosition;\r\n    }\r\n    self.scrollMode = self.getCellAt(pos.x, pos.y).context;\r\n    if (\r\n      self.scrollMode === 'horizontal-scroll-box' &&\r\n      self.scrollStartMode !== 'horizontal-scroll-box'\r\n    ) {\r\n      self.scrollStartMode = 'horizontal-scroll-box';\r\n      self.dragStart = pos;\r\n      self.scrollStart.left = self.scrollBox.scrollLeft;\r\n      clearTimeout(self.scrollTimer);\r\n      return;\r\n    }\r\n    if (\r\n      self.scrollMode === 'vertical-scroll-box' &&\r\n      self.scrollStartMode !== 'vertical-scroll-box'\r\n    ) {\r\n      self.scrollStartMode = 'vertical-scroll-box';\r\n      self.dragStart = pos;\r\n      self.scrollStart.top = self.scrollBox.scrollTop;\r\n      clearTimeout(self.scrollTimer);\r\n      return;\r\n    }\r\n    if (\r\n      self.scrollStartMode === 'vertical-scroll-box' &&\r\n      self.scrollMode !== 'vertical-scroll-box'\r\n    ) {\r\n      self.scrollMode = 'vertical-scroll-box';\r\n    }\r\n    if (\r\n      self.scrollStartMode === 'horizontal-scroll-box' &&\r\n      self.scrollMode !== 'horizontal-scroll-box'\r\n    ) {\r\n      self.scrollMode = 'horizontal-scroll-box';\r\n    }\r\n    clearTimeout(self.scrollTimer);\r\n    if (self.scrollModes.indexOf(self.scrollMode) === -1) {\r\n      return;\r\n    }\r\n    if (self.scrollMode === 'vertical-scroll-box') {\r\n      self.scrollBox.scrollTop =\r\n        self.scrollStart.top +\r\n        (pos.y - self.dragStart.y) / self.scrollBox.heightBoxRatio;\r\n    } else if (self.scrollMode === 'vertical-scroll-top') {\r\n      self.scrollBox.scrollTop -= self.page * self.style.cellHeight;\r\n      self.scrollTimer = setTimeout(\r\n        self.scrollGrid,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    } else if (self.scrollMode === 'vertical-scroll-bottom') {\r\n      self.scrollBox.scrollTop += self.page * self.style.cellHeight;\r\n      self.scrollTimer = setTimeout(\r\n        self.scrollGrid,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    }\r\n    if (self.scrollMode === 'horizontal-scroll-box') {\r\n      self.scrollBox.scrollLeft =\r\n        self.scrollStart.left +\r\n        (pos.x - self.dragStart.x) / self.scrollBox.widthBoxRatio;\r\n    } else if (self.scrollMode === 'horizontal-scroll-right') {\r\n      self.scrollBox.scrollLeft += self.attributes.selectionScrollIncrement;\r\n      self.scrollTimer = setTimeout(\r\n        self.scrollGrid,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    } else if (self.scrollMode === 'horizontal-scroll-left') {\r\n      self.scrollBox.scrollLeft -= self.attributes.selectionScrollIncrement;\r\n      self.scrollTimer = setTimeout(\r\n        self.scrollGrid,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    }\r\n  };\r\n  self.stopScrollGrid = function () {\r\n    clearTimeout(self.scrollTimer);\r\n    if (document.exitPointerLock) {\r\n      document.exitPointerLock();\r\n    }\r\n    document.removeEventListener('mousemove', self.scrollGrid, false);\r\n  };\r\n  self.dragReorder = function (e) {\r\n    var pos,\r\n      x,\r\n      y,\r\n      columReorder = self.dragMode === 'column-reorder',\r\n      rowReorder = self.dragMode === 'row-reorder';\r\n    pos = self.getLayerPos(e);\r\n    x = pos.x - self.dragStart.x;\r\n    y = pos.y - self.dragStart.y;\r\n    if (!self.attributes.allowColumnReordering && columReorder) {\r\n      return;\r\n    }\r\n    if (!self.attributes.allowRowReordering && rowReorder) {\r\n      return;\r\n    }\r\n    if ((e.ctrlKey || e.metaKey || e.shiftKey) && self.reorderObject) {\r\n      if (\r\n        self.dragMode === 'column-reorder' &&\r\n        !self.isMultiColumnsSelected(self.draggingItem.header.index)\r\n      ) {\r\n        self.selectColumn(self.draggingItem.header.index, false, false);\r\n      }\r\n    }\r\n    if (\r\n      self.dispatchEvent('reordering', {\r\n        NativeEvent: e,\r\n        source: self.dragStartObject,\r\n        target: self.currentCell,\r\n        dragMode: self.dragMode,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    if (\r\n      Math.abs(x) > self.attributes.reorderDeadZone ||\r\n      Math.abs(y) > self.attributes.reorderDeadZone\r\n    ) {\r\n      self.reorderObject = self.draggingItem;\r\n      if (self.isMultiRowsSelected)\r\n        self.reorderObject = self.getVisibleCellByIndex(\r\n          -1,\r\n          self.activeCell.rowIndex,\r\n        );\r\n      self.reorderTarget = self.currentCell;\r\n      self.reorderObject.dragOffset = {\r\n        x: x,\r\n        y: y,\r\n      };\r\n      self.autoScrollZone(\r\n        e,\r\n        columReorder ? pos.x : -1,\r\n        rowReorder ? pos.y : -1,\r\n        false,\r\n      );\r\n    }\r\n  };\r\n  self.stopDragReorder = function (e) {\r\n    var oIndex,\r\n      tIndex,\r\n      odata = [],\r\n      cr = {\r\n        'row-reorder': self.orders.rows,\r\n        'column-reorder': self.orders.columns,\r\n      },\r\n      i = {\r\n        'row-reorder': 'rowIndex',\r\n        'column-reorder': 'sortColumnIndex',\r\n      }[self.dragMode];\r\n    document.body.removeEventListener('mousemove', self.dragReorder, false);\r\n    document.body.removeEventListener('mouseup', self.stopDragReorder, false);\r\n    if (\r\n      self.reorderObject &&\r\n      self.reorderTarget &&\r\n      ((self.dragMode === 'column-reorder' &&\r\n        self.reorderTarget.sortColumnIndex > -1 &&\r\n        self.reorderTarget.sortColumnIndex < self.getSchema().length) ||\r\n        (self.dragMode === 'row-reorder' &&\r\n          self.reorderTarget.rowIndex > -1 &&\r\n          self.reorderTarget.rowIndex < self.viewData.length)) &&\r\n      self.reorderObject[i] !== self.reorderTarget[i] &&\r\n      !self.dispatchEvent('reorder', {\r\n        NativeEvent: e,\r\n        source: self.reorderObject,\r\n        target: self.reorderTarget,\r\n        dragMode: self.dragMode,\r\n      })\r\n    ) {\r\n      self.ignoreNextClick = true;\r\n      oIndex = cr[self.dragMode].indexOf(self.reorderObject[i]);\r\n      tIndex = cr[self.dragMode].indexOf(self.reorderTarget[i]);\r\n      if (self.dragMode === 'column-reorder') {\r\n        var sortColumnIndices = [];\r\n        var seletedColumnIndices = [];\r\n        if (self.selections[0]) {\r\n          self.selections[0].forEach(function (value) {\r\n            sortColumnIndices.push(self.orders.columns[value]);\r\n          });\r\n        }\r\n        var deleteCount = sortColumnIndices.length;\r\n        cr[self.dragMode].splice(oIndex, deleteCount);\r\n        if (tIndex > oIndex) tIndex = tIndex - (deleteCount - 1);\r\n        for (var i = 0; i < sortColumnIndices.length; i++) {\r\n          seletedColumnIndices.push(tIndex + i);\r\n          cr[self.dragMode].splice(tIndex + i, 0, sortColumnIndices[i]);\r\n        }\r\n        self.orders.columns = cr[self.dragMode];\r\n        self.viewData.forEach(function (row, rowIndex) {\r\n          self.selections[rowIndex] = seletedColumnIndices;\r\n        });\r\n      } else {\r\n        var selectedRows = [];\r\n        self.selections.forEach(function (row, rowIndex) {\r\n          if (row) {\r\n            selectedRows.push(row);\r\n            odata.push(self.viewData[rowIndex]);\r\n          }\r\n        });\r\n        self.viewData.splice(oIndex, odata.length);\r\n        self.selections = [];\r\n        if (tIndex > oIndex) tIndex = tIndex - (odata.length - 1);\r\n        self.activeCell.rowIndex = tIndex;\r\n        for (var i = 0; i < odata.length; i++) {\r\n          self.viewData.splice(tIndex + i, 0, odata[i]);\r\n          self.selections[tIndex + i] = selectedRows[i];\r\n        }\r\n      }\r\n      self.resize();\r\n      self.setStorageData();\r\n    }\r\n    self.reorderObject = undefined;\r\n    self.reorderTarget = undefined;\r\n    self.draw(true);\r\n  };\r\n  self.dragMove = function (e) {\r\n    if (\r\n      self.dispatchEvent('moving', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    var pos = self.getLayerPos(e);\r\n    self.moveOffset = {\r\n      x: self.currentCell.columnIndex - self.dragStartObject.columnIndex,\r\n      y: self.currentCell.rowIndex - self.dragStartObject.rowIndex,\r\n    };\r\n    if (\r\n      Math.abs(pos.x) > self.attributes.reorderDeadZone ||\r\n      Math.abs(pos.y) > self.attributes.reorderDeadZone\r\n    ) {\r\n      setTimeout(function () {\r\n        self.autoScrollZone(e, pos.x, pos.y, false);\r\n      }, 1);\r\n    }\r\n  };\r\n  self.stopDragMove = function (e) {\r\n    document.body.removeEventListener('mousemove', self.dragMove, false);\r\n    document.body.removeEventListener('mouseup', self.stopDragMove, false);\r\n    var b = self.getSelectionBounds();\r\n    if (\r\n      self.dispatchEvent('endmove', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      self.movingSelection = undefined;\r\n      self.moveOffset = undefined;\r\n      self.draw(true);\r\n      return;\r\n    }\r\n    if (self.moveOffset) {\r\n      self.moveTo(\r\n        self.movingSelection,\r\n        b.left + self.moveOffset.x,\r\n        b.top + self.moveOffset.y,\r\n      );\r\n      self.moveSelection(self.moveOffset.x, self.moveOffset.y);\r\n    }\r\n    self.movingSelection = undefined;\r\n    self.moveOffset = undefined;\r\n    self.draw(true);\r\n  };\r\n  self.freezeMove = function (e) {\r\n    if (\r\n      self.dispatchEvent('freezemoving', {\r\n        NativeEvent: e,\r\n        cell: self.currentCell,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    var pos = self.getLayerPos(e),\r\n      bm = self.style.gridBorderCollapse === 'collapse' ? 1 : 2,\r\n      columnHeaderCellBorder = self.style.columnHeaderCellBorderWidth * bm,\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight(),\r\n      rowHeaderCellWidth = self.getRowHeaderCellWidth();\r\n\r\n    self.ignoreNextClick = true;\r\n    self.freezeMarkerPosition = pos;\r\n    if (\r\n      self.currentCell &&\r\n      self.currentCell.rowIndex !== undefined &&\r\n      self.dragMode === 'frozen-row-marker'\r\n    ) {\r\n      self.scrollBox.scrollTop = 0;\r\n      self.frozenRow = self.currentCell.rowIndex + 1;\r\n      self.scrollBox.bar.v.y =\r\n        columnHeaderCellHeight +\r\n        columnHeaderCellBorder +\r\n        self.scrollCache.y[self.frozenRow];\r\n      self.scrollBox.box.v.y =\r\n        columnHeaderCellHeight +\r\n        columnHeaderCellBorder +\r\n        self.scrollCache.y[self.frozenRow];\r\n      var dataHeight = self.scrollCache.y[self.scrollCache.y.length - 1];\r\n      self.scrollBox.heightBoxRatio =\r\n        (self.scrollBox.height -\r\n          columnHeaderCellHeight -\r\n          self.scrollCache.y[self.frozenRow]) /\r\n        dataHeight;\r\n      self.scrollBox.scrollBoxHeight =\r\n        self.scrollBox.height * self.scrollBox.heightBoxRatio -\r\n        self.style.scrollBarWidth;\r\n      self.scrollBox.scrollBoxHeight = Math.max(\r\n        self.scrollBox.scrollBoxHeight,\r\n        self.style.scrollBarBoxMinSize,\r\n      );\r\n      self.scrollBox.box.v.height = self.scrollBox.scrollBoxHeight;\r\n    }\r\n    if (\r\n      self.currentCell &&\r\n      self.currentCell.columnIndex !== undefined &&\r\n      self.dragMode === 'frozen-column-marker'\r\n    ) {\r\n      self.scrollBox.scrollLeft = 0;\r\n      self.frozenColumn = self.currentCell.columnIndex + 1;\r\n      self.scrollBox.bar.h.x =\r\n        rowHeaderCellWidth + self.scrollCache.x[self.frozenColumn - 1];\r\n      self.scrollBox.box.h.x =\r\n        rowHeaderCellWidth + self.scrollCache.x[self.frozenColumn - 1];\r\n      var dataWidth = self.scrollCache.x[self.scrollCache.x.length - 1];\r\n      self.scrollBox.widthBoxRatio =\r\n        (self.scrollBox.width - self.scrollCache.x[self.frozenColumn - 1]) /\r\n        dataWidth;\r\n      self.scrollBox.scrollBoxWidth =\r\n        self.scrollBox.width * self.scrollBox.widthBoxRatio -\r\n        self.style.scrollBarWidth;\r\n      self.scrollBox.scrollBoxWidth = Math.max(\r\n        self.scrollBox.scrollBoxWidth,\r\n        self.style.scrollBarBoxMinSize,\r\n      );\r\n      self.scrollBox.box.h.width = self.scrollBox.scrollBoxWidth;\r\n    }\r\n    if (\r\n      Math.abs(pos.x) > self.attributes.reorderDeadZone ||\r\n      Math.abs(pos.y) > self.attributes.reorderDeadZone\r\n    ) {\r\n      setTimeout(function () {\r\n        self.autoScrollZone(e, pos.x, pos.y, false);\r\n      }, 1);\r\n    }\r\n  };\r\n  self.stopFreezeMove = function (e) {\r\n    document.body.removeEventListener('mousemove', self.freezeMove, false);\r\n    document.body.removeEventListener('mouseup', self.stopFreezeMove, false);\r\n    self.freezeMarkerPosition = undefined;\r\n    if (\r\n      self.dispatchEvent('endfreezemove', {\r\n        NativeEvent: e,\r\n        cell: self.currentCell,\r\n      })\r\n    ) {\r\n      self.frozenRow = self.startFreezeMove.x;\r\n      self.frozenColumn = self.startFreezeMove.y;\r\n      self.draw(true);\r\n      return;\r\n    }\r\n    self.draw(true);\r\n  };\r\n  self.mousedown = function (e, overridePos) {\r\n    self.lastMouseDownTarget = e.target;\r\n    if (\r\n      self.dispatchEvent('mousedown', {\r\n        NativeEvent: e,\r\n        cell: self.currentCell,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n    if (e.button === 2 || self.input) {\r\n      return;\r\n    }\r\n    var ctrl = e.ctrlKey || e.metaKey,\r\n      move = /-move/.test(self.dragMode),\r\n      freeze = /frozen-row-marker|frozen-column-marker/.test(self.dragMode),\r\n      resize = /-resize/.test(self.dragMode);\r\n    self.dragStart = overridePos || self.getLayerPos(e);\r\n    self.scrollStart = {\r\n      left: self.scrollBox.scrollLeft,\r\n      top: self.scrollBox.scrollTop,\r\n    };\r\n    self.dragStartObject = self.getCellAt(self.dragStart.x, self.dragStart.y);\r\n    self.dragAddToSelection = !self.dragStartObject.selected;\r\n    if (\r\n      !ctrl &&\r\n      !e.shiftKey &&\r\n      !/(vertical|horizontal)-scroll-(bar|box)/.test(\r\n        self.dragStartObject.context,\r\n      ) &&\r\n      self.currentCell &&\r\n      !self.currentCell.isColumnHeader &&\r\n      !move &&\r\n      !freeze &&\r\n      !resize\r\n    ) {\r\n      if (\r\n        !(self.dragMode == 'row-reorder' && self.isMultiRowsSelected) &&\r\n        !(self.currentCell.hovered && self.hovers.onFilterButton)\r\n      ) {\r\n        self.selections = [];\r\n      }\r\n    }\r\n    if (self.dragStartObject.isGrid) {\r\n      return;\r\n    }\r\n    if (self.scrollModes.indexOf(self.dragStartObject.context) !== -1) {\r\n      self.scrollMode = self.dragStartObject.context;\r\n      self.scrollStartMode = self.dragStartObject.context;\r\n      self.scrollGrid(e);\r\n      if (\r\n        self.attributes.scrollPointerLock &&\r\n        ['horizontal-scroll-box', 'vertical-scroll-box'].indexOf(\r\n          self.scrollStartMode,\r\n        ) !== -1\r\n      ) {\r\n        self.pointerLockPosition = {\r\n          x: self.dragStart.x,\r\n          y: self.dragStart.y,\r\n        };\r\n        self.canvas.requestPointerLock();\r\n      }\r\n      document.addEventListener('mousemove', self.scrollGrid, false);\r\n      document.addEventListener('mouseup', self.stopScrollGrid, false);\r\n      self.ignoreNextClick = true;\r\n      return;\r\n    }\r\n    if (self.dragMode === 'cell') {\r\n      self.selecting = true;\r\n      if (\r\n        (self.attributes.selectionMode === 'row' ||\r\n          self.dragStartObject.columnIndex === -1) &&\r\n        self.dragStartObject.rowIndex > -1\r\n      ) {\r\n        self.selectRow(self.dragStartObject.rowIndex, ctrl, null);\r\n      } else if (self.attributes.selectionMode !== 'row') {\r\n        self.mousemove(e);\r\n      }\r\n      return;\r\n    }\r\n    if (move) {\r\n      self.draggingItem = self.dragItem;\r\n      self.movingSelection = self.selections.concat([]);\r\n      self.dragging = self.dragStartObject;\r\n      if (\r\n        self.dispatchEvent('beginmove', {\r\n          NativeEvent: e,\r\n          cell: self.currentCell,\r\n        })\r\n      ) {\r\n        return;\r\n      }\r\n      document.body.addEventListener('mousemove', self.dragMove, false);\r\n      document.body.addEventListener('mouseup', self.stopDragMove, false);\r\n      return self.mousemove(e);\r\n    }\r\n    if (freeze) {\r\n      self.draggingItem = self.dragItem;\r\n      self.startFreezeMove = {\r\n        x: self.frozenRow,\r\n        y: self.frozenColumn,\r\n      };\r\n      if (self.dispatchEvent('beginfreezemove', { NativeEvent: e })) {\r\n        return;\r\n      }\r\n      document.body.addEventListener('mousemove', self.freezeMove, false);\r\n      document.body.addEventListener('mouseup', self.stopFreezeMove, false);\r\n      return self.mousemove(e);\r\n    }\r\n    if (resize) {\r\n      self.draggingItem = self.dragItem;\r\n      if (self.draggingItem.rowOpen) {\r\n        self.resizingStartingHeight =\r\n          self.sizes.trees[self.draggingItem.rowIndex];\r\n      } else {\r\n        self.resizingStartingHeight =\r\n          self.sizes.rows[self.draggingItem.rowIndex] || self.style.cellHeight;\r\n      }\r\n      self.resizingStartingWidth =\r\n        self.sizes.columns[\r\n          self.draggingItem.header.style === 'rowHeaderCell'\r\n            ? 'cornerCell'\r\n            : self.draggingItem.sortColumnIndex\r\n        ] || self.draggingItem.width;\r\n      document.body.addEventListener('mousemove', self.dragResizeColumn, false);\r\n      document.body.addEventListener('mouseup', self.stopDragResize, false);\r\n      return;\r\n    }\r\n    if (['row-reorder', 'column-reorder'].indexOf(self.dragMode) !== -1) {\r\n      self.draggingItem = self.dragStartObject;\r\n      if (\r\n        self.dragMode === 'column-reorder' &&\r\n        !self.isMultiColumnsSelected(self.currentCell.header.index)\r\n      ) {\r\n        self.selectColumn(self.currentCell.header.index, ctrl, e.shiftKey);\r\n      } else if (self.dragMode === 'row-reorder' && !self.isMultiRowsSelected) {\r\n        self.selectRow(self.dragStartObject.rowIndex, ctrl, null);\r\n      }\r\n      document.body.addEventListener('mousemove', self.dragReorder, false);\r\n      document.body.addEventListener('mouseup', self.stopDragReorder, false);\r\n      return;\r\n    }\r\n  };\r\n  self.mouseup = function (e) {\r\n    clearTimeout(self.scrollTimer);\r\n    self.cellBoundaryCrossed = true;\r\n    self.rowBoundaryCrossed = true;\r\n    self.columnBoundaryCrossed = true;\r\n    self.selecting = undefined;\r\n    self.draggingItem = undefined;\r\n    self.dragStartObject = undefined;\r\n    if (\r\n      self.dispatchEvent('mouseup', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus && e.target !== self.canvas) {\r\n      return;\r\n    }\r\n    if (self.currentCell && self.currentCell.grid !== undefined) {\r\n      return;\r\n    }\r\n    if (self.contextMenu || self.input) {\r\n      return;\r\n    }\r\n    if (self.dragStart && self.isInGrid(self.dragStart)) {\r\n      self.controlInput.focus();\r\n    }\r\n    e.preventDefault();\r\n  };\r\n  // gets the horizontal adjacent cells as well as first/last based on column visibility\r\n  self.getAdjacentCells = function () {\r\n    var x,\r\n      i,\r\n      s = self.getSchema(),\r\n      o = {};\r\n    for (x = 0; x < s.length; x += 1) {\r\n      i = self.orders.columns[x];\r\n      if (!s[i].hidden) {\r\n        if (o.first === undefined) {\r\n          o.first = x;\r\n          o.left = x;\r\n        }\r\n        o.last = x;\r\n        if (x > self.activeCell.columnIndex && o.right === undefined) {\r\n          o.right = x;\r\n        }\r\n        if (x < self.activeCell.columnIndex) {\r\n          o.left = x;\r\n        }\r\n      }\r\n    }\r\n    if (o.right === undefined) {\r\n      o.right = o.last;\r\n    }\r\n    return o;\r\n  };\r\n  self.keydown = function (e) {\r\n    var i,\r\n      ev,\r\n      adjacentCells = self.getAdjacentCells(),\r\n      x = Math.max(self.activeCell.columnIndex, 0),\r\n      y = Math.max(self.activeCell.rowIndex, 0),\r\n      ctrl = e.ctrlKey || e.metaKey,\r\n      last = self.viewData.length - 1,\r\n      s = self.getSchema(),\r\n      cols = s.length - 1;\r\n\r\n    var defaultPrevented = self.dispatchEvent('keydown', {\r\n      NativeEvent: e,\r\n      cell: self.currentCell,\r\n    });\r\n\r\n    if (defaultPrevented) {\r\n      return;\r\n    }\r\n\r\n    if (!self.attributes.keepFocusOnMouseOut && !self.hasFocus) {\r\n      return;\r\n    }\r\n\r\n    // If a user starts typing content, switch to \"Enter\" mode\r\n    if (isPrintableKeyEvent(e) && !ctrl) {\r\n      return self.beginEditAt(x, y, e, true);\r\n    }\r\n\r\n    if (self.attributes.showNewRow) {\r\n      last += 1;\r\n    }\r\n\r\n    if (e.key === 'Tab') {\r\n      e.preventDefault();\r\n    }\r\n\r\n    if (e.key === 'Escape') {\r\n      self.selectNone();\r\n    } else if (ctrl && e.key === 'a') {\r\n      self.selectAll();\r\n    } else if (['Backspace', 'Delete'].includes(e.key)) {\r\n      self.deleteSelectedData();\r\n    } else if (e.key === 'ArrowDown') {\r\n      y += 1;\r\n    } else if (e.key === 'ArrowUp') {\r\n      y -= 1;\r\n    } else if (\r\n      (e.key === 'ArrowLeft' && !ctrl) ||\r\n      (e.shiftKey && e.key === 'Tab')\r\n    ) {\r\n      x = adjacentCells.left;\r\n    } else if (\r\n      (e.key === 'ArrowRight' && !ctrl) ||\r\n      (!e.shiftKey && e.key === 'Tab')\r\n    ) {\r\n      x = adjacentCells.right;\r\n    } else if (e.key === 'PageUp') {\r\n      y -= self.page;\r\n      e.preventDefault();\r\n    } else if (e.key === 'PageDown') {\r\n      y += self.page;\r\n      e.preventDefault();\r\n    } else if (e.key === 'Home' || (ctrl && e.key === 'ArrowUp')) {\r\n      y = 0;\r\n    } else if (e.key === 'End' || (ctrl && e.key === 'ArrowDown')) {\r\n      y = self.viewData.length - 1;\r\n    } else if (ctrl && e.key === 'ArrowRight') {\r\n      x = adjacentCells.last;\r\n    } else if (ctrl && e.key === 'ArrowLeft') {\r\n      x = adjacentCells.first;\r\n    }\r\n\r\n    if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      return self.beginEditAt(x, y, e);\r\n    }\r\n    if (x < 0 || Number.isNaN(x)) {\r\n      x = adjacentCells.first;\r\n    }\r\n    if (y > last) {\r\n      y = last;\r\n    }\r\n    if (y < 0 || Number.isNaN(y)) {\r\n      y = 0;\r\n    }\r\n    if (x > cols) {\r\n      x = adjacentCells.last;\r\n    }\r\n\r\n    // TODO - most likely some column order related bugs in key based selection\r\n    // Arrows\r\n    var isArrowKey = [\r\n      'ArrowLeft',\r\n      'ArrowUp',\r\n      'ArrowRight',\r\n      'ArrowDown',\r\n    ].includes(e.key);\r\n\r\n    // Shrinking and expanding selection using shift and arrow keys\r\n    if (e.shiftKey && isArrowKey) {\r\n      const firstSelectedRowIndex = self.selections.findIndex((el) => !!el);\r\n      const firstSelectedRow = self.selections[firstSelectedRowIndex];\r\n      const firstSelectedColumnIndex = firstSelectedRow[0];\r\n      const lastSelectedColumn = firstSelectedRow[firstSelectedRow.length - 1];\r\n      const yAtTop = y === 0;\r\n      const yAtBottom = y === last;\r\n      const xAtLeft = x === 0;\r\n      const xAtRight = x === cols;\r\n\r\n      if (e.key === 'ArrowUp') {\r\n        if (y + 1 > firstSelectedRowIndex && !yAtTop) {\r\n          self.selections.pop();\r\n        } else if (y < firstSelectedRowIndex) {\r\n          self.selections[y] = self.selections[y] || [];\r\n          self.selections[y].push(x);\r\n        } else if (yAtTop && self.activeCell.rowIndex !== 0) {\r\n          self.selections.pop();\r\n        }\r\n      }\r\n\r\n      if (e.key === 'ArrowDown') {\r\n        if (y > firstSelectedRowIndex && y === self.selections.length) {\r\n          self.selections[y] = self.selections[y] || [];\r\n          self.selections[y].push(x);\r\n        } else if (y >= firstSelectedRowIndex && !yAtBottom) {\r\n          delete self.selections[y - 1];\r\n        } else if (yAtBottom && self.activeCell.rowIndex !== last) {\r\n          delete self.selections[y - 1];\r\n        }\r\n      }\r\n\r\n      for (const selection of self.selections) {\r\n        if (e.key === 'ArrowRight' && selection) {\r\n          if (x > lastSelectedColumn) {\r\n            selection.push(x);\r\n          } else if (x <= lastSelectedColumn && !xAtRight) {\r\n            selection.shift();\r\n          } else if (xAtRight && self.activeCell.columnIndex !== cols) {\r\n            selection.shift();\r\n          }\r\n        }\r\n\r\n        if (e.key === 'ArrowLeft' && selection) {\r\n          if (x < firstSelectedColumnIndex) {\r\n            selection.unshift(x);\r\n          } else if (x >= firstSelectedColumnIndex && !xAtLeft) {\r\n            selection.pop();\r\n          } else if (xAtLeft && self.activeCell.columnIndex !== 0) {\r\n            selection.pop();\r\n          }\r\n        }\r\n      }\r\n\r\n      self.selectionBounds = self.getSelectionBounds();\r\n      self.selectArea(undefined, ctrl);\r\n\r\n      self.draw(true);\r\n    }\r\n\r\n    if (x !== self.activeCell.columnIndex || y !== self.activeCell.rowIndex) {\r\n      self.scrollIntoView(\r\n        x !== self.activeCell.columnIndex ? x : undefined,\r\n        y !== self.activeCell.rowIndex && !Number.isNaN(y) ? y : undefined,\r\n      );\r\n\r\n      self.setActiveCell(x, y);\r\n      if (!e.shiftKey && self.attributes.selectionFollowsActiveCell) {\r\n        if (!ctrl) {\r\n          self.selections = [];\r\n        }\r\n        self.selections[y] = self.selections[y] || [];\r\n        self.selections[y].push(x);\r\n        ev = {\r\n          selectedData: self.getSelectedData(),\r\n          selections: self.selections,\r\n          selectionBounds: self.getSelectionBounds(),\r\n          selectedCells: self.getSelectedCells(),\r\n        };\r\n        Object.defineProperty(ev, 'selectedData', {\r\n          get: function () {\r\n            return self.getSelectedData();\r\n          },\r\n        });\r\n        self.dispatchEvent('selectionchanged', ev);\r\n      }\r\n      self.draw(true);\r\n    }\r\n  };\r\n  self.keyup = function (e) {\r\n    if (\r\n      self.dispatchEvent('keyup', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n  };\r\n  self.keypress = function (e) {\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n    if (\r\n      self.dispatchEvent('keypress', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n  };\r\n  self.dblclick = function (e) {\r\n    if (\r\n      self.dispatchEvent('dblclick', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n    if (\r\n      self.currentCell.context === 'ew-resize' &&\r\n      self.currentCell.style === 'columnHeaderCell'\r\n    ) {\r\n      // Check that double-clicked cell is selected or part of selection.\r\n      const currentCellIsSelected = self.isColumnSelected(\r\n        self.currentCell.columnIndex,\r\n      );\r\n\r\n      if (currentCellIsSelected) {\r\n        // There might be more\r\n        self.fitSelectedColumns();\r\n      } else {\r\n        self.fitColumnToValues(self.currentCell.header.name);\r\n      }\r\n    } else if (\r\n      self.currentCell.context === 'ew-resize' &&\r\n      self.currentCell.style === 'cornerCell'\r\n    ) {\r\n      self.autosize();\r\n    } else if (\r\n      ['cell', 'activeCell'].includes(self.currentCell.style) &&\r\n      !self.hovers.onFilterButton\r\n    ) {\r\n      self.beginEditAt(self.currentCell.columnIndex, self.currentCell.rowIndex);\r\n    }\r\n  };\r\n  self.scrollWheel = function (e) {\r\n    var l,\r\n      t,\r\n      ev = e,\r\n      deltaX = e.deltaX === undefined ? e.NativeEvent.deltaX : e.deltaX,\r\n      deltaY = e.deltaY === undefined ? e.NativeEvent.deltaY : e.deltaY,\r\n      deltaMode =\r\n        e.deltaMode === undefined ? e.NativeEvent.deltaMode : e.deltaMode;\r\n    var e = e.NativeEvent || e;\r\n    if (wheeling) {\r\n      ev.preventDefault(e);\r\n      return;\r\n    }\r\n    if (self.dispatchEvent('wheel', { NativeEvent: e })) {\r\n      return;\r\n    }\r\n    self.touchHaltAnimation = true;\r\n    l = self.scrollBox.scrollLeft;\r\n    t = self.scrollBox.scrollTop;\r\n    if (self.hasFocus) {\r\n      //BUG Issue 42: https://github.com/TonyGermaneri/canvas-datagrid/issues/42\r\n      //https://stackoverflow.com/questions/20110224/what-is-the-height-of-a-line-in-a-wheel-event-deltamode-dom-delta-line\r\n      if (deltaMode === 1) {\r\n        // line mode = 17 pixels per line\r\n        deltaY = deltaY * 17;\r\n      }\r\n      if (\r\n        (self.scrollBox.scrollTop < self.scrollBox.scrollHeight &&\r\n          deltaY > 0) ||\r\n        (self.scrollBox.scrollLeft < self.scrollBox.scrollWidth &&\r\n          deltaX > 0) ||\r\n        (self.scrollBox.scrollTop > 0 && deltaY < 0) ||\r\n        (self.scrollBox.scrollLeft > 0 && deltaX < 0)\r\n      ) {\r\n        ev.preventDefault(e);\r\n      }\r\n      wheeling = setTimeout(function () {\r\n        wheeling = undefined;\r\n        self.scrollBox.scrollTo(deltaX + l, deltaY + t);\r\n      }, 1);\r\n    }\r\n  };\r\n  self.pasteData = function (\r\n    pasteValue,\r\n    mimeType,\r\n    startRowIndex,\r\n    startColIndex,\r\n  ) {\r\n    if (mimeType === 'text/html' && !isSupportedHtml(pasteValue)) {\r\n      console.warn(\r\n        'Unrecognized HTML format. HTML must be a simple table, e.g.: <table><tr><td>data</td></tr></table>.',\r\n      );\r\n      console.warn(\r\n        'Data with the mime type text/html not in this format will not be imported as row data.',\r\n      );\r\n\r\n      return;\r\n    }\r\n    var schema = self.getSchema();\r\n    var rows = parseData(pasteValue, mimeType);\r\n\r\n    // selected cell. This mimics Excel's paste functionality, and works\r\n    // as a poor-man's fill-down.\r\n    if (rows.length === 1 && rows[0].length === 1) {\r\n      var cellData = rows[0][0].value.map((item) => item.value).join();\r\n\r\n      self.forEachSelectedCell(function (data, rowIndex, colName) {\r\n        data[rowIndex][colName] = cellData;\r\n      });\r\n    } else {\r\n      var selections = [];\r\n      for (var rowIndex = 0; rowIndex < rows.length; rowIndex++) {\r\n        // Rows may have been moved by user, so get the actual row index\r\n        // (instead of the row index at which the row is rendered):\r\n        var realRowIndex = self.orders.rows[startRowIndex + rowIndex];\r\n        var cells = rows[rowIndex];\r\n\r\n        var existingRowData = self.viewData[realRowIndex];\r\n        var newRowData = Object.assign({}, existingRowData);\r\n\r\n        selections[realRowIndex] = [];\r\n\r\n        for (var colIndex = 0; colIndex < cells.length; colIndex++) {\r\n          var column = schema[startColIndex + colIndex];\r\n\r\n          if (!column) {\r\n            console.warn('Paste data exceeded grid bounds. Skipping.');\r\n            continue;\r\n          }\r\n\r\n          var columnName = column.name;\r\n          var cellData = cells[colIndex].value\r\n            .map((item) => item.value)\r\n            .join('');\r\n\r\n          if (cellData === undefined || cellData === null) {\r\n            newRowData[columnName] = existingRowData[columnName];\r\n            continue;\r\n          }\r\n\r\n          selections[realRowIndex].push(startColIndex + colIndex);\r\n\r\n          newRowData[columnName] = cellData;\r\n        }\r\n\r\n        self.originalData[self.boundRowIndexMap.get(realRowIndex)] = newRowData;\r\n        // Update view date here to avoid a full refresh of `viewData`.\r\n        // To stay in line with Excel and Google Sheet behaviour,\r\n        // don't perform a full refresh (and filter/sort results)\r\n        // as this would make any pasted values disappear and/or suddenly change position.\r\n        self.viewData[realRowIndex] = newRowData;\r\n      }\r\n      self.selections = selections;\r\n    }\r\n\r\n    // selections is a sparse array, so we condense:\r\n    var affectedCells = [];\r\n\r\n    self.selections.forEach(function (row, rowIndex) {\r\n      if (rowIndex === undefined) return;\r\n\r\n      row.forEach(function (columnIndex) {\r\n        affectedCells.push([\r\n          rowIndex,\r\n          columnIndex,\r\n          self.getBoundRowIndexFromViewRowIndex(rowIndex),\r\n          self.getBoundColumnIndexFromViewColumnIndex(columnIndex),\r\n        ]);\r\n      });\r\n    });\r\n\r\n    self.dispatchEvent('afterpaste', {\r\n      cells: affectedCells,\r\n    });\r\n\r\n    return rows.length;\r\n  };\r\n  self.getNextVisibleColumnIndex = function (visibleColumnIndex) {\r\n    var x,\r\n      s = self.getVisibleSchema();\r\n    for (x = 0; x < s.length; x += 1) {\r\n      if (s[x].columnIndex === visibleColumnIndex) {\r\n        return s[x + 1].columnIndex;\r\n      }\r\n    }\r\n    return -1;\r\n  };\r\n  self.getVisibleColumnIndexOf = function (columnIndex) {\r\n    var x,\r\n      s = self.getVisibleSchema();\r\n    for (x = 0; x < s.length; x += 1) {\r\n      if (s[x].columnIndex === columnIndex) {\r\n        return x;\r\n      }\r\n    }\r\n    return -1;\r\n  };\r\n  self.paste = function (event) {\r\n    if (!self.attributes.editable) {\r\n      return;\r\n    }\r\n\r\n    var defaultPrevented = self.dispatchEvent('beforepaste', {\r\n      NativeEvent: event,\r\n    });\r\n\r\n    if (defaultPrevented) {\r\n      return;\r\n    }\r\n\r\n    var clipboardItems = new Map(\r\n      Array.from(event.clipboardData.items).map((item) => [item.type, item]),\r\n    );\r\n\r\n    // Supported MIME types, in order of preference:\r\n    var supportedMimeTypes = ['text/html', 'text/csv', 'text/plain'];\r\n\r\n    // The clipboard will often contain the same data in multiple formats,\r\n    // which can be used depending on the context in which it's pasted. Here\r\n    // we'll prefere more structured (HTML/CSV) over less structured, when\r\n    // available, so we try to find those first:\r\n    var pasteableItems = supportedMimeTypes\r\n      .map((mimeType) => clipboardItems.get(mimeType))\r\n      .filter((item) => !!item); // filter out not-found MIME types (= undefined)\r\n\r\n    if (pasteableItems.length === 0) {\r\n      console.warn(\r\n        'Cannot find supported clipboard data type. Supported types are:',\r\n        supportedMimeTypes.join(', '),\r\n      );\r\n      return;\r\n    }\r\n\r\n    var itemToPaste = pasteableItems[0];\r\n\r\n    let startCell = [];\r\n    for (\r\n      let rowIndex = 0, len = self.selections.length;\r\n      rowIndex < len;\r\n      rowIndex++\r\n    ) {\r\n      const row = self.selections[rowIndex];\r\n      if (row) {\r\n        if (row[0] === undefined) return;\r\n        startCell = [rowIndex, row[0] < 0 ? row[1] : row[0]];\r\n        break;\r\n      }\r\n    }\r\n\r\n    // itemToPaste is cleared once accessed (getData or getAsString),\r\n    // so we need to store the type here, before reading its value:\r\n    var pasteType = itemToPaste.type;\r\n\r\n    itemToPaste.getAsString(function (pasteValue) {\r\n      self.pasteData(pasteValue, pasteType, startCell[0], startCell[1]);\r\n\r\n      self.draw();\r\n    });\r\n  };\r\n  self.cut = function (e) {\r\n    if (self.dispatchEvent('cut', { NativeEvent: e })) {\r\n      return;\r\n    }\r\n\r\n    // Expecting instance of `ClipboardEvent` with `clipboardData` attribute\r\n    if (!self.hasFocus || !e.clipboardData) {\r\n      return;\r\n    }\r\n\r\n    self.copySelectedCellsToClipboard(e.clipboardData);\r\n\r\n    const affectedCells = self.clearSelectedCells();\r\n\r\n    self.dispatchEvent('aftercut', {\r\n      cells: affectedCells,\r\n    });\r\n\r\n    requestAnimationFrame(() => self.draw());\r\n  };\r\n  self.copy = function (e) {\r\n    if (self.dispatchEvent('copy', { NativeEvent: e })) {\r\n      return;\r\n    }\r\n\r\n    // Expecting instance of `ClipboardEvent` with `clipboardData` attribute\r\n    if (!self.hasFocus || !e.clipboardData) {\r\n      return;\r\n    }\r\n\r\n    self.copySelectedCellsToClipboard(e.clipboardData);\r\n\r\n    e.preventDefault();\r\n  };\r\n  return;\r\n}\r\n","'use strict';\r\n\r\nconst isSupportedHtml = function (pasteValue) {\r\n  // We need to match new lines in the HTML, .* won't match new line characters.\r\n  // `s` regex modifier can't be used with `ecmaVersion === 2017`.\r\n  // As a workaround using [\\s\\S]*. Fix when we upgrade `ecmaVersion`.\r\n  const genericDiv = /(?:^(<meta[^>]*>)?[\\s\\S]*<div[^>]*>)/;\r\n  const genericSpan = /(?:^(<meta[^>]*>)?[\\s\\S]*<span[^>]*>)/;\r\n  const genericTable = /(?:^(<meta[^>]*>)?[\\s\\S]*<table[^>]*>)/; // Matches Google Sheets format clipboard data format too.\r\n  const excelTable = /(?:<!--StartFragment-->[\\s\\S]*<tr[^>]*>)/;\r\n  const excelTableRow = /(?:<!--StartFragment-->[\\s\\S]*<td[^>]*>)/;\r\n\r\n  return [\r\n    genericDiv,\r\n    genericTable,\r\n    genericSpan,\r\n    excelTable,\r\n    excelTableRow,\r\n  ].some((expression) => expression.test(pasteValue));\r\n};\r\n\r\n// Explanation of nodeType here: https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\r\nconst IGNORE_NODETYPES = [8, 3]; // '#text' and '#comment'\r\n\r\nconst isHtmlTable = function (pasteValue) {\r\n  return /(?:<table[^>]*>)|(?:<tr[^]*>)/.test(pasteValue);\r\n};\r\n\r\nconst sanitizeElementData = function (element) {\r\n  // It is not entirely clear if this check on nodeType is required.\r\n  let elementData = element.nodeType === 1 ? element.innerText : element.data;\r\n\r\n  return String(elementData).replace(/\\s+/g, ' ').trim();\r\n};\r\n\r\nconst parseHtmlText = function (data) {\r\n  const doc = new DOMParser().parseFromString(data, 'text/html');\r\n  const element = doc.querySelector('div') || doc.querySelector('span');\r\n  const elementData = sanitizeElementData(element);\r\n\r\n  return elementData\r\n    .split('\\n')\r\n    .map((item) => item.split('\\t').map((value) => ({ value: [{ value }] })));\r\n};\r\n\r\nconst parseHtmlTable = function (data) {\r\n  const doc = new DOMParser().parseFromString(data, 'text/html');\r\n  const trs = doc.querySelectorAll('table tr');\r\n  const rows = [];\r\n\r\n  for (const tr of trs) {\r\n    const row = [];\r\n\r\n    for (const childNode of tr.childNodes) {\r\n      if (IGNORE_NODETYPES.includes(childNode.nodeType)) continue;\r\n\r\n      const col = { value: [] };\r\n      const value = sanitizeElementData(childNode);\r\n\r\n      if (value) col.value.push({ value });\r\n\r\n      row.push(col);\r\n    }\r\n\r\n    rows.push(row);\r\n  }\r\n\r\n  return rows;\r\n};\r\n\r\nconst parseText = function (data) {\r\n  return data\r\n    .split('\\n')\r\n    .map((item) => item.split('\\t').map((value) => ({ value: [{ value }] })));\r\n};\r\n\r\nconst parseData = function (data, mimeType) {\r\n  if (mimeType === 'text/html' && isHtmlTable(data)) {\r\n    return parseHtmlTable(data);\r\n  } else if (mimeType === 'text/html') {\r\n    return parseHtmlText(data);\r\n  }\r\n\r\n  // Default data format is string, so split on new line,\r\n  // and then enclose in an array (a row with one cell):\r\n  return parseText(data);\r\n};\r\n\r\nconst htmlSafe = (value) => {\r\n  if (typeof value === 'number') return value;\r\n  return value.replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n};\r\n\r\nconst createTextString = (selectedData, isNeat) => {\r\n  // Selected like [[0, 1], [0, 1]] of [[0, 3]] is neat; Selected like [[0, 1], [1, 2]] is untidy.\r\n  // If not isNeat we just return a simple string of concatenated values.\r\n  if (!isNeat)\r\n    return selectedData.map((row) => Object.values(row).join('')).join('');\r\n\r\n  // If isNeat, we can create tab separated mutti-line text.\r\n  return selectedData.map((row) => Object.values(row).join('\\t')).join('\\n');\r\n};\r\n\r\nconst createHTMLString = (selectedData, isNeat) => {\r\n  if (!isNeat) return createTextString(selectedData, isNeat);\r\n\r\n  // If isNeat, we can create a HTML table with the selected data.\r\n  let htmlString = '<table>';\r\n  htmlString += selectedData\r\n    .map(\r\n      (row) =>\r\n        '<tr>' +\r\n        Object.values(row)\r\n          .map((value) => '<td>' + htmlSafe(value) + '</td>')\r\n          .join('') +\r\n        '</tr>',\r\n    )\r\n    .join('');\r\n  htmlString += '</table>';\r\n\r\n  return htmlString;\r\n};\r\n\r\nexport {\r\n  createTextString,\r\n  createHTMLString,\r\n  isSupportedHtml,\r\n  htmlSafe,\r\n  parseData,\r\n  parseHtmlTable,\r\n  parseHtmlText,\r\n  parseText,\r\n  sanitizeElementData,\r\n};\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals HTMLElement: false, Reflect: false, define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nimport { createHTMLString, createTextString } from './events/util';\r\n\r\nexport default function (self, ctor) {\r\n  self.scale = 1;\r\n  self.orders = {\r\n    rows: [],\r\n    columns: [],\r\n  };\r\n  self.appliedInlineStyles = {};\r\n  self.cellGridAttributes = {};\r\n  self.treeGridAttributes = {};\r\n  self.visibleRowHeights = [];\r\n  self.hasFocus = false;\r\n  self.activeCell = {\r\n    columnIndex: 0,\r\n    rowIndex: 0,\r\n  };\r\n  self.innerHTML = '';\r\n  self.storageName = 'canvasDataGrid';\r\n  self.invalidSearchExpClass = 'canvas-datagrid-invalid-search-regExp';\r\n  self.localStyleLibraryStorageKey = 'canvas-datagrid-user-style-library';\r\n  self.dataType = 'application/x-canvas-datagrid';\r\n  self.orderBy = null;\r\n  self.orderDirection = 'asc';\r\n  self.orderings = {\r\n    columns: [],\r\n    add: function (orderBy, orderDirection, sortFunction) {\r\n      self.orderings.columns = self.orderings.columns.filter(function (col) {\r\n        return col.orderBy !== orderBy;\r\n      });\r\n      self.orderings.columns.push({\r\n        orderBy: orderBy,\r\n        orderDirection: orderDirection,\r\n        sortFunction: sortFunction,\r\n      });\r\n    },\r\n    sort: function () {\r\n      console.warn(\r\n        'grid.orderings.sort has been deprecated. Please use grid.refresh().',\r\n      );\r\n\r\n      self.orderings.columns.forEach(function (col) {\r\n        self.viewData.sort(col.sortFunction(col.orderBy, col.orderDirection));\r\n      });\r\n    },\r\n  };\r\n  self.columnFilters = {};\r\n  self.filters = {};\r\n  self.frozenRow = 0;\r\n  self.frozenColumn = 0;\r\n  self.ellipsisCache = {};\r\n  self.scrollCache = { x: [], y: [] };\r\n  self.scrollBox = {};\r\n  self.visibleRows = [];\r\n  self.visibleCells = [];\r\n  self.sizes = {\r\n    rows: {},\r\n    columns: {},\r\n    trees: {},\r\n  };\r\n  self.selections = [];\r\n  self.filterable = {\r\n    rows: [],\r\n    columns: [],\r\n  };\r\n  self.selectedFilterButton = {\r\n    columnIndex: -1,\r\n    rowIndex: -1,\r\n  };\r\n  self.hovers = {};\r\n  self.attributes = {};\r\n  self.style = {};\r\n  self.formatters = {};\r\n  self.sorters = {};\r\n  self.parsers = {};\r\n  self.schemaHashes = {};\r\n  self.events = {};\r\n  self.changes = [];\r\n  self.scrollIndexTop = 0;\r\n  self.scrollPixelTop = 0;\r\n  self.scrollIndexLeft = 0;\r\n  self.scrollPixelLeft = 0;\r\n  self.childGrids = {};\r\n  self.openChildren = {};\r\n  self.scrollModes = [\r\n    'vertical-scroll-box',\r\n    'vertical-scroll-top',\r\n    'vertical-scroll-bottom',\r\n    'horizontal-scroll-box',\r\n    'horizontal-scroll-right',\r\n    'horizontal-scroll-left',\r\n  ];\r\n  self.componentL1Events = {};\r\n  self.eventNames = [\r\n    'afterdraw',\r\n    'afterrendercell',\r\n    'afterrenderfilterbutton',\r\n    'attributechanged',\r\n    'beforebeginedit',\r\n    'beforecreatecellgrid',\r\n    'beforedraw',\r\n    'beforeendedit',\r\n    'beforerendercell',\r\n    'beforerendercellgrid',\r\n    'beforerenderfilterbutton',\r\n    'beginedit',\r\n    'cellmouseout',\r\n    'cellmouseover',\r\n    'click',\r\n    'collapsetree',\r\n    'contextmenu',\r\n    'copy',\r\n    'datachanged',\r\n    'dblclick',\r\n    'endedit',\r\n    'expandtree',\r\n    'formatcellvalue',\r\n    'keydown',\r\n    'keypress',\r\n    'keyup',\r\n    'mousedown',\r\n    'mousemove',\r\n    'mouseup',\r\n    'newrow',\r\n    'ordercolumn',\r\n    'rendercell',\r\n    'rendercellgrid',\r\n    'renderorderbyarrow',\r\n    'rendertext',\r\n    'rendertreearrow',\r\n    'reorder',\r\n    'reordering',\r\n    'resize',\r\n    'resizecolumn',\r\n    'resizerow',\r\n    'schemachanged',\r\n    'scroll',\r\n    'selectionchanged',\r\n    'stylechanged',\r\n    'touchcancel',\r\n    'touchend',\r\n    'touchmove',\r\n    'touchstart',\r\n    'wheel',\r\n  ];\r\n  self.mouse = { x: 0, y: 0 };\r\n  self.getSelectedData = function (expandToRow) {\r\n    const selectedData = [];\r\n    const schema = self.getSchema();\r\n    const viewDataLength = self.viewData.length;\r\n\r\n    if (viewDataLength === 0) {\r\n      return [];\r\n    }\r\n\r\n    // self.selections is a sparse array, so `viewRowIndex` here\r\n    // will equal the row index as where it's rendered,\r\n    // not as where it is in the original data array.\r\n    self.selections.forEach(function (row, viewRowIndex) {\r\n      if (!row) {\r\n        return;\r\n      }\r\n\r\n      if (viewRowIndex === viewDataLength) {\r\n        return;\r\n      }\r\n\r\n      if (row.length === 0) {\r\n        selectedData[viewRowIndex] = null;\r\n        return;\r\n      }\r\n\r\n      selectedData[viewRowIndex] = {};\r\n\r\n      row.forEach(function (col) {\r\n        if (col === -1 || !schema[col]) {\r\n          return;\r\n        }\r\n\r\n        const orderedIndex = self.orders.columns[col];\r\n\r\n        if (!expandToRow && schema[orderedIndex].hidden) {\r\n          return;\r\n        }\r\n\r\n        if (self.viewData[viewRowIndex]) {\r\n          selectedData[viewRowIndex][schema[orderedIndex].name] =\r\n            self.viewData[viewRowIndex][schema[orderedIndex].name];\r\n        }\r\n      });\r\n    });\r\n\r\n    return selectedData;\r\n  };\r\n  self.getSelectedCells = function (expandToRow) {\r\n    const selectedCells = [];\r\n    const schema = self.getSchema();\r\n    const viewDataLength = self.viewData.length;\r\n\r\n    if (viewDataLength === 0) {\r\n      return [];\r\n    }\r\n\r\n    for (const [viewRowIndex, row] of self.selections.entries()) {\r\n      if (!row || row.length === 0) continue;\r\n\r\n      for (const [, viewColumnIndex] of row.entries()) {\r\n        if (viewColumnIndex === -1 || !schema[viewColumnIndex]) {\r\n          continue;\r\n        }\r\n\r\n        const boundColumnIndex = self.getBoundColumnIndexFromViewColumnIndex(\r\n          viewColumnIndex,\r\n        );\r\n\r\n        if (!expandToRow && schema[boundColumnIndex].hidden) {\r\n          continue;\r\n        }\r\n\r\n        if (self.viewData[viewRowIndex]) {\r\n          const header = schema[boundColumnIndex];\r\n          const value = self.viewData[viewRowIndex][header.name];\r\n          const boundRowIndex = self.getBoundRowIndexFromViewRowIndex(\r\n            viewRowIndex,\r\n          );\r\n\r\n          const cell = {\r\n            value,\r\n            header,\r\n            boundRowIndex,\r\n            boundColumnIndex,\r\n            viewRowIndex,\r\n            viewColumnIndex,\r\n          };\r\n\r\n          selectedCells.push(cell);\r\n        }\r\n      }\r\n    }\r\n\r\n    return selectedCells;\r\n  };\r\n  self.copySelectedCellsToClipboard = function (clipboardData) {\r\n    const selectedData = [];\r\n    const schema = self.getSchema();\r\n    let firstRowAsString;\r\n    let isNeat = true; // Selected like [[0, 1], [0, 1]] of [[0, 3]] is neat; Selected like [[0, 1], [1, 2]] is untidy\r\n\r\n    for (const [rowIndex, row] of self.selections.entries()) {\r\n      // If no cells are selected for a particular rowIndex the selections array will contain an empty element for that rowIndex.\r\n      if (!row) continue;\r\n\r\n      // Convert to string for easy comparison to the first row.\r\n      const rowAsString = row.join(',').toString();\r\n      const rowDict = {};\r\n\r\n      if (!firstRowAsString) firstRowAsString = row.join(',').toString();\r\n      if (isNeat && rowAsString !== firstRowAsString) isNeat = false;\r\n\r\n      const boundRowIndex = self.getBoundRowIndexFromViewRowIndex(rowIndex);\r\n\r\n      for (let columnIndex of row) {\r\n        // If the whole row is selected the columnIndex for the rowHeader is -1.\r\n        if (columnIndex < 0) continue;\r\n\r\n        const boundColumnIndex = self.getBoundColumnIndexFromViewColumnIndex(\r\n          columnIndex,\r\n        );\r\n        const columnName = schema[boundColumnIndex].name;\r\n\r\n        const value = self.originalData[boundRowIndex][columnName];\r\n\r\n        rowDict[columnName] = value;\r\n      }\r\n      selectedData.push(rowDict);\r\n    }\r\n\r\n    if (selectedData.length > 0) {\r\n      const textString = createTextString(selectedData, isNeat);\r\n      const htmlString = createHTMLString(selectedData, isNeat);\r\n\r\n      const copiedData = {\r\n        'text/plain': textString,\r\n        'text/html': htmlString,\r\n        'text/csv': textString,\r\n        'application/json': JSON.stringify(selectedData),\r\n      };\r\n\r\n      for (const [mimeType, data] of Object.entries(copiedData)) {\r\n        clipboardData.setData(mimeType, data);\r\n      }\r\n    }\r\n  };\r\n  self.clearSelectedCells = function () {\r\n    const schema = self.getSchema();\r\n    const affectedCells = [];\r\n\r\n    for (const [rowIndex, row] of self.selections.entries()) {\r\n      // If no cells are selected for a particular rowIndex the selections array will contain an empty element for that rowIndex.\r\n      if (!row) continue;\r\n\r\n      const boundRowIndex = self.getBoundRowIndexFromViewRowIndex(rowIndex);\r\n\r\n      for (let columnIndex of row) {\r\n        // If the whole row is selected the columnIndex for the rowHeader is -1.\r\n        if (columnIndex < 0) continue;\r\n\r\n        const boundColumnIndex = self.getBoundColumnIndexFromViewColumnIndex(\r\n          columnIndex,\r\n        );\r\n        const columnName = schema[boundColumnIndex].name;\r\n\r\n        self.viewData[boundRowIndex][columnName] = '';\r\n\r\n        affectedCells.push([\r\n          rowIndex,\r\n          columnIndex,\r\n          boundRowIndex,\r\n          boundColumnIndex,\r\n        ]);\r\n      }\r\n    }\r\n\r\n    return affectedCells;\r\n  };\r\n  self.getBoundRowIndexFromViewRowIndex = function (viewRowIndex) {\r\n    if (self.boundRowIndexMap && self.boundRowIndexMap.has(viewRowIndex)) {\r\n      return self.boundRowIndexMap.get(viewRowIndex);\r\n    }\r\n\r\n    return undefined;\r\n  };\r\n  self.getBoundColumnIndexFromViewColumnIndex = function (viewColumnIndex) {\r\n    return self.orders.columns[viewColumnIndex];\r\n  };\r\n  self.getColumnHeaderCellHeight = function () {\r\n    if (!self.attributes.showColumnHeaders) {\r\n      return 0;\r\n    }\r\n    return (\r\n      (self.sizes.rows[-1] || self.style.columnHeaderCellHeight) * self.scale\r\n    );\r\n  };\r\n  self.getRowHeaderCellWidth = function () {\r\n    if (!self.attributes.showRowHeaders) {\r\n      return 0;\r\n    }\r\n    return (\r\n      (self.sizes.columns[-1] || self.style.rowHeaderCellWidth) * self.scale\r\n    );\r\n  };\r\n  self.setStorageData = function () {\r\n    if (!self.attributes.saveAppearance || !self.attributes.name) {\r\n      return;\r\n    }\r\n    var visibility = {};\r\n    self.getSchema().forEach(function (column) {\r\n      visibility[column.name] = !column.hidden;\r\n    });\r\n    localStorage.setItem(\r\n      self.storageName + '-' + self.attributes.name,\r\n      JSON.stringify({\r\n        sizes: {\r\n          rows: self.sizes.rows,\r\n          columns: self.sizes.columns,\r\n        },\r\n        orders: {\r\n          rows: self.orders.rows,\r\n          columns: self.orders.columns,\r\n        },\r\n        orderBy: self.orderBy,\r\n        orderDirection: self.orderDirection,\r\n        visibility: visibility,\r\n      }),\r\n    );\r\n  };\r\n  self.getSchema = function () {\r\n    return self.schema || self.tempSchema || [];\r\n  };\r\n  function fillArray(low, high) {\r\n    var i = [],\r\n      x;\r\n    for (x = low; x <= high; x += 1) {\r\n      i[x] = x;\r\n    }\r\n    return i;\r\n  }\r\n  self.createColumnOrders = function () {\r\n    var s = self.getSchema();\r\n    self.orders.columns = fillArray(0, s.length - 1);\r\n  };\r\n  self.createRowOrders = function () {\r\n    self.orders.rows = fillArray(0, self.originalData.length - 1);\r\n  };\r\n  self.fitSelectedColumns = function (width) {\r\n    const selectedColumns = self.selections[0];\r\n    const schema = self.getSchema();\r\n\r\n    for (const selectedColumn of selectedColumns) {\r\n      // Make sure the column is not the row header and that the whole column has in fact been selected.\r\n      if (selectedColumn >= 0 && self.isColumnSelected(selectedColumn)) {\r\n        if (isNaN(width)) {\r\n          const column = schema[self.orders.columns[selectedColumn]];\r\n          self.fitColumnToValues(column.name);\r\n        } else {\r\n          self.sizes.columns[selectedColumn] = width;\r\n          self.dispatchEvent('resizecolumn', {\r\n            x: width,\r\n            y: self.resizingStartingHeight,\r\n            draggingItem: self.currentCell,\r\n          });\r\n        }\r\n      }\r\n    }\r\n  };\r\n  self.getVisibleSchema = function () {\r\n    return self.getSchema().filter(function (col) {\r\n      return !col.hidden;\r\n    });\r\n  };\r\n  self.applyDefaultValue = function (row, header, rowIndex) {\r\n    var d = header.defaultValue || '';\r\n    if (typeof d === 'function') {\r\n      d = d.apply(self.intf, [header, rowIndex]);\r\n    }\r\n    row[header.name] = d;\r\n  };\r\n  self.createNewRowData = function () {\r\n    self.newRow = {};\r\n\r\n    // The third argument of applyDefaultValue is the row index\r\n    // of the row for which to apply the default value. In this\r\n    // case, we're creating a new row but not yet appending it\r\n    // to self.originalData, so no row index exists\r\n    const newRowIndex = undefined;\r\n\r\n    self.getSchema().forEach(function forEachHeader(header) {\r\n      self.applyDefaultValue(self.newRow, header, newRowIndex);\r\n    });\r\n  };\r\n  self.getSchemaNameHash = function (key) {\r\n    var n = 0;\r\n    while (self.schemaHashes[key]) {\r\n      n += 1;\r\n      key = key + n;\r\n    }\r\n    return key;\r\n  };\r\n  self.filter = function (type) {\r\n    var f = self.filters[type];\r\n    if (!f && type !== undefined) {\r\n      console.warn(\r\n        'Cannot find filter for type %s, falling back to substring match.',\r\n        type,\r\n      );\r\n      f = self.filters.string;\r\n    }\r\n    return f;\r\n  };\r\n  self.hasActiveFilters = function () {\r\n    return self.columnFilters && Object.keys(self.columnFilters).length > 0;\r\n  };\r\n  self.getFilteredAndSortedViewData = function (originalData) {\r\n    // We make a copy of originalData here in order be able to\r\n    // filter and sort rows without modifying the original array.\r\n    // Each row is turned into a (row, rowIndex) tuple\r\n    // so that when we apply filters, we can refer back to the\r\n    // row's original row number in originalData. This becomes\r\n    // useful when emitting cell events.\r\n    let newViewData = originalData.map((row, originalRowIndex) => [\r\n      row,\r\n      originalRowIndex,\r\n    ]);\r\n\r\n    // Apply filtering\r\n    for (const [headerName, filterText] of Object.entries(self.columnFilters)) {\r\n      const header = self.getHeaderByName(headerName);\r\n\r\n      if (!header) {\r\n        continue;\r\n      }\r\n\r\n      const currentFilterFunction =\r\n        header.filter || self.filter(header.type || 'string');\r\n\r\n      newViewData = newViewData.filter(function ([row, originalRowIndex]) {\r\n        if (\r\n          self.attributes.allowFreezingRows &&\r\n          !self.attributes.filterFrozenRows &&\r\n          originalRowIndex < self.frozenRow\r\n        )\r\n          return true;\r\n\r\n        return currentFilterFunction(row[headerName], filterText);\r\n      });\r\n    }\r\n\r\n    // Apply sorting\r\n    for (const column of self.orderings.columns) {\r\n      const sortFn = column.sortFunction(column.orderBy, column.orderDirection);\r\n\r\n      newViewData.sort(([rowA], [rowB, rowIndexB]) => {\r\n        if (\r\n          self.attributes.allowFreezingRows &&\r\n          !self.attributes.sortFrozenRows &&\r\n          rowIndexB < self.frozenRow\r\n        )\r\n          return 0;\r\n        return sortFn(rowA, rowB);\r\n      });\r\n    }\r\n\r\n    return {\r\n      viewData: newViewData.map(([row]) => row),\r\n      boundRowIndexMap: new Map(\r\n        newViewData.map(([_row, originalRowIndex], viewRowIndex) => [\r\n          viewRowIndex,\r\n          originalRowIndex,\r\n        ]),\r\n      ),\r\n    };\r\n  };\r\n  self.refresh = function () {\r\n    const { viewData, boundRowIndexMap } = self.getFilteredAndSortedViewData(\r\n      self.originalData,\r\n    );\r\n\r\n    self.viewData = viewData;\r\n    self.boundRowIndexMap = boundRowIndexMap;\r\n\r\n    self.resize();\r\n    self.draw(true);\r\n  };\r\n  self.getBestGuessDataType = function (columnName, data) {\r\n    var t,\r\n      x,\r\n      l = data.length;\r\n    for (x = 0; x < l; x += 1) {\r\n      if (\r\n        data[x] !== undefined &&\r\n        data[x] !== null &&\r\n        [null, undefined].indexOf(data[x][columnName]) !== -1\r\n      ) {\r\n        t = typeof data[x];\r\n        return t === 'object' ? 'string' : t;\r\n      }\r\n    }\r\n    return 'string';\r\n  };\r\n  self.drawChildGrids = function () {\r\n    Object.keys(self.childGrids).forEach(function (gridKey) {\r\n      self.childGrids[gridKey].draw();\r\n    });\r\n  };\r\n  self.resizeChildGrids = function () {\r\n    Object.keys(self.childGrids).forEach(function (gridKey) {\r\n      self.childGrids[gridKey].resize();\r\n    });\r\n  };\r\n  self.autoScrollZone = function (e, x, y, ctrl) {\r\n    var setTimer,\r\n      rowHeaderCellWidth = self.getRowHeaderCellWidth(),\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight();\r\n    if (x !== -1) {\r\n      if (x > self.width - self.attributes.selectionScrollZone) {\r\n        self.scrollBox.scrollLeft += self.attributes.selectionScrollIncrement;\r\n        setTimer = true;\r\n      }\r\n      if (x - self.attributes.selectionScrollZone - rowHeaderCellWidth < 0) {\r\n        self.scrollBox.scrollLeft -= self.attributes.selectionScrollIncrement;\r\n        setTimer = true;\r\n      }\r\n    }\r\n    if (y !== -1) {\r\n      if (y > self.height - self.attributes.selectionScrollZone) {\r\n        self.scrollBox.scrollTop += self.attributes.selectionScrollIncrement;\r\n        setTimer = true;\r\n      }\r\n      if (\r\n        y - self.attributes.selectionScrollZone - columnHeaderCellHeight <\r\n        0\r\n      ) {\r\n        self.scrollBox.scrollTop -= self.attributes.selectionScrollIncrement;\r\n        setTimer = true;\r\n      }\r\n    }\r\n    if (\r\n      setTimer &&\r\n      !ctrl &&\r\n      self.currentCell &&\r\n      self.currentCell.columnIndex !== -1\r\n    ) {\r\n      self.scrollTimer = setTimeout(\r\n        self.mousemove,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    }\r\n  };\r\n  self.validateColumn = function (c, s) {\r\n    if (!c.name) {\r\n      throw new Error('A column must contain at least a name.');\r\n    }\r\n    if (\r\n      s.filter(function (i) {\r\n        return i.name === c.name;\r\n      }).length > 0\r\n    ) {\r\n      throw new Error(\r\n        'A column with the name ' +\r\n          c.name +\r\n          ' already exists and cannot be added again.',\r\n      );\r\n    }\r\n    return true;\r\n  };\r\n  self.setDefaults = function (obj1, obj2, key, def) {\r\n    obj1[key] = obj2[key] === undefined ? def : obj2[key];\r\n  };\r\n  self.setAttributes = function () {\r\n    self.defaults.attributes.forEach(function eachAttribute(i) {\r\n      self.setDefaults(self.attributes, self.args, i[0], i[1]);\r\n    });\r\n  };\r\n  self.setStyle = function () {\r\n    self.defaults.styles.forEach(function eachStyle(i) {\r\n      self.setDefaults(self.style, self.args.style || {}, i[0], i[1]);\r\n    });\r\n  };\r\n  self.autosize = function (colName) {\r\n    self.getVisibleSchema().forEach(function (col, colIndex) {\r\n      if (col.name === colName || colName === undefined) {\r\n        self.sizes.columns[colIndex] = Math.max(\r\n          self.findColumnMaxTextLength(col.name),\r\n          self.style.minColumnWidth,\r\n        );\r\n      }\r\n    });\r\n    self.sizes.columns[-1] = self.findColumnMaxTextLength('cornerCell');\r\n  };\r\n  self.dispose = function () {\r\n    if (!self.isChildGrid && self.canvas && self.canvas.parentNode) {\r\n      self.canvas.parentNode.removeChild(self.canvas);\r\n    }\r\n    if (!self.isChildGrid) {\r\n      document.body.removeChild(self.controlInput);\r\n    }\r\n    self.eventParent.removeEventListener('mouseup', self.mouseup, false);\r\n    self.eventParent.removeEventListener('mousedown', self.mousedown, false);\r\n    self.eventParent.removeEventListener('dblclick', self.dblclick, false);\r\n    self.eventParent.removeEventListener('click', self.click, false);\r\n    self.eventParent.removeEventListener('mousemove', self.mousemove);\r\n    self.eventParent.removeEventListener('wheel', self.scrollWheel, false);\r\n    self.canvas.removeEventListener('contextmenu', self.contextmenu, false);\r\n    self.canvas.removeEventListener('copy', self.copy);\r\n    self.controlInput.removeEventListener('copy', self.copy);\r\n    self.controlInput.removeEventListener('cut', self.cut);\r\n    self.controlInput.removeEventListener('paste', self.paste);\r\n    self.controlInput.removeEventListener('keypress', self.keypress, false);\r\n    self.controlInput.removeEventListener('keyup', self.keyup, false);\r\n    self.controlInput.removeEventListener('keydown', self.keydown, false);\r\n    document.body.removeEventListener('mousemove', self.mousemove);\r\n    window.removeEventListener('resize', self.resize);\r\n    // console.log(self, 'obs');\r\n    if (self.observer && self.observer.disconnect) {\r\n      self.observer.disconnect();\r\n    }\r\n  };\r\n  self.tryLoadStoredSettings = function () {\r\n    var s;\r\n    self.reloadStoredValues();\r\n    if (\r\n      self.storedSettings &&\r\n      typeof self.storedSettings.orders === 'object' &&\r\n      self.storedSettings.orders !== null\r\n    ) {\r\n      if (\r\n        self.storedSettings.orders.rows.length >= (self.viewData || []).length\r\n      ) {\r\n        self.orders.rows = self.storedSettings.orders.rows;\r\n      }\r\n      s = self.getSchema();\r\n      if (self.storedSettings.orders.columns.length === s.length) {\r\n        self.orders.columns = self.storedSettings.orders.columns;\r\n      }\r\n      self.orderBy =\r\n        self.storedSettings.orderBy === undefined\r\n          ? s[0].name\r\n          : self.storedSettings.orderBy;\r\n      self.orderDirection =\r\n        self.storedSettings.orderDirection === undefined\r\n          ? 'asc'\r\n          : self.storedSettings.orderDirection;\r\n      if (\r\n        self.storedSettings.orderBy !== undefined &&\r\n        self.getHeaderByName(self.orderBy) &&\r\n        self.orderDirection\r\n      ) {\r\n        self.order(self.orderBy, self.orderDirection);\r\n      }\r\n    }\r\n  };\r\n  self.getDomRoot = function () {\r\n    return self.shadowRoot ? self.shadowRoot.host : self.parentNode;\r\n  };\r\n  self.getFontName = function (fontStyle) {\r\n    return fontStyle.replace(/\\d+\\.?\\d*px/, '');\r\n  };\r\n  self.getFontHeight = function (fontStyle) {\r\n    return parseFloat(fontStyle, 10);\r\n  };\r\n  self.parseStyleValue = function (key) {\r\n    if (/Font/.test(key)) {\r\n      self.style[key + 'Height'] = self.getFontHeight(self.style[key]);\r\n      self.style[key + 'Name'] = self.getFontName(self.style[key]);\r\n      return;\r\n    }\r\n    // when inheriting styles from already instantiated grids, don't parse already parsed values.\r\n    if (\r\n      key === 'moveOverlayBorderSegments' &&\r\n      typeof self.style[key] === 'string'\r\n    ) {\r\n      self.style[key] = self.style[key].split(',').map(function (i) {\r\n        return parseInt(i, 10);\r\n      });\r\n    }\r\n  };\r\n  self.initProp = function (propName) {\r\n    if (!self.args[propName]) {\r\n      return;\r\n    }\r\n    Object.keys(self.args[propName]).forEach(function (key) {\r\n      self[propName][key] = self.args[propName][key];\r\n    });\r\n  };\r\n  self.getStyleProperty = function (key) {\r\n    if (self.styleKeys.indexOf(key) === -1) {\r\n      return self.parentNodeStyle[key];\r\n    }\r\n    return self.style[key];\r\n  };\r\n  self.setStyleProperty = function (key, value, supressDrawAndEvent) {\r\n    var isDim =\r\n      [\r\n        'height',\r\n        'width',\r\n        'minHeight',\r\n        'minWidth',\r\n        'maxHeight',\r\n        'maxWidth',\r\n      ].indexOf(key) !== -1;\r\n    if (self.styleKeys.indexOf(key) === -1) {\r\n      self.parentNodeStyle[key] = value;\r\n    } else {\r\n      if (/-/.test(key)) {\r\n        key = self.dehyphenateProperty(key);\r\n      }\r\n      self.style[key] = value;\r\n      self.parseStyleValue(key);\r\n    }\r\n    if (isDim) {\r\n      self.resize();\r\n    }\r\n    if (!supressDrawAndEvent) {\r\n      self.draw(true);\r\n      self.dispatchEvent('stylechanged', { name: 'style', value: value });\r\n    }\r\n  };\r\n  self.reloadStoredValues = function () {\r\n    if (self.attributes.name && self.attributes.saveAppearance) {\r\n      try {\r\n        self.storedSettings = localStorage.getItem(\r\n          self.storageName + '-' + self.attributes.name,\r\n        );\r\n      } catch (e) {\r\n        console.warn('Error loading stored values. ' + e.message);\r\n        self.storedSettings = undefined;\r\n      }\r\n      if (self.storedSettings) {\r\n        try {\r\n          self.storedSettings = JSON.parse(self.storedSettings);\r\n        } catch (e) {\r\n          console.warn('could not read settings from localStore', e);\r\n          self.storedSettings = undefined;\r\n        }\r\n      }\r\n      if (self.storedSettings) {\r\n        if (\r\n          typeof self.storedSettings.sizes === 'object' &&\r\n          self.storedSettings.sizes !== null\r\n        ) {\r\n          self.sizes.rows = self.storedSettings.sizes.rows;\r\n          self.sizes.columns = self.storedSettings.sizes.columns;\r\n          ['trees', 'columns', 'rows'].forEach(function (i) {\r\n            if (!self.sizes[i]) {\r\n              self.sizes[i] = {};\r\n            }\r\n          });\r\n        }\r\n        if (typeof self.storedSettings.visibility === 'object') {\r\n          self.getSchema().forEach(function (column) {\r\n            if (\r\n              self.storedSettings.visibility &&\r\n              self.storedSettings.visibility[column.name] !== undefined\r\n            ) {\r\n              column.hidden = !self.storedSettings.visibility[column.name];\r\n            }\r\n          });\r\n        }\r\n      }\r\n    }\r\n  };\r\n  self.init = function () {\r\n    if (self.initialized) {\r\n      return;\r\n    }\r\n    function addStyleKeyIfNoneExists(key) {\r\n      if (self.styleKeys.indexOf(key) === -1) {\r\n        self.styleKeys.push(key);\r\n      }\r\n    }\r\n    var publicStyleKeyIntf = {};\r\n    self.setAttributes();\r\n    self.setStyle();\r\n    self.initScrollBox();\r\n    self.setDom();\r\n    self.nodeType = 'canvas-datagrid';\r\n    self.ie = /Trident/.test(window.navigator.userAgent);\r\n    self.edge = /Edge/.test(window.navigator.userAgent);\r\n    self.webKit = /WebKit/.test(window.navigator.userAgent);\r\n    self.moz = /Gecko/.test(window.navigator.userAgent);\r\n    self.mobile = /Mobile/i.test(window.navigator.userAgent);\r\n    self.blankValues = [undefined, null, ''];\r\n    self.cursorGrab = 'grab';\r\n    self.cursorGrabing = 'grabbing';\r\n    self.cursorGrab = self.webKit ? '-webkit-grab' : self.cursorGrab;\r\n    self.cursorGrabing = self.moz ? '-webkit-grabbing' : self.cursorGrabbing;\r\n    self.pointerLockPosition = { x: 0, y: 0 };\r\n    Object.keys(self.style).forEach(self.parseStyleValue);\r\n    self.intf.moveSelection = self.moveSelection;\r\n    self.intf.deleteSelectedData = self.deleteSelectedData;\r\n    self.intf.moveTo = self.moveTo;\r\n    self.intf.addEventListener = self.addEventListener;\r\n    self.intf.removeEventListener = self.removeEventListener;\r\n    self.intf.dispatchEvent = self.dispatchEvent;\r\n    /**\r\n     * Releases grid resources and removes grid elements.\r\n     * @memberof canvasDatagrid\r\n     * @name dispose\r\n     * @method\r\n     */\r\n    self.intf.dispose = self.dispose;\r\n    /**\r\n     * Appends the grid to another element later.  Not implemented.\r\n     * @memberof canvasDatagrid\r\n     * @name appendTo\r\n     * @method\r\n     * @param {number} el The element to append the grid to.\r\n     */\r\n    self.intf.appendTo = self.appendTo;\r\n    self.intf.getVisibleCellByIndex = self.getVisibleCellByIndex;\r\n    self.intf.filters = self.filters;\r\n    self.intf.sorters = self.sorters;\r\n    self.intf.autosize = self.autosize;\r\n    self.intf.beginEditAt = self.beginEditAt;\r\n    self.intf.endEdit = self.endEdit;\r\n    self.intf.setActiveCell = self.setActiveCell;\r\n    self.intf.forEachSelectedCell = self.forEachSelectedCell;\r\n    self.intf.scrollIntoView = self.scrollIntoView;\r\n    self.intf.clearChangeLog = self.clearChangeLog;\r\n    self.intf.gotoCell = self.gotoCell;\r\n    self.intf.gotoRow = self.gotoRow;\r\n    self.intf.addButton = self.addButton;\r\n    self.intf.getHeaderByName = self.getHeaderByName;\r\n    self.intf.findColumnScrollLeft = self.findColumnScrollLeft;\r\n    self.intf.findRowScrollTop = self.findRowScrollTop;\r\n    self.intf.fitColumnToValues = self.fitColumnToValues;\r\n    self.intf.findColumnMaxTextLength = self.findColumnMaxTextLength;\r\n    self.intf.disposeContextMenu = self.disposeContextMenu;\r\n    self.intf.getCellAt = self.getCellAt;\r\n    self.intf.isCellVisible = self.isCellVisible;\r\n    self.intf.isRowVisible = self.isRowVisible;\r\n    self.intf.isColumnVisible = self.isColumnVisible;\r\n    self.intf.order = self.order;\r\n    self.intf.draw = self.draw;\r\n    self.intf.refresh = self.refresh;\r\n    self.intf.isComponent = self.isComponent;\r\n    self.intf.selectArea = self.selectArea;\r\n    self.intf.clipElement = self.clipElement;\r\n    self.intf.getSchemaFromData = self.getSchemaFromData;\r\n    self.intf.setFilter = self.setFilter;\r\n    self.intf.selectRow = self.selectRow;\r\n    self.intf.parentGrid = self.parentGrid;\r\n    self.intf.toggleTree = self.toggleTree;\r\n    self.intf.expandTree = self.expandTree;\r\n    self.intf.collapseTree = self.collapseTree;\r\n    self.intf.canvas = self.canvas;\r\n    self.intf.context = self.ctx;\r\n    self.intf.insertRow = self.insertRow;\r\n    self.intf.deleteRow = self.deleteRow;\r\n    self.intf.addRow = self.addRow;\r\n    self.intf.insertColumn = self.insertColumn;\r\n    self.intf.deleteColumn = self.deleteColumn;\r\n    self.intf.addColumn = self.addColumn;\r\n    self.intf.getClippingRect = self.getClippingRect;\r\n    self.intf.setRowHeight = self.setRowHeight;\r\n    self.intf.setColumnWidth = self.setColumnWidth;\r\n    self.intf.resetColumnWidths = self.resetColumnWidths;\r\n    self.intf.resetRowHeights = self.resetRowHeights;\r\n    self.intf.resize = self.resize;\r\n    self.intf.selectColumn = self.selectColumn;\r\n    self.intf.selectRow = self.selectRow;\r\n    self.intf.selectAll = self.selectAll;\r\n    self.intf.selectNone = self.selectNone;\r\n    self.intf.drawChildGrids = self.drawChildGrids;\r\n    self.intf.assertPxColor = self.assertPxColor;\r\n    self.intf.clearPxColorAssertions = self.clearPxColorAssertions;\r\n    self.intf.integerToAlpha = self.integerToAlpha;\r\n    self.intf.copy = self.copy;\r\n    self.intf.cut = self.cut;\r\n    self.intf.paste = self.paste;\r\n    self.intf.setStyleProperty = self.setStyleProperty;\r\n    Object.defineProperty(self.intf, 'defaults', {\r\n      get: function () {\r\n        return {\r\n          styles: self.defaults.styles.reduce(function (a, i) {\r\n            a[i[0]] = i[1];\r\n            return a;\r\n          }, {}),\r\n          attributes: self.defaults.attributes.reduce(function (a, i) {\r\n            a[i[0]] = i[1];\r\n            return a;\r\n          }, {}),\r\n        };\r\n      },\r\n    });\r\n    self.styleKeys = Object.keys(self.intf.defaults.styles);\r\n    self.styleKeys\r\n      .map(function (i) {\r\n        return self.hyphenateProperty(i, false);\r\n      })\r\n      .forEach(addStyleKeyIfNoneExists);\r\n    self.styleKeys\r\n      .map(function (i) {\r\n        return self.hyphenateProperty(i, true);\r\n      })\r\n      .forEach(addStyleKeyIfNoneExists);\r\n    self.DOMStyles = window.getComputedStyle(document.body, null);\r\n    self.styleKeys.concat(Object.keys(self.DOMStyles)).forEach(function (key) {\r\n      // unless this line is here, Object.keys() will not work on <instance>.style\r\n      publicStyleKeyIntf[key] = undefined;\r\n      Object.defineProperty(publicStyleKeyIntf, key, {\r\n        get: function () {\r\n          return self.getStyleProperty(key);\r\n        },\r\n        set: function (value) {\r\n          if (self.initialized) {\r\n            self.appliedInlineStyles[key] = value;\r\n          }\r\n          self.setStyleProperty(key, value);\r\n        },\r\n      });\r\n    });\r\n    Object.defineProperty(self.intf, 'shadowRoot', {\r\n      get: function () {\r\n        return self.shadowRoot;\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'activeCell', {\r\n      get: function () {\r\n        return self.activeCell;\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'hasFocus', {\r\n      get: function () {\r\n        return self.hasFocus;\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'hasActiveFilters', {\r\n      get: function () {\r\n        return self.hasActiveFilters();\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'style', {\r\n      get: function () {\r\n        return publicStyleKeyIntf;\r\n      },\r\n      set: function (valueObject) {\r\n        Object.keys(valueObject).forEach(function (key) {\r\n          self.setStyleProperty(key, valueObject[key], true);\r\n        });\r\n        self.draw(true);\r\n        self.dispatchEvent('stylechanged', {\r\n          name: 'style',\r\n          value: valueObject,\r\n        });\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'attributes', { value: {} });\r\n    Object.keys(self.attributes).forEach(function (key) {\r\n      Object.defineProperty(self.intf.attributes, key, {\r\n        get: function () {\r\n          return self.attributes[key];\r\n        },\r\n        set: function (value) {\r\n          self.attributes[key] = value;\r\n          if (key === 'name') {\r\n            self.tryLoadStoredSettings();\r\n          }\r\n          self.draw(true);\r\n          self.dispatchEvent('attributechanged', {\r\n            name: key,\r\n            value: value[key],\r\n          });\r\n        },\r\n      });\r\n    });\r\n    self.filters.string = function (value, filterFor) {\r\n      if (filterFor === self.attributes.blanksText) {\r\n        return self.blankValues.includes(\r\n          value == null ? value : String(value).trim(),\r\n        );\r\n      }\r\n\r\n      value = String(value);\r\n      var filterRegExp,\r\n        regEnd = /\\/(i|g|m)*$/,\r\n        pattern = regEnd.exec(filterFor),\r\n        flags = pattern ? pattern[0].substring(1) : '',\r\n        flagLength = flags.length;\r\n      self.invalidFilterRegEx = undefined;\r\n      if (filterFor.substring(0, 1) === '/' && pattern) {\r\n        try {\r\n          filterRegExp = new RegExp(\r\n            filterFor.substring(1, filterFor.length - (flagLength + 1)),\r\n            flags,\r\n          );\r\n        } catch (e) {\r\n          self.invalidFilterRegEx = e;\r\n          return;\r\n        }\r\n        return filterRegExp.test(value);\r\n      }\r\n      return value.toString\r\n        ? value\r\n            .toString()\r\n            .toLocaleUpperCase()\r\n            .indexOf(filterFor.toLocaleUpperCase()) !== -1\r\n        : false;\r\n    };\r\n    self.filters.number = function (value, filterFor) {\r\n      if (filterFor === self.attributes.blanksText) {\r\n        return self.blankValues.includes(\r\n          value == null ? value : String(value).trim(),\r\n        );\r\n      }\r\n\r\n      if (!filterFor) {\r\n        return true;\r\n      }\r\n      return value === filterFor;\r\n    };\r\n    ['formatters', 'filters', 'sorters'].forEach(self.initProp);\r\n    self.applyComponentStyle(false, self.intf);\r\n    self.reloadStoredValues();\r\n    if (self.args.data) {\r\n      self.intf.data = self.args.data;\r\n    }\r\n    if (self.intf.innerText || self.intf.textContent) {\r\n      if (self.intf.dataType === 'application/x-canvas-datagrid') {\r\n        self.intf.dataType = 'application/json+x-canvas-datagrid';\r\n      }\r\n      self.intf.data = self.intf.innerText || self.intf.textContent;\r\n    }\r\n    if (self.args.schema) {\r\n      self.intf.schema = self.args.schema;\r\n    }\r\n    if (self.isChildGrid || !self.isComponent) {\r\n      requestAnimationFrame(function () {\r\n        self.resize(true);\r\n      });\r\n    } else {\r\n      self.resize(true);\r\n    }\r\n    self.initialized = true;\r\n    return self;\r\n  };\r\n  /**\r\n   * Removes focus from the grid.\r\n   * @memberof canvasDatagrid\r\n   * @name blur\r\n   * @method\r\n   */\r\n  self.intf.blur = function (e) {\r\n    self.hasFocus = false;\r\n  };\r\n  /**\r\n   * Focuses on the grid.\r\n   * @memberof canvasDatagrid\r\n   * @name focus\r\n   * @method\r\n   */\r\n  self.intf.focus = function () {\r\n    self.hasFocus = true;\r\n    self.controlInput.focus();\r\n  };\r\n  if (self.shadowRoot || self.isChildGrid) {\r\n    Object.defineProperty(self.intf, 'height', {\r\n      get: function () {\r\n        if (self.shadowRoot) {\r\n          return self.shadowRoot.height;\r\n        }\r\n        return self.parentNode.height;\r\n      },\r\n      set: function (value) {\r\n        if (self.shadowRoot) {\r\n          self.shadowRoot.height = value;\r\n        } else {\r\n          self.parentNode.height = value;\r\n        }\r\n        self.resize(true);\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'width', {\r\n      get: function () {\r\n        if (self.shadowRoot) {\r\n          return self.shadowRoot.width;\r\n        }\r\n        return self.parentNode.width;\r\n      },\r\n      set: function (value) {\r\n        if (self.shadowRoot) {\r\n          self.shadowRoot.width = value;\r\n        } else {\r\n          self.parentNode.width = value;\r\n        }\r\n        self.resize(true);\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'parentNode', {\r\n      get: function () {\r\n        return self.parentNode;\r\n      },\r\n      set: function (value) {\r\n        if (!self.isChildGrid) {\r\n          throw new TypeError(\r\n            'Cannot set property parentNode which has only a getter',\r\n          );\r\n        }\r\n        self.parentNode = value;\r\n      },\r\n    });\r\n  }\r\n  Object.defineProperty(self.intf, 'visibleRowHeights', {\r\n    get: function () {\r\n      return self.visibleRowHeights;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'openChildren', {\r\n    get: function () {\r\n      return self.openChildren;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'childGrids', {\r\n    get: function () {\r\n      return Object.keys(self.childGrids).map(function (gridId) {\r\n        return self.childGrids[gridId];\r\n      });\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'isChildGrid', {\r\n    get: function () {\r\n      return self.isChildGrid;\r\n    },\r\n  });\r\n  Object.defineProperty(self, 'cursor', {\r\n    get: function () {\r\n      return self.parentNodeStyle.cursor;\r\n    },\r\n    set: function (value) {\r\n      if (value === 'cell') {\r\n        value = 'default';\r\n      }\r\n      if (self.currentCursor !== value) {\r\n        self.parentNodeStyle.cursor = value;\r\n        self.currentCursor = value;\r\n      }\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'orderDirection', {\r\n    get: function () {\r\n      return self.orderDirection;\r\n    },\r\n    set: function (value) {\r\n      if (value !== 'desc') {\r\n        value = 'asc';\r\n      }\r\n      self.orderDirection = value;\r\n      self.order(self.orderBy, self.orderDirection);\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'orderBy', {\r\n    get: function () {\r\n      return self.orderBy;\r\n    },\r\n    set: function (value) {\r\n      if (\r\n        self.getSchema().find(function (col) {\r\n          return col.name === value;\r\n        }) === undefined\r\n      ) {\r\n        throw new Error('Cannot sort by unknown column name.');\r\n      }\r\n      self.orderBy = value;\r\n      self.order(self.orderBy, self.orderDirection);\r\n    },\r\n  });\r\n  if (self.isComponent) {\r\n    Object.defineProperty(self.intf, 'offsetHeight', {\r\n      get: function () {\r\n        return self.canvas.offsetHeight;\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'offsetWidth', {\r\n      get: function () {\r\n        return self.canvas.offsetWidth;\r\n      },\r\n    });\r\n  }\r\n  Object.defineProperty(self.intf, 'scrollHeight', {\r\n    get: function () {\r\n      return self.scrollBox.scrollHeight;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollWidth', {\r\n    get: function () {\r\n      return self.scrollBox.scrollWidth;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollTop', {\r\n    get: function () {\r\n      return self.scrollBox.scrollTop;\r\n    },\r\n    set: function (value) {\r\n      self.scrollBox.scrollTop = value;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollLeft', {\r\n    get: function () {\r\n      return self.scrollBox.scrollLeft;\r\n    },\r\n    set: function (value) {\r\n      self.scrollBox.scrollLeft = value;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'sizes', {\r\n    get: function () {\r\n      return self.sizes;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'parentDOMNode', {\r\n    get: function () {\r\n      return self.parentDOMNode;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'input', {\r\n    get: function () {\r\n      return self.input;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'controlInput', {\r\n    get: function () {\r\n      return self.controlInput;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'currentCell', {\r\n    get: function () {\r\n      return self.currentCell;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'visibleCells', {\r\n    get: function () {\r\n      return self.visibleCells;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'visibleRows', {\r\n    get: function () {\r\n      return self.visibleRows;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'selections', {\r\n    get: function () {\r\n      return self.selections;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'dragMode', {\r\n    get: function () {\r\n      return self.dragMode;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'changes', {\r\n    get: function () {\r\n      return self.changes;\r\n    },\r\n  });\r\n  self.intf.formatters = self.formatters;\r\n  Object.defineProperty(self.intf, 'dataType', {\r\n    get: function () {\r\n      return self.dataType;\r\n    },\r\n    set: function (value) {\r\n      if (!self.parsers[value]) {\r\n        throw new Error('No parser for MIME type ' + value);\r\n      }\r\n      self.dataType = value;\r\n    },\r\n  });\r\n  self.eventNames.forEach(function (eventName) {\r\n    Object.defineProperty(self.intf, 'on' + eventName, {\r\n      get: function () {\r\n        return self.componentL1Events[eventName];\r\n      },\r\n      set: function (value) {\r\n        self.events[eventName] = [];\r\n        self.componentL1Events[eventName] = value;\r\n        if (!value) {\r\n          return;\r\n        }\r\n        self.addEventListener(eventName, value);\r\n      },\r\n    });\r\n  });\r\n  Object.defineProperty(self.intf, 'frozenRow', {\r\n    get: function () {\r\n      return self.frozenRow;\r\n    },\r\n    set: function (val) {\r\n      if (isNaN(val)) {\r\n        throw new TypeError('Expected value for frozenRow to be a number.');\r\n      }\r\n      if (self.visibleRows.length < val) {\r\n        throw new RangeError(\r\n          'Cannot set a value larger than the number of visible rows.',\r\n        );\r\n      }\r\n      self.frozenRow = val;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'frozenColumn', {\r\n    get: function () {\r\n      return self.frozenColumn;\r\n    },\r\n    set: function (val) {\r\n      if (isNaN(val)) {\r\n        throw new TypeError('Expected value for frozenRow to be a number.');\r\n      }\r\n      if (self.getVisibleSchema().length < val) {\r\n        throw new RangeError(\r\n          'Cannot set a value larger than the number of visible columns.',\r\n        );\r\n      }\r\n      self.frozenColumn = val;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollIndexRect', {\r\n    get: function () {\r\n      return {\r\n        top: self.scrollIndexTop,\r\n        right: self.scrollIndexRight,\r\n        bottom: self.scrollIndexBottom,\r\n        left: self.scrollIndexLeft,\r\n      };\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollPixelRect', {\r\n    get: function () {\r\n      return {\r\n        top: self.scrollPixelTop,\r\n        right: self.scrollPixelRight,\r\n        bottom: self.scrollPixelBottom,\r\n        left: self.scrollPixelLeft,\r\n      };\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'rowOrder', {\r\n    get: function () {\r\n      return self.orders.rows;\r\n    },\r\n    set: function (val) {\r\n      if (!Array.isArray(val)) {\r\n        throw new TypeError('Value must be an array.');\r\n      }\r\n      if (!self.originalData || val.length < self.originalData.length) {\r\n        throw new RangeError(\r\n          'Array length must be equal to or greater than number of rows.',\r\n        );\r\n      }\r\n      self.orders.rows = val;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'columnOrder', {\r\n    get: function () {\r\n      return self.orders.columns;\r\n    },\r\n    set: function (val) {\r\n      if (!Array.isArray(val)) {\r\n        throw new TypeError('Value must be an array.');\r\n      }\r\n      if (val.length < self.getSchema().length) {\r\n        throw new RangeError(\r\n          'Array length must be equal to or greater than number of columns.',\r\n        );\r\n      }\r\n      self.orders.columns = val;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'selectionBounds', {\r\n    get: function () {\r\n      return self.getSelectionBounds();\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'selectedRows', {\r\n    get: function () {\r\n      return self.getSelectedData(true);\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'selectedCells', {\r\n    get: function () {\r\n      return self.getSelectedData();\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'visibleSchema', {\r\n    get: function () {\r\n      return self.getVisibleSchema().map(function eachDataRow(col) {\r\n        return col;\r\n      });\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'treeGridAttributes', {\r\n    get: function () {\r\n      return self.treeGridAttributes;\r\n    },\r\n    set: function setTreeGridAttributes(value) {\r\n      self.treeGridAttributes = value;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'cellGridAttributes', {\r\n    get: function () {\r\n      return self.cellGridAttributes;\r\n    },\r\n    set: function setCellGridAttributes(value) {\r\n      self.cellGridAttributes = value;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'ctx', {\r\n    get: function () {\r\n      return self.ctx;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'schema', {\r\n    get: function schemaGetter() {\r\n      return self.getSchema();\r\n    },\r\n    set: function schemaSetter(value) {\r\n      if (value === undefined) {\r\n        // Issue #89 - allow schema to be set to initialized state\r\n        self.schema = undefined;\r\n        self.tempSchema = undefined;\r\n        self.dispatchEvent('schemachanged', { schema: undefined });\r\n        return;\r\n      }\r\n      if (!Array.isArray(value) || typeof value[0] !== 'object') {\r\n        throw new Error('Schema must be an array of objects.');\r\n      }\r\n      if (value[0].name === undefined) {\r\n        throw new Error(\r\n          'Expected schema to contain an object with at least a name property.',\r\n        );\r\n      }\r\n      self.schema = value.map(function eachSchemaColumn(column, index) {\r\n        column.width = column.width || self.style.cellWidth;\r\n        column.filter = column.filter || self.filter(column.type);\r\n        column.type = column.type || 'string';\r\n        column.index = index;\r\n        column.columnIndex = index;\r\n        column.rowIndex = -1;\r\n        return column;\r\n      });\r\n      self.tempSchema = undefined;\r\n      self.createNewRowData();\r\n      self.createColumnOrders();\r\n      self.tryLoadStoredSettings();\r\n      if (\r\n        self.storedSettings &&\r\n        typeof self.storedSettings.visibility === 'object'\r\n      ) {\r\n        self.schema.forEach(function hideEachSchemaColumn(column, index) {\r\n          if (\r\n            self.storedSettings &&\r\n            self.storedSettings.visibility[column.name] !== undefined\r\n          ) {\r\n            column.hidden = !self.storedSettings.visibility[column.name];\r\n          }\r\n        });\r\n      }\r\n      self.resize(true);\r\n      self.dispatchEvent('schemachanged', { schema: self.schema });\r\n    },\r\n  });\r\n  /**\r\n   * Gets an array of currently registered MIME types.\r\n   * @memberof canvasDatagrid\r\n   * @name getDataTypes\r\n   * @method\r\n   */\r\n  self.intf.getTypes = function () {\r\n    return Object.keys(self.parsers);\r\n  };\r\n  self.parseInnerHtml = function (data) {\r\n    if (!data || /^ +$/.test(data)) {\r\n      return [];\r\n    }\r\n    try {\r\n      data = JSON.parse(data);\r\n    } catch (e) {\r\n      console.warn(\r\n        Error(\r\n          'Cannot parse application/json+x-canvas-datagrid formated data. ' +\r\n            e.message +\r\n            '  \\nNote: canvas-datagrid.innerHTML is for string data only.  ' +\r\n            'Use the canvas-datagrid.data property to set object data.',\r\n        ),\r\n      );\r\n    }\r\n    return data;\r\n  };\r\n  self.parsers['application/json+x-canvas-datagrid'] = function (\r\n    data,\r\n    callback,\r\n  ) {\r\n    self.parsers['application/x-canvas-datagrid'](\r\n      self.parseInnerHtml(data),\r\n      function (data, schema) {\r\n        return callback(data, schema);\r\n      },\r\n    );\r\n  };\r\n  self.parsers['application/x-canvas-datagrid'] = function (data, callback) {\r\n    return callback(data);\r\n  };\r\n  self.intf.parsers = self.parsers;\r\n  // send to dataType ETL function to extract from input data\r\n  // and transform into native [{}, {}] format\r\n  self.etl = function (data, callback) {\r\n    if (!self.intf.parsers[self.dataType]) {\r\n      throw new Error('Unsupported data type.');\r\n    }\r\n    self.intf.parsers[self.dataType](data, function (data, schema) {\r\n      // set the unfiltered/sorted data array\r\n      self.originalData = data;\r\n      self.viewData = Array.from(self.originalData);\r\n\r\n      if (Array.isArray(schema)) {\r\n        self.schema = schema;\r\n      }\r\n      // Issue #89 - allow schema to be auto-created every time data is set\r\n      if (self.attributes.autoGenerateSchema) {\r\n        self.schema = self.getSchemaFromData(data);\r\n      }\r\n      if (!self.schema) {\r\n        self.tempSchema = self.getSchemaFromData(data);\r\n      }\r\n      if (self.getSchema()) {\r\n        self.createColumnOrders();\r\n      }\r\n      // apply filter, sort, etc to incoming dataset, set viewData:\r\n      self.refresh();\r\n      // empty data was set\r\n      if (!self.schema && (self.originalData || []).length === 0) {\r\n        self.tempSchema = [{ name: '' }];\r\n      }\r\n      self.fitColumnToValues('cornerCell', true);\r\n      if (\r\n        (self.tempSchema && !self.schema) ||\r\n        self.attributes.autoGenerateSchema\r\n      ) {\r\n        self.createColumnOrders();\r\n        self.dispatchEvent('schemachanged', { schema: self.tempSchema });\r\n      }\r\n      callback();\r\n    });\r\n  };\r\n  Object.defineProperty(self.intf, 'viewData', {\r\n    get: function () {\r\n      return self.viewData;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'boundData', {\r\n    get: function () {\r\n      return self.originalData;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'data', {\r\n    get: function dataGetter() {\r\n      return self.originalData;\r\n    },\r\n    set: function dataSetter(value) {\r\n      self.etl(value, function () {\r\n        self.changes = [];\r\n        self.createNewRowData();\r\n        if (\r\n          self.attributes.autoResizeColumns &&\r\n          self.originalData.length > 0 &&\r\n          self.storedSettings === undefined\r\n        ) {\r\n          self.autosize();\r\n        }\r\n        // set the header column to fit the numbers in it\r\n        self.fitColumnToValues('cornerCell', true);\r\n        self.createRowOrders();\r\n        self.tryLoadStoredSettings();\r\n        self.dispatchEvent('datachanged', { data: self.originalData });\r\n        self.resize(true);\r\n      });\r\n    },\r\n  });\r\n  self.initScrollBox = function () {\r\n    var sHeight = 0,\r\n      sWidth = 0,\r\n      scrollTop = 0,\r\n      scrollLeft = 0,\r\n      scrollHeight = 0,\r\n      scrollWidth = 0,\r\n      scrollBoxHeight = 20,\r\n      scrollBoxWidth = 20;\r\n    function setScrollTop(value, preventScrollEvent) {\r\n      if (isNaN(value)) {\r\n        throw new Error('ScrollTop value must be a number');\r\n      }\r\n      if (value < 0) {\r\n        value = 0;\r\n      }\r\n      if (value > scrollHeight) {\r\n        value = scrollHeight;\r\n      }\r\n      if (scrollHeight < 0) {\r\n        value = 0;\r\n      }\r\n      scrollTop = value;\r\n      if (!preventScrollEvent) {\r\n        self.scroll();\r\n      }\r\n      if (self.button) {\r\n        self.moveButtonPos();\r\n      }\r\n    }\r\n    function setScrollLeft(value, preventScrollEvent) {\r\n      if (isNaN(value)) {\r\n        throw new Error('ScrollLeft value must be a number');\r\n      }\r\n      if (value < 0) {\r\n        value = 0;\r\n      }\r\n      if (value > scrollWidth) {\r\n        value = scrollWidth;\r\n      }\r\n      if (scrollWidth < 0) {\r\n        value = 0;\r\n      }\r\n      scrollLeft = value;\r\n      if (!preventScrollEvent) {\r\n        self.scroll();\r\n      }\r\n      if (self.button) {\r\n        self.moveButtonPos();\r\n      }\r\n    }\r\n    self.scrollBox.toString = function () {\r\n      return (\r\n        '{\"width\": ' +\r\n        scrollWidth.toFixed(2) +\r\n        ', \"height\": ' +\r\n        scrollHeight.toFixed(2) +\r\n        ', \"left\": ' +\r\n        scrollLeft.toFixed(2) +\r\n        ', \"top\": ' +\r\n        scrollTop.toFixed(2) +\r\n        ', \"widthRatio\": ' +\r\n        self.scrollBox.widthBoxRatio.toFixed(5) +\r\n        ', \"heightRatio\": ' +\r\n        self.scrollBox.heightBoxRatio.toFixed(5) +\r\n        '}'\r\n      );\r\n    };\r\n    self.scrollBox.scrollTo = function (x, y, supressDrawEvent) {\r\n      setScrollLeft(x, true);\r\n      setScrollTop(y, supressDrawEvent);\r\n    };\r\n    Object.defineProperty(self.scrollBox, 'scrollBoxHeight', {\r\n      get: function () {\r\n        return scrollBoxHeight;\r\n      },\r\n      set: function (value) {\r\n        scrollBoxHeight = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollBoxWidth', {\r\n      get: function () {\r\n        return scrollBoxWidth;\r\n      },\r\n      set: function (value) {\r\n        scrollBoxWidth = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'height', {\r\n      get: function () {\r\n        return sHeight;\r\n      },\r\n      set: function (value) {\r\n        sHeight = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'width', {\r\n      get: function () {\r\n        return sWidth;\r\n      },\r\n      set: function (value) {\r\n        sWidth = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollTop', {\r\n      get: function () {\r\n        return scrollTop;\r\n      },\r\n      set: setScrollTop,\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollLeft', {\r\n      get: function () {\r\n        return scrollLeft;\r\n      },\r\n      set: setScrollLeft,\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollHeight', {\r\n      get: function () {\r\n        return scrollHeight;\r\n      },\r\n      set: function (value) {\r\n        if (scrollTop > value) {\r\n          scrollTop = Math.max(value, 0);\r\n        }\r\n        scrollHeight = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollWidth', {\r\n      get: function () {\r\n        return scrollWidth;\r\n      },\r\n      set: function (value) {\r\n        if (scrollLeft > value) {\r\n          scrollLeft = Math.max(value, 0);\r\n        }\r\n        scrollWidth = value;\r\n      },\r\n    });\r\n  };\r\n  return;\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true, evil: true*/\r\n/*globals Reflect: false, HTMLElement: true, define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nimport component from './component';\r\nimport defaults from './defaults';\r\nimport draw from './draw';\r\nimport events from './events';\r\nimport touch from './touch';\r\nimport intf from './intf';\r\nimport contextMenu from './contextMenu';\r\nimport button from './button';\r\nimport dom from './dom';\r\nimport publicMethods from './publicMethods';\r\n\r\nvar webComponent = component();\r\n\r\nvar modules = [\r\n  defaults,\r\n  draw,\r\n  events,\r\n  touch,\r\n  intf,\r\n  contextMenu,\r\n  button,\r\n  dom,\r\n  publicMethods,\r\n];\r\n\r\nfunction Grid(args) {\r\n  args = args || {};\r\n  var self = {};\r\n  self.isComponent = args.component === undefined;\r\n  self.isChildGrid =\r\n    args.parentNode &&\r\n    /canvas-datagrid-(cell|tree)/.test(args.parentNode.nodeType);\r\n  if (self.isChildGrid) {\r\n    self.intf = {};\r\n  } else {\r\n    self.intf = self.isComponent\r\n      ? eval('Reflect.construct(HTMLElement, [], new.target)')\r\n      : document.createElement('canvas');\r\n  }\r\n  self.args = args;\r\n  self.intf.args = args;\r\n  self.applyComponentStyle = webComponent.applyComponentStyle;\r\n  self.hyphenateProperty = webComponent.hyphenateProperty;\r\n  self.dehyphenateProperty = webComponent.dehyphenateProperty;\r\n  self.createGrid = function grid(args) {\r\n    args.component = false;\r\n    return new Grid(args);\r\n  };\r\n\r\n  modules.forEach(function (module) {\r\n    module(self);\r\n  });\r\n\r\n  if (self.isChildGrid) {\r\n    self.shadowRoot = args.parentNode.shadowRoot;\r\n    self.parentNode = args.parentNode;\r\n  } else {\r\n    self.shadowRoot = self.intf.attachShadow({ mode: 'open' });\r\n    self.parentNode = self.shadowRoot;\r\n  }\r\n  self.init();\r\n  self.observer = webComponent.getObserver();\r\n  return self.intf;\r\n}\r\nif (window.HTMLElement) {\r\n  Grid.prototype = Object.create(window.HTMLElement.prototype);\r\n}\r\n// export web component\r\nif (window.customElements) {\r\n  Grid.observedAttributes = webComponent.getObservableAttributes();\r\n  Grid.prototype.disconnectedCallback = webComponent.disconnectedCallback;\r\n  Grid.prototype.attributeChangedCallback =\r\n    webComponent.attributeChangedCallback;\r\n  Grid.prototype.connectedCallback = webComponent.connectedCallback;\r\n  Grid.prototype.adoptedCallback = webComponent.adoptedCallback;\r\n  window.customElements.define('canvas-datagrid', Grid);\r\n}\r\n\r\n// export global\r\nif (\r\n  window &&\r\n  !window.canvasDatagrid &&\r\n  !window.require &&\r\n  // Present to exclude global declarations from ES Module bundles\r\n  !window.EXCLUDE_GLOBAL\r\n) {\r\n  window.canvasDatagrid = function (args) {\r\n    return new Grid(args);\r\n  };\r\n}\r\n\r\n// export amd loader\r\nexport default function canvasDatagrid(args) {\r\n  args = args || {};\r\n  var i,\r\n    tKeys = [\r\n      'style',\r\n      'formatters',\r\n      'sorters',\r\n      'filters',\r\n      'treeGridAttributes',\r\n      'cellGridAttributes',\r\n      'data',\r\n      'schema',\r\n    ];\r\n  if (window.customElements) {\r\n    i = document.createElement('canvas-datagrid');\r\n    Object.keys(args).forEach(function (argKey) {\r\n      // set data and parentNode after everything else\r\n      if (argKey === 'data') {\r\n        return;\r\n      }\r\n      if (argKey === 'parentNode') {\r\n        return;\r\n      }\r\n      // top level keys in args\r\n      if (tKeys.indexOf(argKey) !== -1) {\r\n        tKeys.forEach(function (tKey) {\r\n          if (args[tKey] === undefined || tKey !== argKey) {\r\n            return;\r\n          }\r\n          if (['formatters', 'sorters', 'filters'].indexOf(argKey) !== -1) {\r\n            if (typeof args[tKey] === 'object' && args[tKey] !== null) {\r\n              Object.keys(args[tKey]).forEach(function (sKey) {\r\n                i[tKey][sKey] = args[tKey][sKey];\r\n              });\r\n            }\r\n          } else {\r\n            i[tKey] = args[tKey];\r\n          }\r\n        });\r\n        return;\r\n      }\r\n      // all others are attribute level keys\r\n      i.attributes[argKey] = args[argKey];\r\n    });\r\n    if (args.data) {\r\n      i.data = args.data;\r\n    }\r\n    // add to the dom very last to avoid redraws\r\n    if (args.parentNode) {\r\n      args.parentNode.appendChild(i);\r\n    }\r\n    return i;\r\n  }\r\n  args.component = false;\r\n  i = new Grid(args);\r\n  if (args.parentNode && args.parentNode.appendChild) {\r\n    args.parentNode.appendChild(i);\r\n  }\r\n  return i;\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  /**\r\n   * Converts a integer into a letter A - ZZZZZ...\r\n   * @memberof canvasDatagrid\r\n   * @name integerToAlpha\r\n   * @method\r\n   * @param {column} n The number to convert.\r\n   */\r\n  self.integerToAlpha = function (n) {\r\n    var ordA = 'a'.charCodeAt(0),\r\n      ordZ = 'z'.charCodeAt(0),\r\n      len = ordZ - ordA + 1,\r\n      s = '';\r\n    while (n >= 0) {\r\n      s = String.fromCharCode((n % len) + ordA) + s;\r\n      n = Math.floor(n / len) - 1;\r\n    }\r\n    return s;\r\n  };\r\n  /**\r\n   * Inserts a new column before the specified index into the schema.\r\n   * @tutorial schema\r\n   * @memberof canvasDatagrid\r\n   * @name insertColumn\r\n   * @method\r\n   * @param {column} c The column to insert into the schema.\r\n   * @param {number} index The index of the column to insert before.\r\n   */\r\n  self.insertColumn = function (c, index) {\r\n    var s = self.getSchema();\r\n    if (s.length < index) {\r\n      throw new Error('Index is beyond the length of the schema.');\r\n    }\r\n    self.validateColumn(c, s);\r\n    s.splice(index, 0, c);\r\n\r\n    self.originalData.forEach(function (row, rowIndex) {\r\n      self.applyDefaultValue(row, c, rowIndex);\r\n    });\r\n    self.intf.schema = s;\r\n\r\n    self.refresh();\r\n  };\r\n  /**\r\n   * Deletes a column from the schema at the specified index.\r\n   * @memberof canvasDatagrid\r\n   * @name deleteColumn\r\n   * @tutorial schema\r\n   * @method\r\n   * @param {number} index The index of the column to delete.\r\n   */\r\n  self.deleteColumn = function (index) {\r\n    var schema = self.getSchema();\r\n\r\n    // remove data matching this column name from data\r\n    self.originalData.forEach(function (row) {\r\n      delete row[schema[index].name];\r\n    });\r\n\r\n    schema.splice(index, 1);\r\n    self.intf.schema = schema;\r\n\r\n    self.refresh();\r\n  };\r\n  /**\r\n   * Adds a new column into the schema.\r\n   * @tutorial schema\r\n   * @memberof canvasDatagrid\r\n   * @name addColumn\r\n   * @method\r\n   * @param {column} c The column to add to the schema.\r\n   */\r\n  self.addColumn = function (c) {\r\n    var s = self.getSchema();\r\n    self.validateColumn(c, s);\r\n    s.push(c);\r\n    self.originalData.forEach(function (row, rowIndex) {\r\n      self.applyDefaultValue(row, c, rowIndex);\r\n    });\r\n    self.intf.schema = s;\r\n\r\n    self.refresh();\r\n  };\r\n  /**\r\n   * Deletes a row from the dataset at the specified index.\r\n   * @memberof canvasDatagrid\r\n   * @name deleteRow\r\n   * @method\r\n   * @param {number} index The index of the row to delete.\r\n   */\r\n  self.deleteRow = function (index) {\r\n    self.originalData.splice(index, 1);\r\n    self.setFilter();\r\n    self.resize(true);\r\n  };\r\n  /**\r\n   * Inserts a new row into the dataset before the specified index.\r\n   * @memberof canvasDatagrid\r\n   * @name insertRow\r\n   * @method\r\n   * @param {object} d data.\r\n   * @param {number} index The index of the row to insert before.\r\n   */\r\n  self.insertRow = function (d, index) {\r\n    if (self.originalData.length < index) {\r\n      throw new Error('Index is beyond the length of the dataset.');\r\n    }\r\n    self.originalData.splice(index, 0, d);\r\n    self.getSchema().forEach(function (c) {\r\n      if (d[c.name] === undefined) {\r\n        self.applyDefaultValue(self.originalData[index], c, index);\r\n      }\r\n    });\r\n\r\n    // setFilter calls .refresh(), so we need not call it again:\r\n    self.setFilter();\r\n\r\n    self.resize(true);\r\n  };\r\n  /**\r\n   * Adds a new row into the dataset.\r\n   * @memberof canvasDatagrid\r\n   * @name addRow\r\n   * @method\r\n   * @param {object} d data.\r\n   */\r\n  self.addRow = function (d) {\r\n    self.originalData.push(d);\r\n    self.getSchema().forEach(function (c) {\r\n      if (d[c.name] === undefined) {\r\n        self.applyDefaultValue(\r\n          self.originalData[self.originalData.length - 1],\r\n          c,\r\n          self.originalData.length - 1,\r\n        );\r\n      }\r\n    });\r\n\r\n    // setFilter calls .refresh(), so we need not call it again:\r\n    self.setFilter();\r\n\r\n    self.resize(true);\r\n  };\r\n  /**\r\n   * Sets the height of a given row by index number.\r\n   * @memberof canvasDatagrid\r\n   * @name setRowHeight\r\n   * @method\r\n   * @param {number} rowIndex The index of the row to set.\r\n   * @param {number} height Height to set the row to.\r\n   */\r\n  self.setRowHeight = function (rowIndex, height) {\r\n    self.sizes.rows[rowIndex] = height;\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Sets the width of a given column by index number.\r\n   * @memberof canvasDatagrid\r\n   * @name setColumnWidth\r\n   * @method\r\n   * @param {number} colIndex The index of the column to set.\r\n   * @param {number} width Width to set the column to.\r\n   */\r\n  self.setColumnWidth = function (colIndex, width) {\r\n    self.sizes.columns[colIndex] = width;\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Removes any changes to the width of the columns due to user or api interaction, setting them back to the schema or style default.\r\n   * @memberof canvasDatagrid\r\n   * @name resetColumnWidths\r\n   * @tutorial schema\r\n   * @method\r\n   */\r\n  self.resetColumnWidths = function () {\r\n    self.sizes.columns = {};\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Removes any changes to the height of the rows due to user or api interaction, setting them back to the schema or style default.\r\n   * @memberof canvasDatagrid\r\n   * @name resetRowHeights\r\n   * @tutorial schema\r\n   * @method\r\n   */\r\n  self.resetRowHeights = function () {\r\n    self.sizes.rows = {};\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Sets the value of the filter.\r\n   * @memberof canvasDatagrid\r\n   * @name setFilter\r\n   * @method\r\n   * @param {string} column Name of the column to filter.\r\n   * @param {string} value The value to filter for.\r\n   */\r\n  self.setFilter = function (column, value) {\r\n    if (column === undefined && value === undefined) {\r\n      self.columnFilters = {};\r\n    } else if (column && (value === '' || value === undefined)) {\r\n      delete self.columnFilters[column];\r\n    } else {\r\n      self.columnFilters[column] = value;\r\n      if (self.attributes.showFilterInCell) {\r\n        self.filterable.rows.push(0);\r\n        self.orders.columns.forEach(function (value, index) {\r\n          self.filterable.columns.push(index);\r\n        });\r\n      }\r\n    }\r\n    if (!Object.keys(self.columnFilters).length) {\r\n      self.filterable = {\r\n        rows: [],\r\n        columns: [],\r\n      };\r\n    }\r\n    self.refresh();\r\n  };\r\n  /**\r\n   * Returns the number of pixels to scroll down to line up with row rowIndex.\r\n   * @memberof canvasDatagrid\r\n   * @name findRowScrollTop\r\n   * @method\r\n   * @param {number} rowIndex The row index of the row to scroll find.\r\n   */\r\n  self.findRowScrollTop = function (rowIndex) {\r\n    if (self.scrollCache.y[rowIndex] === undefined) {\r\n      throw new RangeError(\r\n        `Row index ${rowIndex} out of range: ${self.scrollCache.y.length}.`,\r\n      );\r\n    }\r\n    return self.scrollCache.y[rowIndex];\r\n  };\r\n  /**\r\n   * Returns the number of pixels to scroll to the left to line up with column columnIndex.\r\n   * @memberof canvasDatagrid\r\n   * @name findColumnScrollLeft\r\n   * @method\r\n   * @param {number} columnIndex The column index of the column to find.\r\n   */\r\n  self.findColumnScrollLeft = function (columnIndex) {\r\n    var i = Math.max(columnIndex - 1, 0);\r\n    if (self.scrollCache.x[i] === undefined) {\r\n      throw new Error('Column index out of range.');\r\n    }\r\n    return (\r\n      self.scrollCache.x[i] -\r\n      self.getColumnWidth(self.orders.columns[columnIndex])\r\n    );\r\n  };\r\n  /**\r\n   * Scrolls to the cell at columnIndex x, and rowIndex y.  If you define both rowIndex and columnIndex additional calculations can be made to center the cell using the target cell's height and width.  Defining only one rowIndex or only columnIndex will result in simpler calculations.\r\n   * @memberof canvasDatagrid\r\n   * @name gotoCell\r\n   * @method\r\n   * @param {number} x The column index of the cell to scroll to.\r\n   * @param {number} y The row index of the cell to scroll to.\r\n   * @param {number} [offsetX=0] Percentage offset the cell should be from the left edge (not including headers).  The default is 0, meaning the cell will appear at the left edge. Valid values are 0 through 1. 1 = Left, 0 = Right, 0.5 = Center.\r\n   * @param {number} [offsetY=0] Percentage offset the cell should be from the top edge (not including headers).  The default is 0, meaning the cell will appear at the top edge. Valid values are 0 through 1. 1 = Bottom, 0 = Top, 0.5 = Center.\r\n   */\r\n  self.gotoCell = function (x, y, offsetX, offsetY) {\r\n    var targetX = x === undefined ? undefined : self.findColumnScrollLeft(x),\r\n      targetY = y === undefined ? undefined : self.findRowScrollTop(y),\r\n      cell,\r\n      sbw =\r\n        self.scrollBox.width -\r\n        (self.scrollBox.verticalBarVisible ? self.style.scrollBarWidth : 0),\r\n      sbh =\r\n        self.scrollBox.height -\r\n        (self.scrollBox.horizontalBarVisible ? self.style.scrollBarWidth : 0);\r\n    offsetX = offsetX === undefined ? 0 : offsetX;\r\n    offsetY = offsetY === undefined ? 0 : offsetY;\r\n    targetX -= sbw * offsetX;\r\n    targetY -= sbh * offsetY;\r\n    if (x !== undefined && y !== undefined) {\r\n      self.scrollBox.scrollTo(targetX, targetY);\r\n      requestAnimationFrame(function () {\r\n        cell = self.getVisibleCellByIndex(x, y);\r\n        // HACK: just don't offset if the target cell cannot be seen\r\n        // TODO: offset does not work on very small grids, not sure why\r\n        if (!cell) {\r\n          return;\r\n        }\r\n        targetX += cell.width * offsetX;\r\n        targetY += cell.height * offsetY;\r\n        self.scrollBox.scrollTo(targetX, targetY);\r\n      });\r\n    } else if (x !== undefined) {\r\n      self.scrollBox.scrollLeft = targetX;\r\n    } else if (y !== undefined) {\r\n      self.scrollBox.scrollTop = targetY;\r\n    }\r\n  };\r\n  /**\r\n   * Scrolls the row y.\r\n   * @memberof canvasDatagrid\r\n   * @name gotoRow\r\n   * @method\r\n   * @param {number} y The row index of the cell to scroll to.\r\n   */\r\n  self.gotoRow = function (y) {\r\n    self.gotoCell(0, y);\r\n  };\r\n  /**\r\n   * Add a button into the cell.\r\n   * @memberof canvasDatagrid\r\n   * @name addButton\r\n   * @method\r\n   * @param {number} columnIndex The column index of the cell to to add a button.\r\n   * @param {number} rowIndex The row index of the cell to to add a button.\r\n   * @param {object} offset Offset how far go away from cell.\r\n   * @param {object} items a list of items to add into button menu.\r\n   * @param {string} imgSrc icon path to add into button.\r\n   */\r\n  self.addButton = function (columnIndex, rowIndex, offset, items, imgSrc) {\r\n    var cells = self.visibleCells.filter(function (c) {\r\n      return c.sortColumnIndex === columnIndex && c.sortRowIndex === rowIndex;\r\n    });\r\n\r\n    self.attachButton(\r\n      {\r\n        top: cells[0].y + cells[0].height + offset.y,\r\n        left: cells[0].x + cells[0].width + offset.x,\r\n      },\r\n      items,\r\n      imgSrc,\r\n    );\r\n  };\r\n  /**\r\n   * Scrolls the cell at cell x, row y into view if it is not already.\r\n   * @memberof canvasDatagrid\r\n   * @name scrollIntoView\r\n   * @method\r\n   * @param {number} x The column index of the cell to scroll into view.\r\n   * @param {number} y The row index of the cell to scroll into view.\r\n   * @param {number} [offsetX=0] Percentage offset the cell should be from the left edge (not including headers).  The default is 0, meaning the cell will appear at the left edge. Valid values are 0 through 1. 1 = Left, 0 = Right, 0.5 = Center.\r\n   * @param {number} [offsetY=0] Percentage offset the cell should be from the top edge (not including headers).  The default is 0, meaning the cell will appear at the top edge. Valid values are 0 through 1. 1 = Bottom, 0 = Top, 0.5 = Center.\r\n   */\r\n  self.scrollIntoView = function (x, y, offsetX, offsetY) {\r\n    if (\r\n      self.visibleCells.filter(function (cell) {\r\n        return (\r\n          (cell.rowIndex === y || y === undefined) &&\r\n          (cell.columnIndex === x || x === undefined) &&\r\n          cell.x > 0 &&\r\n          cell.y > 0 &&\r\n          cell.x + cell.width < self.width &&\r\n          cell.y + cell.height < self.height\r\n        );\r\n      }).length === 0\r\n    ) {\r\n      self.gotoCell(x, y, offsetX, offsetY);\r\n    }\r\n  };\r\n  /**\r\n   * Sets the active cell. Requires redrawing.\r\n   * @memberof canvasDatagrid\r\n   * @name setActiveCell\r\n   * @method\r\n   * @param {number} x The column index of the cell to set active.\r\n   * @param {number} y The row index of the cell to set active.\r\n   */\r\n  self.setActiveCell = function (x, y) {\r\n    if (x < 0) {\r\n      x = 0;\r\n    }\r\n    if (y < 0) {\r\n      y = 0;\r\n    }\r\n    self.activeCell = {\r\n      rowIndex: y,\r\n      columnIndex: x,\r\n    };\r\n  };\r\n  /**\r\n   * Removes the selection.\r\n   * @memberof canvasDatagrid\r\n   * @name selectNone\r\n   * @param {boolean} dontDraw Suppress the draw method after the selection change.\r\n   * @method\r\n   */\r\n  self.selectNone = function (dontDraw) {\r\n    self.selections = [];\r\n    self.dispatchEvent('selectionchanged', {\r\n      selectedData: self.getSelectedData(),\r\n      selections: self.selections,\r\n      selectionBounds: self.selectionBounds,\r\n      selectedCells: self.getSelectedCells(),\r\n    });\r\n    if (dontDraw) {\r\n      return;\r\n    }\r\n    self.draw();\r\n  };\r\n  /**\r\n   * Selects every visible cell.\r\n   * @memberof canvasDatagrid\r\n   * @name selectAll\r\n   * @param {boolean} dontDraw Suppress the draw method after the selection change.\r\n   * @method\r\n   */\r\n  self.selectAll = function (dontDraw) {\r\n    self.selectArea({\r\n      top: 0,\r\n      left: -1,\r\n      right: self.getSchema().length - 1,\r\n      bottom: self.viewData.length - 1,\r\n    });\r\n    if (dontDraw) {\r\n      return;\r\n    }\r\n    self.draw();\r\n  };\r\n  /**\r\n   * Returns true if indices of columns next to the selected columnIndex is selected on every row.\r\n   * @memberof canvasDatagrid\r\n   * @name isMultiColumnsSelected\r\n   * @method\r\n   * @param {number} columnIndex The column index to check.\r\n   */\r\n  self.isMultiColumnsSelected = function (columnIndex) {\r\n    var multiColIsSelected = true;\r\n    self.viewData.forEach(function (row, rowIndex) {\r\n      var columnIndices = self.selections[rowIndex];\r\n      if (\r\n        !columnIndices ||\r\n        columnIndices.length <= 1 ||\r\n        columnIndices.indexOf(columnIndex) === -1\r\n      ) {\r\n        multiColIsSelected = false;\r\n      } else if (columnIndices.length > 1) {\r\n        if (columnIndices[0] != columnIndex) multiColIsSelected = false;\r\n        else {\r\n          for (var i = 0; i < columnIndices.length - 1; i++) {\r\n            if (columnIndices[i] + 1 != columnIndices[i + 1]) {\r\n              multiColIsSelected = false;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    });\r\n    return multiColIsSelected;\r\n  };\r\n  /**\r\n   * Returns true if the selected columnIndex is selected on every row.\r\n   * @memberof canvasDatagrid\r\n   * @name isColumnSelected\r\n   * @method\r\n   * @param {number} columnIndex The column index to check.\r\n   */\r\n  self.isColumnSelected = function (columnIndex) {\r\n    var colIsSelected = true;\r\n    self.viewData.forEach(function (row, rowIndex) {\r\n      if (\r\n        !self.selections[rowIndex] ||\r\n        self.selections[rowIndex].indexOf(columnIndex) === -1\r\n      ) {\r\n        colIsSelected = false;\r\n      }\r\n    });\r\n    return colIsSelected;\r\n  };\r\n  /**\r\n   * Runs the defined method on each selected cell.\r\n   * @memberof canvasDatagrid\r\n   * @name forEachSelectedCell\r\n   * @method\r\n   * @param {number} fn The function to execute.  The signature of the function is: (data, rowIndex, columnName).\r\n   * @param {number} expandToRow When true the data in the array is expanded to the entire row.\r\n   */\r\n  self.forEachSelectedCell = function (fn, expandToRow) {\r\n    var d = [],\r\n      s = expandToRow ? self.getSchema() : self.getVisibleSchema(),\r\n      l = self.viewData.length;\r\n    self.selections.forEach(function (row, index) {\r\n      if (index === l) {\r\n        return;\r\n      }\r\n      if (row.length === 0) {\r\n        d[index] = null;\r\n        return;\r\n      }\r\n      d[index] = {};\r\n      row.forEach(function (col) {\r\n        if (col === -1 || !s[col]) {\r\n          return;\r\n        }\r\n        fn(self.viewData, index, s[col].name);\r\n      });\r\n    });\r\n  };\r\n  /**\r\n   * Selects a column.\r\n   * @memberof canvasDatagrid\r\n   * @name selectColumn\r\n   * @method\r\n   * @param {number} columnIndex The column index to select.\r\n   * @param {boolean} toggleSelectMode When true, behaves as if you were holding control/command when you clicked the column.\r\n   * @param {boolean} shift When true, behaves as if you were holding shift when you clicked the column.\r\n   * @param {boolean} supressSelectionchangedEvent When true, prevents the selectionchanged event from firing.\r\n   */\r\n  self.selectColumn = function (columnIndex, ctrl, shift, supressEvent) {\r\n    var s, e, x;\r\n    function addCol(i) {\r\n      self.viewData.forEach(function (row, rowIndex) {\r\n        self.selections[rowIndex] = self.selections[rowIndex] || [];\r\n        if (self.selections[rowIndex].indexOf(i) === -1) {\r\n          self.selections[rowIndex].push(i);\r\n        }\r\n      });\r\n    }\r\n    function removeCol(i) {\r\n      self.viewData.forEach(function (row, rowIndex) {\r\n        self.selections[rowIndex] = self.selections[rowIndex] || [];\r\n        if (self.selections[rowIndex].indexOf(i) !== -1) {\r\n          self.selections[rowIndex].splice(\r\n            self.selections[rowIndex].indexOf(i),\r\n            1,\r\n          );\r\n        }\r\n      });\r\n    }\r\n    if (shift) {\r\n      if (!self.activeCell) {\r\n        return;\r\n      }\r\n      s = Math.min(self.activeCell.columnIndex, columnIndex);\r\n      e = Math.max(self.activeCell.columnIndex, columnIndex);\r\n      for (x = s; e > x; x += 1) {\r\n        addCol(x);\r\n      }\r\n    }\r\n    if (!ctrl && !shift) {\r\n      self.selections = [];\r\n      self.activeCell.columnIndex = columnIndex;\r\n      self.activeCell.rowIndex = self.scrollIndexTop;\r\n    }\r\n    if (ctrl && self.isColumnSelected(columnIndex)) {\r\n      removeCol(columnIndex);\r\n    } else {\r\n      addCol(columnIndex);\r\n    }\r\n    if (supressEvent) {\r\n      return;\r\n    }\r\n    self.dispatchEvent('selectionchanged', {\r\n      selectedData: self.getSelectedData(),\r\n      selections: self.selections,\r\n      selectionBounds: self.getSelectionBounds(),\r\n      selectedCells: self.getSelectedCells(),\r\n    });\r\n  };\r\n  /**\r\n   * Selects a row.\r\n   * @memberof canvasDatagrid\r\n   * @name selectRow\r\n   * @method\r\n   * @param {number} rowIndex The row index to select.\r\n   * @param {boolean} ctrl When true, behaves as if you were holding control/command when you clicked the row.\r\n   * @param {boolean} shift When true, behaves as if you were holding shift when you clicked the row.\r\n   * @param {boolean} supressSelectionchangedEvent When true, prevents the selectionchanged event from firing.\r\n   */\r\n  self.selectRow = function (rowIndex, ctrl, shift, supressEvent) {\r\n    var x,\r\n      st,\r\n      en,\r\n      s = self.getVisibleSchema();\r\n    self.isMultiRowsSelected = false;\r\n    function de() {\r\n      if (supressEvent) {\r\n        return;\r\n      }\r\n      self.dispatchEvent('selectionchanged', {\r\n        selectedData: self.getSelectedData(),\r\n        selections: self.selections,\r\n        selectionBounds: self.selectionBounds,\r\n        selectedCells: self.getSelectedCells(),\r\n      });\r\n    }\r\n    function addRow(ri) {\r\n      self.selections[ri] = [];\r\n      self.selections[ri].push(-1);\r\n      s.forEach(function (col, index) {\r\n        self.selections[ri].push(self.orders.columns.indexOf(col.index));\r\n      });\r\n    }\r\n    if (self.dragAddToSelection === false || self.dragObject === undefined) {\r\n      if (\r\n        self.selections[rowIndex] &&\r\n        self.selections[rowIndex].length - 1 === s.length\r\n      ) {\r\n        if (ctrl) {\r\n          self.selections[rowIndex] = [];\r\n          de();\r\n          return;\r\n        }\r\n      }\r\n    }\r\n    if (self.dragAddToSelection === true || self.dragObject === undefined) {\r\n      if (shift && self.dragObject === undefined) {\r\n        if (!self.activeCell) {\r\n          return;\r\n        }\r\n        st = Math.min(self.activeCell.rowIndex, rowIndex);\r\n        en = Math.max(self.activeCell.rowIndex, rowIndex);\r\n        for (x = st; en >= x; x += 1) {\r\n          addRow(x);\r\n        }\r\n      } else {\r\n        addRow(rowIndex);\r\n      }\r\n    }\r\n    de();\r\n  };\r\n  /**\r\n   * Collapse a tree grid by row index.\r\n   * @memberof canvasDatagrid\r\n   * @name collapseTree\r\n   * @method\r\n   * @param {number} index The index of the row to collapse.\r\n   */\r\n  self.collapseTree = function (rowIndex) {\r\n    self.dispatchEvent('collapsetree', {\r\n      childGrid: self.childGrids[rowIndex],\r\n      data: self.viewData[rowIndex],\r\n      rowIndex: rowIndex,\r\n    });\r\n    self.openChildren[rowIndex].blur();\r\n    self.openChildren[rowIndex].dispose();\r\n    delete self.openChildren[rowIndex];\r\n    delete self.sizes.trees[rowIndex];\r\n    delete self.childGrids[rowIndex];\r\n    self.dispatchEvent('resizerow', {\r\n      cellHeight: self.style.cellHeight,\r\n    });\r\n    self.resize(true);\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Expands a tree grid by row index.\r\n   * @memberof canvasDatagrid\r\n   * @name expandTree\r\n   * @method\r\n   * @param {number} index The index of the row to expand.\r\n   */\r\n  self.expandTree = function (rowIndex) {\r\n    var trArgs = self.args.treeGridAttributes || {},\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight(),\r\n      rowHeaderCellWidth =\r\n        self.sizes.columns.cornerCell || self.style.rowHeaderCellWidth,\r\n      h = self.sizes.trees[rowIndex] || self.style.treeGridHeight,\r\n      treeGrid;\r\n    if (!self.childGrids[rowIndex]) {\r\n      trArgs.debug = self.attributes.debug;\r\n      trArgs.name = self.attributes.saveAppearance\r\n        ? self.attributes.name + 'tree' + rowIndex\r\n        : undefined;\r\n      trArgs.style = trArgs.style || self.style;\r\n      trArgs.parentNode = {\r\n        parentGrid: self.intf,\r\n        nodeType: 'canvas-datagrid-tree',\r\n        offsetHeight: h,\r\n        offsetWidth: self.width - rowHeaderCellWidth,\r\n        header: { width: self.width - rowHeaderCellWidth },\r\n        offsetLeft: rowHeaderCellWidth,\r\n        offsetTop: columnHeaderCellHeight,\r\n        offsetParent: self.intf.parentNode,\r\n        parentNode: self.intf.parentNode,\r\n        style: 'tree',\r\n        data: self.viewData[rowIndex],\r\n      };\r\n      treeGrid = self.createGrid(trArgs);\r\n      self.childGrids[rowIndex] = treeGrid;\r\n    }\r\n    treeGrid = self.childGrids[rowIndex];\r\n    treeGrid.visible = true;\r\n    self.dispatchEvent('expandtree', {\r\n      treeGrid: treeGrid,\r\n      data: self.viewData[rowIndex],\r\n      rowIndex: rowIndex,\r\n    });\r\n    self.openChildren[rowIndex] = treeGrid;\r\n    self.sizes.trees[rowIndex] = h;\r\n    self.dispatchEvent('resizerow', { height: self.style.cellHeight });\r\n    self.resize(true);\r\n  };\r\n  /**\r\n   * Toggles tree grid open and close by row index.\r\n   * @memberof canvasDatagrid\r\n   * @name toggleTree\r\n   * @method\r\n   * @param {number} index The index of the row to toggle.\r\n   */\r\n  self.toggleTree = function (rowIndex) {\r\n    var i = self.openChildren[rowIndex];\r\n    if (i) {\r\n      return self.collapseTree(rowIndex);\r\n    }\r\n    self.expandTree(rowIndex);\r\n  };\r\n  /**\r\n   * Returns a header from the schema by name.\r\n   * @memberof canvasDatagrid\r\n   * @name getHeaderByName\r\n   * @tutorial schema\r\n   * @method\r\n   * @returns {header} header with the selected name, or undefined.\r\n   * @param {string} name The name of the column to resize.\r\n   */\r\n  self.getHeaderByName = function (name) {\r\n    var x,\r\n      i = self.getSchema();\r\n    for (x = 0; x < i.length; x += 1) {\r\n      if (i[x].name === name) {\r\n        return i[x];\r\n      }\r\n    }\r\n  };\r\n  /**\r\n   * Resizes a column to fit the longest value in the column. Call without a value to resize all columns.\r\n   * Warning, can be slow on very large record sets (1m records ~3-5 seconds on an i7).\r\n   * @memberof canvasDatagrid\r\n   * @name fitColumnToValues\r\n   * @method\r\n   * @param {string} name The name of the column to resize.\r\n   */\r\n  self.fitColumnToValues = function (name, internal) {\r\n    if (!self.canvas) {\r\n      return;\r\n    }\r\n\r\n    const columnIndex =\r\n      name === 'cornerCell' ? -1 : self.getHeaderByName(name).index;\r\n\r\n    const newSize = Math.max(\r\n      self.findColumnMaxTextLength(name),\r\n      self.style.minColumnWidth,\r\n    );\r\n\r\n    self.sizes.columns[columnIndex] = newSize;\r\n\r\n    self.dispatchEvent('resizecolumn', {\r\n      x: newSize,\r\n      y: self.resizingStartingHeight,\r\n      draggingItem: self.currentCell,\r\n    });\r\n\r\n    if (!internal) {\r\n      self.resize();\r\n      self.draw(true);\r\n    }\r\n  };\r\n  /**\r\n   * Checks if a cell is currently visible.\r\n   * @memberof canvasDatagrid\r\n   * @name isCellVisible\r\n   * @overload\r\n   * @method\r\n   * @returns {boolean} when true, the cell is visible, when false the cell is not currently drawn.\r\n   * @param {number} columnIndex The column index of the cell to check.\r\n   * @param {number} rowIndex The row index of the cell to check.\r\n   */\r\n  self.isCellVisible = function (cell, rowIndex) {\r\n    // overload\r\n    if (rowIndex !== undefined) {\r\n      return (\r\n        self.visibleCells.filter(function (c) {\r\n          return c.columnIndex === cell && c.rowIndex === rowIndex;\r\n        }).length > 0\r\n      );\r\n    }\r\n    var x,\r\n      l = self.visibleCells.length;\r\n    for (x = 0; x < l; x += 1) {\r\n      if (\r\n        cell.x === self.visibleCells[x].x &&\r\n        cell.y === self.visibleCells[x].y\r\n      ) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n  /**\r\n   * Sets the order of the data.\r\n   * @memberof canvasDatagrid\r\n   * @name order\r\n   * @method\r\n   * @param {number} columnName Name of the column to be sorted.\r\n   * @param {string} direction `asc` for ascending or `desc` for descending.\r\n   * @param {function} [sortFunction] When defined, override the default sorting method defined in the column's schema and use this one.\r\n   * @param {bool} [dontSetStorageData] Don't store this setting for future use.\r\n   */\r\n  self.order = function (\r\n    columnName,\r\n    direction,\r\n    sortFunction,\r\n    dontSetStorageData,\r\n  ) {\r\n    var f,\r\n      c = self.getSchema().filter(function (col) {\r\n        return col.name === columnName;\r\n      });\r\n    if (\r\n      self.dispatchEvent('beforesortcolumn', {\r\n        name: columnName,\r\n        direction: direction,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    self.orderBy = columnName;\r\n    self.orderDirection = direction;\r\n    if (!self.viewData || self.viewData.length === 0) {\r\n      return;\r\n    }\r\n    if (c.length === 0) {\r\n      throw new Error('Cannot sort.  No such column name');\r\n    }\r\n    f = sortFunction || c[0].sorter || self.sorters[c[0].type];\r\n    if (!f && c[0].type !== undefined) {\r\n      console.warn(\r\n        'Cannot sort type \"%s\" falling back to string sort.',\r\n        c[0].type,\r\n      );\r\n    }\r\n    self.orderings.add(\r\n      columnName,\r\n      direction,\r\n      typeof f === 'function' ? f : self.sorters.string,\r\n    );\r\n    self.refresh();\r\n    self.dispatchEvent('sortcolumn', {\r\n      name: columnName,\r\n      direction: direction,\r\n    });\r\n\r\n    if (dontSetStorageData) {\r\n      return;\r\n    }\r\n    self.setStorageData();\r\n  };\r\n  self.isInGrid = function (e) {\r\n    if (e.x < 0 || e.x > self.width || e.y < 0 || e.y > self.height) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  /**\r\n   * Moves the current selection relative to the its current position.  Note: this method does not move the selected data, just the selection itself.\r\n   * @memberof canvasDatagrid\r\n   * @name moveSelection\r\n   * @method\r\n   * @param {number} offsetX The number of columns to offset the selection.\r\n   * @param {number} offsetY The number of rows to offset the selection.\r\n   */\r\n  self.moveSelection = function (offsetX, offsetY) {\r\n    var sel = [];\r\n    self.selections.forEach(function (row, rowIndex) {\r\n      sel[rowIndex + offsetY] = [];\r\n      row.forEach(function (colIndex) {\r\n        sel[rowIndex + offsetY].push(colIndex + offsetX);\r\n      });\r\n    });\r\n    self.selections = sel;\r\n  };\r\n  /**\r\n   * Deletes currently selected data.\r\n   * @memberof canvasDatagrid\r\n   * @name deleteSelectedData\r\n   * @method\r\n   * @param {boolean} dontDraw Suppress the draw method after the selection change.\r\n   */\r\n  self.deleteSelectedData = function (dontDraw) {\r\n    const affectedCells = self.clearSelectedCells();\r\n\r\n    self.dispatchEvent('afterdelete', {\r\n      cells: affectedCells,\r\n    });\r\n\r\n    if (dontDraw) {\r\n      return;\r\n    }\r\n\r\n    requestAnimationFrame(() => self.draw());\r\n  };\r\n  /**\r\n   * Moves data in the provided selection to another position in the grid.  Moving data off the edge of the schema (columns/x) will truncate data.\r\n   * @memberof canvasDatagrid\r\n   * @name moveTo\r\n   * @method\r\n   * @param {array} sel 2D array representing selected rows and columns.  `canvasDatagrid.selections` is in this format and can be used here.\r\n   * @param {number} x The column index to start inserting the selection at.\r\n   * @param {number} y The row index to start inserting the selection at.\r\n   */\r\n  self.moveTo = function (sel, x, y) {\r\n    var selectedData = self.getSelectedData(),\r\n      visibleSchema = self.getVisibleSchema(),\r\n      selectionLength = sel.length,\r\n      xi,\r\n      maxRowLength = -Infinity,\r\n      minXi = Infinity,\r\n      yi = y - 1;\r\n\r\n    sel.forEach(function (row, rowIndex) {\r\n      if (rowIndex === selectionLength) {\r\n        return;\r\n      }\r\n      if (row.length === 0) {\r\n        return;\r\n      }\r\n      minXi = Math.min(self.getVisibleColumnIndexOf(x), minXi);\r\n      maxRowLength = Math.max(maxRowLength, row.length);\r\n      row.forEach(function (colIndex) {\r\n        // intentional redef of colIndex\r\n        colIndex = self.getVisibleColumnIndexOf(colIndex);\r\n        if (!visibleSchema[colIndex]) {\r\n          return;\r\n        }\r\n        // TODO:\r\n        if (!self.data[rowIndex]) {\r\n          self.data[rowIndex] = {};\r\n        }\r\n        // TODO:\r\n        self.data[rowIndex][visibleSchema[colIndex].name] = null;\r\n      });\r\n    });\r\n\r\n    sel.forEach(function (row, index) {\r\n      var lastSourceIndex;\r\n      yi += 1;\r\n      xi = self.getVisibleColumnIndexOf(x);\r\n      row.forEach(function (colIndex, cidx) {\r\n        colIndex = self.getVisibleColumnIndexOf(colIndex);\r\n        if (cidx > 0) {\r\n          // this confusing bit of nonsense figures out\r\n          // if the selection has skipped cells\r\n          xi += colIndex - lastSourceIndex;\r\n        }\r\n        lastSourceIndex = colIndex;\r\n        if (\r\n          colIndex === -1 ||\r\n          !visibleSchema[xi] ||\r\n          !visibleSchema[colIndex] ||\r\n          // TODO:\r\n          self.data.length - 1 < yi ||\r\n          yi < 0\r\n        ) {\r\n          return;\r\n        }\r\n        // TODO:\r\n        if (!self.data[yi]) {\r\n          self.data[yi] = {};\r\n        }\r\n        // TODO:\r\n        self.data[yi][visibleSchema[xi].name] =\r\n          selectedData[index][visibleSchema[colIndex].name];\r\n      });\r\n    });\r\n  };\r\n  /**\r\n   * Checks if a given column is visible.\r\n   * @memberof canvasDatagrid\r\n   * @name isColumnVisible\r\n   * @method\r\n   * @returns {boolean} When true, the column is visible.\r\n   * @param {number} columnIndex Column index.\r\n   */\r\n  self.isColumnVisible = function (columnIndex) {\r\n    return (\r\n      self.visibleCells.filter(function (c) {\r\n        return c.columnIndex === columnIndex;\r\n      }).length > 0\r\n    );\r\n  };\r\n  /**\r\n   * Checks if a given row is visible.\r\n   * @memberof canvasDatagrid\r\n   * @name isRowVisible\r\n   * @method\r\n   * @returns {boolean} When true, the row is visible.\r\n   * @param {number} rowIndex Row index.\r\n   */\r\n  self.isRowVisible = function (rowIndex) {\r\n    return (\r\n      self.visibleCells.filter(function (c) {\r\n        return c.rowIndex === rowIndex;\r\n      }).length > 0\r\n    );\r\n  };\r\n  /**\r\n   * Gets the cell at columnIndex and rowIndex.\r\n   * @memberof canvasDatagrid\r\n   * @name getVisibleCellByIndex\r\n   * @method\r\n   * @returns {cell} cell at the selected location.\r\n   * @param {number} x Column index.\r\n   * @param {number} y Row index.\r\n   */\r\n  self.getVisibleCellByIndex = function (x, y) {\r\n    return self.visibleCells.filter(function (c) {\r\n      return c.columnIndex === x && c.rowIndex === y;\r\n    })[0];\r\n  };\r\n  /**\r\n   * Gets the cell at grid pixel coordinate x and y.  Author's note.  This function ties drawing and events together.  This is a very complex function and is core to the component.\r\n   * @memberof canvasDatagrid\r\n   * @name getCellAt\r\n   * @method\r\n   * @returns {cell} cell at the selected location.\r\n   * @param {number} x Number of pixels from the left.\r\n   * @param {number} y Number of pixels from the top.\r\n   */\r\n  self.getCellAt = function (x, y, useTouchScrollZones) {\r\n    function getBorder(entitiy) {\r\n      if (\r\n        entitiy.x + entitiy.width - self.attributes.borderResizeZone * 0.4 <\r\n          x &&\r\n        entitiy.x + entitiy.width + self.attributes.borderResizeZone * 0.6 > x\r\n      ) {\r\n        return 'r';\r\n      }\r\n      if (\r\n        entitiy.x - self.attributes.borderResizeZone * 0.4 < x &&\r\n        entitiy.x + self.attributes.borderResizeZone * 0.6 > x\r\n      ) {\r\n        return 'l';\r\n      }\r\n      if (\r\n        entitiy.y + entitiy.height - self.attributes.borderResizeZone * 0.4 <\r\n          y &&\r\n        entitiy.y + entitiy.height + self.attributes.borderResizeZone * 0.6 > y\r\n      ) {\r\n        return 'b';\r\n      }\r\n      if (\r\n        entitiy.y - self.attributes.borderResizeZone * 0.4 < y &&\r\n        entitiy.y + self.attributes.borderResizeZone * 0.6 > y\r\n      ) {\r\n        return 't';\r\n      }\r\n    }\r\n    if (!self.visibleCells) {\r\n      return;\r\n    }\r\n    var border,\r\n      tsz = useTouchScrollZones ? self.attributes.touchScrollZone : 0,\r\n      moveMode = self.attributes.borderDragBehavior === 'move',\r\n      i,\r\n      l = self.visibleCells.length,\r\n      moveBorder,\r\n      xBorderBehavior = moveMode ? self.cursorGrab : 'ew-resize',\r\n      yBorderBehavior = moveMode ? self.cursorGrab : 'ns-resize',\r\n      cell,\r\n      entitiy;\r\n    if (!self.visibleCells || !self.visibleCells.length) {\r\n      return;\r\n    }\r\n    self.hasFocus = true;\r\n    if (!(y < self.height && y > 0 && x < self.width && x > 0)) {\r\n      self.hasFocus = false;\r\n      return {\r\n        dragContext: 'inherit',\r\n        context: 'inherit',\r\n      };\r\n    }\r\n    for (i = 0; i < l; i += 1) {\r\n      cell = self.visibleCells[i];\r\n      // interactive dimensions of the cell.  used for touch \"over size\" zones\r\n      entitiy = {\r\n        x: cell.x,\r\n        y: cell.y,\r\n        height: cell.height,\r\n        width: cell.width,\r\n      };\r\n      if (\r\n        useTouchScrollZones &&\r\n        /(vertical|horizontal)-scroll-/.test(cell.style)\r\n      ) {\r\n        entitiy.x -= tsz;\r\n        entitiy.y -= tsz;\r\n        entitiy.height += tsz;\r\n        entitiy.width += tsz;\r\n      }\r\n      if (\r\n        entitiy.x - self.style.cellBorderWidth < x &&\r\n        entitiy.x + entitiy.width + self.style.cellBorderWidth > x &&\r\n        entitiy.y - self.style.cellBorderWidth < y &&\r\n        entitiy.y + entitiy.height + self.style.cellBorderWidth > y\r\n      ) {\r\n        if (/frozen-row-marker/.test(cell.style)) {\r\n          cell.dragContext = cell.style;\r\n          cell.context = 'row-resize';\r\n          return cell;\r\n        }\r\n        if (/frozen-column-marker/.test(cell.style)) {\r\n          cell.dragContext = cell.style;\r\n          cell.context = 'col-resize';\r\n          return cell;\r\n        }\r\n        if (/selection-handle-/.test(cell.style)) {\r\n          cell.dragContext = cell.style;\r\n          cell.context = 'crosshair';\r\n          return cell;\r\n        }\r\n        if (/vertical-scroll-(bar|box)/.test(cell.style)) {\r\n          cell.dragContext = 'vertical-scroll-box';\r\n          cell.context = 'vertical-scroll-box';\r\n          cell.isScrollBar = true;\r\n          cell.isVerticalScrollBar = true;\r\n          if (y > self.scrollBox.box.v.y + self.scrollBox.scrollBoxHeight) {\r\n            cell.dragContext = 'vertical-scroll-bottom';\r\n            cell.context = 'vertical-scroll-bottom';\r\n          } else if (y < self.scrollBox.box.v.y) {\r\n            cell.dragContext = 'vertical-scroll-top';\r\n            cell.context = 'vertical-scroll-top';\r\n          }\r\n          self.cursor = 'default';\r\n          return cell;\r\n        }\r\n        if (/horizontal-scroll-(bar|box)/.test(cell.style)) {\r\n          cell.dragContext = 'horizontal-scroll-box';\r\n          cell.context = 'horizontal-scroll-box';\r\n          cell.isScrollBar = true;\r\n          cell.isHorizontalScrollBar = true;\r\n          if (x > self.scrollBox.box.h.x + self.scrollBox.scrollBoxWidth) {\r\n            cell.dragContext = 'horizontal-scroll-right';\r\n            cell.context = 'horizontal-scroll-right';\r\n          } else if (x < self.scrollBox.box.h.x) {\r\n            cell.dragContext = 'horizontal-scroll-left';\r\n            cell.context = 'horizontal-scroll-left';\r\n          }\r\n          self.cursor = 'default';\r\n          return cell;\r\n        }\r\n        border = getBorder(entitiy);\r\n        // check if the border of this cell is the border of the selection and if so show move cursor in move mode\r\n        moveBorder =\r\n          moveMode &&\r\n          cell.selectionBorder &&\r\n          cell.selectionBorder.indexOf(border) !== -1;\r\n        if (\r\n          ['l', 'r'].indexOf(border) !== -1 &&\r\n          (self.attributes.allowColumnResize || moveBorder) &&\r\n          ((self.attributes.allowColumnResizeFromCell && cell.isNormal) ||\r\n            !cell.isNormal ||\r\n            moveBorder) &&\r\n          ((self.attributes.allowRowHeaderResize &&\r\n            (cell.isRowHeader || cell.isCorner)) ||\r\n            !(cell.isRowHeader && cell.isCorner))\r\n        ) {\r\n          if (\r\n            (cell.isColumnHeader ||\r\n              cell.isCorner ||\r\n              (self.attributes.allowColumnResizeFromCell && cell.isNormal)) &&\r\n            border === 'r'\r\n          ) {\r\n            cell.context = 'ew-resize';\r\n            cell.dragContext = 'ew-resize';\r\n            return cell;\r\n          }\r\n          if (!(cell.isColumnHeader || cell.isCorner) && moveBorder) {\r\n            cell.context = xBorderBehavior;\r\n            cell.dragContext = border + '-move';\r\n            return cell;\r\n          }\r\n        }\r\n        if (\r\n          ['t', 'b'].indexOf(border) !== -1 &&\r\n          cell.rowIndex > -1 &&\r\n          (self.attributes.allowRowResize || moveBorder) &&\r\n          ((self.attributes.allowRowResizeFromCell && cell.isNormal) ||\r\n            !cell.isNormal ||\r\n            moveBorder) &&\r\n          !cell.isColumnHeader\r\n        ) {\r\n          if (\r\n            (cell.isRowHeader ||\r\n              cell.isCorner ||\r\n              (self.attributes.allowRowResizeFromCell && cell.isNormal)) &&\r\n            border === 'b'\r\n          ) {\r\n            cell.context = 'ns-resize';\r\n            cell.dragContext = 'ns-resize';\r\n            return cell;\r\n          }\r\n          if (!(cell.isRowHeader || cell.isCorner) && moveBorder) {\r\n            cell.context = yBorderBehavior;\r\n            cell.dragContext = border + '-move';\r\n            return cell;\r\n          }\r\n        }\r\n        if (cell.style === 'columnHeaderCell') {\r\n          cell.context = 'cell';\r\n          cell.dragContext = 'column-reorder';\r\n          return cell;\r\n        }\r\n        if (cell.style === 'rowHeaderCell') {\r\n          if (\r\n            self.attributes.rowGrabZoneSize +\r\n              (cell.y - self.style.cellBorderWidth) <\r\n              y ||\r\n            !self.attributes.allowRowReordering\r\n          ) {\r\n            cell.dragContext = 'cell';\r\n            cell.context = 'cell';\r\n          } else {\r\n            cell.context = self.cursorGrab;\r\n            cell.dragContext = 'row-reorder';\r\n          }\r\n          return cell;\r\n        }\r\n        if (cell.isGrid) {\r\n          self.hasFocus = false;\r\n          cell.dragContext = 'cell-grid';\r\n          cell.context = 'cell-grid';\r\n          return cell;\r\n        }\r\n        if (cell.style === 'tree-grid') {\r\n          self.hasFocus = false;\r\n          cell.dragContext = 'tree';\r\n          cell.context = 'tree';\r\n          return cell;\r\n        }\r\n        cell.dragContext = 'cell';\r\n        cell.context = 'cell';\r\n        return cell;\r\n      }\r\n    }\r\n    self.hasFocus = true;\r\n    self.cursor = 'default';\r\n    return {\r\n      dragContext: 'background',\r\n      context: 'background',\r\n      style: 'background',\r\n      isBackground: true,\r\n    };\r\n  };\r\n  /**\r\n   * Gets the bounds of current selection.\r\n   * @returns {rect} selection.\r\n   * @memberof canvasDatagrid\r\n   * @name getSelectionBounds\r\n   * @method\r\n   */\r\n  self.getSelectionBounds = function () {\r\n    var low = { x: Infinity, y: Infinity },\r\n      high = { x: -Infinity, y: -Infinity };\r\n    self.selections.forEach(function (row, rowIndex) {\r\n      var maxCol, minCol;\r\n      low.y = rowIndex < low.y ? rowIndex : low.y;\r\n      high.y = rowIndex > high.y ? rowIndex : high.y;\r\n      maxCol = Math.max.apply(null, row);\r\n      minCol = Math.min.apply(null, row);\r\n      low.x = minCol < low.x ? minCol : low.x;\r\n      high.x = maxCol > high.x ? maxCol : high.x;\r\n    });\r\n    return {\r\n      top: low.y,\r\n      left: low.x,\r\n      bottom: high.y,\r\n      right: high.x,\r\n    };\r\n  };\r\n  /**\r\n   * Returns an auto generated schema based on data structure.\r\n   * @memberof canvasDatagrid\r\n   * @name getSchemaFromData\r\n   * @method\r\n   * @tutorial schema\r\n   * @returns {schema} schema A schema based on the first item in the data array.\r\n   */\r\n  self.getSchemaFromData = function (d) {\r\n    d = d || self.originalData;\r\n    return Object.keys(d[0] || { ' ': '' }).map(function mapEachSchemaColumn(\r\n      key,\r\n      index,\r\n    ) {\r\n      var type = self.getBestGuessDataType(key, d),\r\n        i = {\r\n          name: key,\r\n          title: isNaN(parseInt(key, 10))\r\n            ? key\r\n            : self.integerToAlpha(key).toUpperCase(),\r\n          index: index,\r\n          columnIndex: index,\r\n          type: type,\r\n          filter: self.filter(type),\r\n        };\r\n      if (\r\n        self.storedSettings &&\r\n        self.storedSettings.visibility &&\r\n        self.storedSettings.visibility[i.name] !== undefined\r\n      ) {\r\n        i.hidden = !self.storedSettings.visibility[i.name];\r\n      }\r\n      return i;\r\n    });\r\n  };\r\n  /**\r\n   * Clears the change log grid.changes that keeps track of changes to the data set.\r\n   * This does not undo changes or alter data it is simply a convince array to keep\r\n   * track of changes made to the data since last this method was called.\r\n   * @memberof canvasDatagrid\r\n   * @name clearChangeLog\r\n   * @method\r\n   */\r\n  self.clearChangeLog = function () {\r\n    self.changes = [];\r\n  };\r\n  /**\r\n   * Selects an area of the grid.\r\n   * @memberof canvasDatagrid\r\n   * @name selectArea\r\n   * @method\r\n   * @param {rect} bounds A rect object representing the selected values.\r\n   */\r\n  self.selectArea = function (bounds, ctrl) {\r\n    self.selectionBounds = bounds || self.selectionBounds;\r\n    var ev,\r\n      x,\r\n      y,\r\n      s = self.getSchema();\r\n    if (!ctrl) {\r\n      self.selections = [];\r\n    }\r\n    if (\r\n      self.selectionBounds.top < -1 ||\r\n      self.selectionBounds.bottom > self.viewData.length ||\r\n      self.selectionBounds.left < -1 ||\r\n      self.selectionBounds.right > s.length\r\n    ) {\r\n      throw new Error('Impossible selection area');\r\n    }\r\n    for (\r\n      x = self.selectionBounds.top;\r\n      x <= self.selectionBounds.bottom;\r\n      x += 1\r\n    ) {\r\n      self.selections[x] = [];\r\n      for (\r\n        y = self.selectionBounds.left;\r\n        y <= self.selectionBounds.right;\r\n        y += 1\r\n      ) {\r\n        if (self.selections[x].indexOf(y) === -1) {\r\n          self.selections[x].push(y);\r\n        }\r\n      }\r\n    }\r\n    ev = {\r\n      selections: self.selections,\r\n      selectionBounds: self.selectionBounds,\r\n      selectedCells: self.getSelectedCells(),\r\n    };\r\n    Object.defineProperty(ev, 'selectedData', {\r\n      get: function () {\r\n        return self.getSelectedData();\r\n      },\r\n    });\r\n    self.dispatchEvent('selectionchanged', ev);\r\n  };\r\n  /**\r\n   * Returns the maximum text width for a given column by column name.\r\n   * @memberof canvasDatagrid\r\n   * @name findColumnMaxTextLength\r\n   * @method\r\n   * @returns {number} The number of pixels wide the maximum width value in the selected column.\r\n   * @param {string} name The name of the column to calculate the value's width of.\r\n   */\r\n  self.findColumnMaxTextLength = function (name) {\r\n    var m = -Infinity;\r\n    if (name === 'cornerCell') {\r\n      self.ctx.font = self.style.rowHeaderCellFont;\r\n      return (\r\n        self.ctx.measureText(\r\n          (\r\n            self.viewData.length + (self.attributes.showNewRow ? 1 : 0)\r\n          ).toString(),\r\n        ).width +\r\n        self.style.autosizePadding +\r\n        self.style.autosizeHeaderCellPadding +\r\n        self.style.rowHeaderCellPaddingRight +\r\n        self.style.rowHeaderCellPaddingLeft +\r\n        (self.attributes.tree\r\n          ? self.style.treeArrowWidth +\r\n            self.style.treeArrowMarginLeft +\r\n            self.style.treeArrowMarginRight\r\n          : 0)\r\n      );\r\n    }\r\n    var formatter = null;\r\n    self.getSchema().forEach(function (col) {\r\n      if (col.name !== name) {\r\n        return;\r\n      }\r\n      self.ctx.font = self.style.columnHeaderCellFont;\r\n      var t =\r\n        self.ctx.measureText(col.title || col.name).width +\r\n        self.style.headerCellPaddingRight +\r\n        self.style.headerCellPaddingLeft;\r\n      m = t > m ? t : m;\r\n      formatter = self.formatters[col.type];\r\n    });\r\n    self.viewData.forEach(function (row) {\r\n      var text = row[name];\r\n      if (formatter) {\r\n        text = formatter({ cell: { value: text } });\r\n      }\r\n      self.ctx.font = self.style.cellFont;\r\n      var t =\r\n        self.ctx.measureText(text).width +\r\n        self.style.cellPaddingRight +\r\n        self.style.cellPaddingLeft +\r\n        self.style.cellAutoResizePadding;\r\n      m = t > m ? t : m;\r\n    });\r\n    return m;\r\n  };\r\n  /**\r\n   * Gets the total width of all header columns.\r\n   * @memberof canvasDatagrid\r\n   * @name getHeaderWidth\r\n   * @method\r\n   */\r\n  self.getHeaderWidth = function () {\r\n    return self.getVisibleSchema().reduce(function (total, header) {\r\n      return total + parseInt(header.width || self.style.cellWidth, 10);\r\n    }, 0);\r\n  };\r\n  /**\r\n   * Gets the height of a row by index.\r\n   * @memberof canvasDatagrid\r\n   * @name getRowHeight\r\n   * @method\r\n   * @param {number} rowIndex The row index to lookup.\r\n   */\r\n  self.getRowHeight = function (rowIndex) {\r\n    return (self.sizes.rows[rowIndex] || self.style.cellHeight) * self.scale;\r\n  };\r\n  /**\r\n   * Gets the width of a column by index.\r\n   * @memberof canvasDatagrid\r\n   * @name getColumnWidth\r\n   * @method\r\n   * @param {number} columnIndex The column index to lookup.\r\n   */\r\n  self.getColumnWidth = function (columnIndex) {\r\n    return (\r\n      (self.sizes.columns[columnIndex] ||\r\n        self.getSchema()[columnIndex].width ||\r\n        self.style.cellWidth) * self.scale\r\n    );\r\n  };\r\n  self.formatters.string = function cellFormatterString(e) {\r\n    return e.cell.value !== undefined ? e.cell.value : '';\r\n  };\r\n  self.formatters.rowHeaderCell = self.formatters.string;\r\n  self.formatters.headerCell = self.formatters.string;\r\n  self.formatters.number = self.formatters.string;\r\n  self.formatters.int = self.formatters.string;\r\n  self.formatters.html = self.formatters.string;\r\n  self.sorters.string = function (columnName, direction) {\r\n    var asc = direction === 'asc';\r\n    return function (a, b) {\r\n      const aValue = a[columnName] || '';\r\n      const bValue = b[columnName] || '';\r\n      if (asc) {\r\n        if (!aValue.localeCompare) {\r\n          return 1;\r\n        }\r\n        return aValue.localeCompare(bValue);\r\n      }\r\n      if (!bValue.localeCompare) {\r\n        return 1;\r\n      }\r\n      return bValue.localeCompare(aValue);\r\n    };\r\n  };\r\n  self.sorters.number = function (columnName, direction) {\r\n    var asc = direction === 'asc';\r\n    return function (a, b) {\r\n      if (asc) {\r\n        return a[columnName] - b[columnName];\r\n      }\r\n      return b[columnName] - a[columnName];\r\n    };\r\n  };\r\n  self.sorters.date = function (columnName, direction) {\r\n    var asc = direction === 'asc';\r\n    return function (a, b) {\r\n      if (asc) {\r\n        return (\r\n          new Date(a[columnName]).getTime() - new Date(b[columnName]).getTime()\r\n        );\r\n      }\r\n      return (\r\n        new Date(b[columnName]).getTime() - new Date(a[columnName]).getTime()\r\n      );\r\n    };\r\n  };\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true, plusplus: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  var touchTimerMs = 50,\r\n    debounceTouchMove,\r\n    touchMoving,\r\n    touchScrollTimeout;\r\n  self.scrollAnimation = {};\r\n  self.touchDelta = {};\r\n  self.touchAnimateTo = {};\r\n  self.animationFrames = 0;\r\n  self.getTouchPos = function (e, touchIndex) {\r\n    var t = touchIndex ? e.touches[touchIndex] : e.touches[0],\r\n      rect = self.canvas.getBoundingClientRect(),\r\n      pos;\r\n    if (!t) {\r\n      return;\r\n    }\r\n    pos = {\r\n      x: t.clientX - rect.left,\r\n      y: t.clientY - rect.top,\r\n    };\r\n    if (self.isChildGrid) {\r\n      pos.x -= self.canvasOffsetLeft;\r\n      pos.y -= self.canvasOffsetTop;\r\n    }\r\n    return {\r\n      x: pos.x,\r\n      y: pos.y,\r\n      rect: rect,\r\n    };\r\n  };\r\n  // shamelessly stolen from from https://gist.github.com/gre/1650294\r\n  self.easingFunctions = {\r\n    linear: function (t) {\r\n      return t;\r\n    },\r\n    easeInQuad: function (t) {\r\n      return t * t;\r\n    },\r\n    easeOutQuad: function (t) {\r\n      return t * (2 - t);\r\n    },\r\n    easeInOutQuad: function (t) {\r\n      return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n    },\r\n    easeInCubic: function (t) {\r\n      return t * t * t;\r\n    },\r\n    easeOutCubic: function (t) {\r\n      return --t * t * t + 1;\r\n    },\r\n    easeInOutCubic: function (t) {\r\n      return t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\r\n    },\r\n    easeInQuart: function (t) {\r\n      return t * t * t * t;\r\n    },\r\n    easeOutQuart: function (t) {\r\n      return 1 - --t * t * t * t;\r\n    },\r\n    easeInOutQuart: function (t) {\r\n      return t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t;\r\n    },\r\n    easeInQuint: function (t) {\r\n      return t * t * t * t * t;\r\n    },\r\n    easeOutQuint: function (t) {\r\n      return 1 + --t * t * t * t * t;\r\n    },\r\n    easeInOutQuint: function (t) {\r\n      return t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t;\r\n    },\r\n  };\r\n  self.easing = function (t, b, c, d) {\r\n    return (\r\n      c * self.easingFunctions[self.attributes.touchEasingMethod](t / d) + b\r\n    );\r\n  };\r\n  self.calculatePPSTimed = function () {\r\n    self.xPPST = -(\r\n      (self.touchDelta.x - self.touchSigmaTimed.x) /\r\n      (self.touchDelta.t - self.touchSigmaTimed.t)\r\n    );\r\n    self.yPPST = -(\r\n      (self.touchDelta.y - self.touchSigmaTimed.y) /\r\n      (self.touchDelta.t - self.touchSigmaTimed.t)\r\n    );\r\n    self.touchSigmaTimed = {\r\n      x: self.touchDelta.x,\r\n      y: self.touchDelta.y,\r\n      t: performance.now(),\r\n    };\r\n  };\r\n  self.calculatePPS = function () {\r\n    self.xPPS = -(\r\n      (self.touchDelta.x - self.touchSigma.x) /\r\n      (self.touchDelta.t - self.touchSigma.t)\r\n    );\r\n    self.yPPS = -(\r\n      (self.touchDelta.y - self.touchSigma.y) /\r\n      (self.touchDelta.t - self.touchSigma.t)\r\n    );\r\n    self.touchSigma = {\r\n      x: self.touchDelta.x,\r\n      y: self.touchDelta.y,\r\n      t: performance.now(),\r\n    };\r\n  };\r\n  self.touchEndAnimation = function () {\r\n    if (!self.canvas || !self.scrollBox.scrollTo) {\r\n      return requestAnimationFrame(self.touchEndAnimation);\r\n    }\r\n    var n = performance.now(),\r\n      d = self.attributes.touchReleaseAnimationDurationMs,\r\n      t;\r\n    t = n - self.touchDelta.t;\r\n    self.animationFrames += 1;\r\n    self.scrollAnimation.x = self.easing(\r\n      t,\r\n      self.touchDelta.scrollLeft,\r\n      self.touchAnimateTo.x,\r\n      d,\r\n    );\r\n    self.scrollAnimation.y = self.easing(\r\n      t,\r\n      self.touchDelta.scrollTop,\r\n      self.touchAnimateTo.y,\r\n      d,\r\n    );\r\n    if (\r\n      t > d ||\r\n      (self.scrollAnimation.y === self.scrollBox.scrollTop &&\r\n        self.scrollAnimation.x === self.scrollBox.scrollLeft) ||\r\n      self.stopAnimation\r\n    ) {\r\n      return;\r\n    }\r\n    self.scrollBox.scrollTo(self.scrollAnimation.x, self.scrollAnimation.y);\r\n    requestAnimationFrame(self.touchEndAnimation);\r\n  };\r\n  self.touchEditCell = function (cell) {\r\n    self.beginEditAt(cell.columnIndex, cell.rowIndex);\r\n  };\r\n  self.touchstart = function (e) {\r\n    if (e.changedTouches[0]) {\r\n      self.touchStart = self.getTouchPos(e);\r\n      self.startingCell = self.getCellAt(\r\n        self.touchStart.x,\r\n        self.touchStart.y,\r\n        true,\r\n      );\r\n    }\r\n    if (\r\n      self.dispatchEvent('touchstart', {\r\n        NativeEvent: e,\r\n        cell: self.startingCell,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    self.disposeContextMenu();\r\n    clearInterval(self.calculatePPSTimer);\r\n    clearTimeout(self.touchContextTimeout);\r\n    self.touchStartEvent = e;\r\n    self.stopAnimation = true;\r\n    self.animationFrames = 0;\r\n    self.stopPropagation(e);\r\n    if (e.touches.length === 1 && e.changedTouches[0] && !self.zoomAltered) {\r\n      self.touchLength = 1;\r\n      self.touchStart = self.touchStart || self.touchStart1;\r\n      self.touchScrollStart = {\r\n        x: self.scrollBox.scrollLeft,\r\n        y: self.scrollBox.scrollTop,\r\n        t: performance.now(),\r\n      };\r\n      self.touchDelta = {\r\n        x: 0,\r\n        y: 0,\r\n        scrollLeft: self.scrollBox.scrollLeft,\r\n        scrollTop: self.scrollBox.scrollTop,\r\n        t: self.touchScrollStart.t,\r\n      };\r\n      self.touchSigma = {\r\n        x: self.touchDelta.x,\r\n        y: self.touchDelta.y,\r\n        t: self.touchDelta.t,\r\n      };\r\n      self.touchSigmaTimed = {\r\n        x: self.touchDelta.x,\r\n        y: self.touchDelta.y,\r\n        t: self.touchDelta.t,\r\n      };\r\n      self.touchContextTimeout = setTimeout(function () {\r\n        self.contextmenuEvent(e, self.touchStart);\r\n      }, self.attributes.touchContextMenuTimeMs);\r\n      self.calculatePPSTimer = setInterval(\r\n        self.calculatePPSTimed,\r\n        touchTimerMs,\r\n      );\r\n      if (\r\n        self.startingCell &&\r\n        (self.startingCell.isGrid ||\r\n          ['tree', 'inherit'].indexOf(self.startingCell.context) !== -1)\r\n      ) {\r\n        self.hasFocus = false;\r\n        return;\r\n      }\r\n      self.hasFocus = true;\r\n      if (self.startingCell.isHeader) {\r\n        if (self.startingCell.isRowHeader) {\r\n          self.selectArea({\r\n            top: self.startingCell.rowIndex,\r\n            bottom: self.startingCell.rowIndex,\r\n            left: 0,\r\n            right: self.getVisibleSchema().length - 1,\r\n          });\r\n          self.draw(true);\r\n        } else if (self.startingCell.isColumnHeader) {\r\n          if (self.attributes.columnHeaderClickBehavior === 'sort') {\r\n            if (self.orderBy === self.startingCell.header.name) {\r\n              self.orderDirection =\r\n                self.orderDirection === 'asc' ? 'desc' : 'asc';\r\n            } else {\r\n              self.orderDirection = 'asc';\r\n            }\r\n            self.order(self.startingCell.header.name, self.orderDirection);\r\n          }\r\n          if (self.attributes.columnHeaderClickBehavior === 'select') {\r\n            self.selectArea({\r\n              top: 0,\r\n              bottom: self.viewData.length - 1,\r\n              left: self.startingCell.columnIndex,\r\n              right: self.startingCell.columnIndex,\r\n            });\r\n            self.draw(true);\r\n          }\r\n        }\r\n        self.touchEndEvents(e);\r\n        return;\r\n      }\r\n    }\r\n    if (self.zoomAltered) {\r\n      return;\r\n    }\r\n    document.body.addEventListener('touchmove', self.touchmove, {\r\n      passive: false,\r\n    });\r\n    document.body.addEventListener('touchend', self.touchend, false);\r\n    document.body.addEventListener('touchcancel', self.touchcancel, false);\r\n    self.draw(true);\r\n  };\r\n  self.touchSelect = function (cell, handleType) {\r\n    if (cell.rowIndex === undefined || cell.columnIndex === undefined) {\r\n      return;\r\n    }\r\n    self.touchSelecting = true;\r\n    var bounds = self.getSelectionBounds();\r\n    if (\r\n      handleType === 'selection-handle-bl' &&\r\n      cell.rowIndex >= bounds.top &&\r\n      cell.columnIndex <= bounds.right\r\n    ) {\r\n      bounds.bottom = cell.rowIndex;\r\n      bounds.left = cell.columnIndex;\r\n    } else if (\r\n      handleType === 'selection-handle-tl' &&\r\n      cell.rowIndex <= bounds.bottom &&\r\n      cell.columnIndex <= bounds.right\r\n    ) {\r\n      bounds.top = cell.rowIndex;\r\n      bounds.left = cell.columnIndex;\r\n    } else if (\r\n      handleType === 'selection-handle-tr' &&\r\n      cell.rowIndex <= bounds.bottom &&\r\n      cell.columnIndex >= bounds.left\r\n    ) {\r\n      bounds.top = cell.rowIndex;\r\n      bounds.right = cell.columnIndex;\r\n    } else if (\r\n      handleType === 'selection-handle-br' &&\r\n      cell.rowIndex >= bounds.top &&\r\n      cell.columnIndex >= bounds.left\r\n    ) {\r\n      bounds.bottom = cell.rowIndex;\r\n      bounds.right = cell.columnIndex;\r\n    }\r\n    if (self.attributes.selectionMode === 'row' || cell.rowIndex === -1) {\r\n      bounds.left = 0;\r\n      bounds.right = self.getSchema().length - 1;\r\n    } else {\r\n      bounds.left = Math.max(0, bounds.left);\r\n    }\r\n    self.selectArea(bounds);\r\n    self.draw(true);\r\n  };\r\n  function touchMove(e) {\r\n    var ch, rw, rScrollZone, lScrollZone, bScrollZone, tScrollZone, sbw, t1, t2;\r\n    if (self.dispatchEvent('beforetouchmove', { NativeEvent: e })) {\r\n      return;\r\n    }\r\n    clearTimeout(touchScrollTimeout);\r\n    if (e.changedTouches[0]) {\r\n      self.touchPosition = self.getTouchPos(e);\r\n    }\r\n    if (e.changedTouches[1]) {\r\n      self.touchPosition1 = self.getTouchPos(e, 1);\r\n    }\r\n    if (\r\n      Math.abs(self.touchDelta.x) + Math.abs(self.touchDelta.y) >\r\n      self.attributes.touchDeadZone\r\n    ) {\r\n      clearTimeout(self.touchContextTimeout);\r\n    }\r\n    if (e.touches.length === 2 && self.touchPosition && self.touchPosition1) {\r\n      t1 = self.touchPosition.y;\r\n      t2 = self.touchPosition1.y;\r\n      if (!self.zoomDeltaStart) {\r\n        self.zoomDeltaStart = Math.abs(t1 - t2);\r\n        self.startScale = self.scale;\r\n      }\r\n      self.touchLength = 2;\r\n      self.scaleDelta = self.zoomDeltaStart - Math.abs(t1 - t2);\r\n      self.scale =\r\n        self.startScale -\r\n        self.scaleDelta * self.attributes.touchZoomSensitivity;\r\n      self.scale = Math.min(\r\n        Math.max(self.scale, self.attributes.touchZoomMin),\r\n        self.attributes.touchZoomMax,\r\n      );\r\n      self.zoomAltered = true;\r\n      self.resize(true);\r\n      self.resizeChildGrids();\r\n      return;\r\n    }\r\n    if (self.zoomAltered) {\r\n      return;\r\n    }\r\n    self.touchLength = 1;\r\n    self.touchPosition = self.touchPosition || self.touchPosition1;\r\n    ch = self.getColumnHeaderCellHeight();\r\n    rw = self.getRowHeaderCellWidth();\r\n    rScrollZone =\r\n      self.width - self.style.scrollBarWidth - self.touchPosition.x <\r\n      self.attributes.selectionScrollZone;\r\n    lScrollZone =\r\n      self.touchPosition.x - rw < self.attributes.selectionScrollZone;\r\n    bScrollZone =\r\n      self.height - self.style.scrollBarWidth - self.touchPosition.y <\r\n      self.attributes.selectionScrollZone;\r\n    tScrollZone =\r\n      self.touchPosition.y - ch < self.attributes.selectionScrollZone;\r\n    sbw = self.style.scrollBarWidth;\r\n    function touchScroll() {\r\n      var x = self.scrollBox.scrollLeft,\r\n        y = self.scrollBox.scrollTop;\r\n      x += rScrollZone ? self.attributes.selectionScrollIncrement : 0;\r\n      y += bScrollZone ? self.attributes.selectionScrollIncrement : 0;\r\n      y -= tScrollZone ? self.attributes.selectionScrollIncrement : 0;\r\n      x -= lScrollZone ? self.attributes.selectionScrollIncrement : 0;\r\n      self.scrollBox.scrollTo(x, y);\r\n      touchScrollTimeout = setTimeout(\r\n        touchScroll,\r\n        self.attributes.scrollRepeatRate,\r\n      );\r\n    }\r\n    e.stopPropagation();\r\n    self.touchDelta = {\r\n      x: self.touchPosition.x - self.touchStart.x,\r\n      y: self.touchPosition.y - self.touchStart.y,\r\n      scrollLeft: self.scrollBox.scrollLeft,\r\n      scrollTop: self.scrollBox.scrollTop,\r\n      t: performance.now(),\r\n    };\r\n    self.currentCell = self.getCellAt(\r\n      self.touchPosition.x,\r\n      self.touchPosition.y,\r\n    );\r\n    self.dispatchEvent('touchmove', { NativeEvent: e, cell: self.currentCell });\r\n    self.calculatePPS();\r\n    self.touchDuration = performance.now() - self.touchScrollStart.t;\r\n    self.stopAnimation = true;\r\n    self.animationFrames = 0;\r\n    if (\r\n      self.touchSelecting &&\r\n      (rScrollZone || lScrollZone || tScrollZone || bScrollZone)\r\n    ) {\r\n      touchScroll();\r\n    }\r\n    if (/vertical-scroll-/.test(self.startingCell.style)) {\r\n      self.scrollBox.scrollTop =\r\n        self.scrollBox.scrollHeight *\r\n        ((self.touchPosition.y - ch - sbw) /\r\n          (self.scrollBox.height - sbw - ch));\r\n      return;\r\n    }\r\n    if (/horizontal-scroll-/.test(self.startingCell.style)) {\r\n      self.scrollBox.scrollLeft =\r\n        self.scrollBox.scrollWidth *\r\n        ((self.touchPosition.x - rw - sbw) / (self.scrollBox.width - sbw - rw));\r\n      return;\r\n    }\r\n    if (/selection-handle-/.test(self.startingCell.style)) {\r\n      self.touchSelect(self.currentCell, self.startingCell.style);\r\n      return;\r\n    }\r\n    self.scrollBox.scrollTo(\r\n      self.touchScrollStart.x - self.touchDelta.x,\r\n      self.touchScrollStart.y - self.touchDelta.y,\r\n    );\r\n  }\r\n  self.touchmove = function (e) {\r\n    if (touchMoving) {\r\n      return;\r\n    }\r\n    requestAnimationFrame(function () {\r\n      touchMoving = true;\r\n      touchMove(e);\r\n      touchMoving = false;\r\n    });\r\n  };\r\n  self.touchEndEvents = function (e) {\r\n    self.zoomDeltaStart = undefined;\r\n    self.touchSelecting = false;\r\n    clearInterval(self.touchScrollTimeout);\r\n    clearInterval(self.touchContextTimeout);\r\n    clearInterval(self.calculatePPSTimer);\r\n    e.stopPropagation();\r\n    document.body.removeEventListener('touchmove', self.touchmove, {\r\n      passive: false,\r\n    });\r\n    document.body.removeEventListener('touchend', self.touchend, false);\r\n    document.body.removeEventListener('touchcancel', self.touchcancel, false);\r\n  };\r\n  self.touchend = function (e) {\r\n    if (\r\n      self.dispatchEvent('touchend', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    self.zoomDeltaStart = undefined;\r\n    if (e.changedTouches[0]) {\r\n      self.touchPosition = undefined;\r\n    }\r\n    if (e.changedTouches[1]) {\r\n      self.touchPosition1 = undefined;\r\n    }\r\n    if (self.zoomAltered) {\r\n      if (e.touches.length === 0) {\r\n        self.zoomAltered = false;\r\n      }\r\n      return;\r\n    }\r\n    var dz =\r\n      Math.abs(self.touchDelta.x) + Math.abs(self.touchDelta.y) <\r\n      self.attributes.touchDeadZone;\r\n    if (isNaN(self.xPPS)) {\r\n      self.xPPS = 0;\r\n    }\r\n    if (isNaN(self.yPPS)) {\r\n      self.yPPS = 0;\r\n    }\r\n    if (isNaN(self.xPPST)) {\r\n      self.xPPST = 0;\r\n    }\r\n    if (isNaN(self.yPPST)) {\r\n      self.yPPST = 0;\r\n    }\r\n    self.touchAnimateTo.x =\r\n      self.xPPS * self.attributes.touchReleaseAcceleration;\r\n    self.touchAnimateTo.y =\r\n      self.yPPS * self.attributes.touchReleaseAcceleration;\r\n    self.calculatePPSTimed();\r\n    if (\r\n      !dz &&\r\n      self.animationFrames === 0 &&\r\n      (Math.abs(self.xPPST) > self.attributes.scrollAnimationPPSThreshold ||\r\n        Math.abs(self.yPPST) > self.attributes.scrollAnimationPPSThreshold) &&\r\n      !/-scroll-/.test(self.startingCell.style) &&\r\n      !dz\r\n    ) {\r\n      self.stopAnimation = false;\r\n      self.touchEndAnimation();\r\n    }\r\n    self.touchEndEvents(e);\r\n  };\r\n  self.touchcancel = function (e) {\r\n    if (\r\n      self.dispatchEvent('touchcancel', {\r\n        NativeEvent: e,\r\n        cell: self.currentCell,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    self.touchEndEvents(e);\r\n  };\r\n}\r\n","module.exports=function(e){var o={};function a(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=o,a.d=function(e,o,t){a.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:t})},a.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},a.t=function(e,o){if(1&o&&(e=a(e)),8&o)return e;if(4&o&&\"object\"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(a.r(t),Object.defineProperty(t,\"default\",{enumerable:!0,value:e}),2&o&&\"string\"!=typeof e)for(var r in e)a.d(t,r,function(o){return e[o]}.bind(null,r));return t},a.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(o,\"a\",o),o},a.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},a.p=\"\",a(a.s=0)}([function(e,o,a){\"use strict\";Object.defineProperty(o,\"__esModule\",{value:!0});var t=a(1),r=Object.keys(t.default).reduce((function(e,o){return e.concat(t.default[o])}),[]);o.default=function(e){return-1===r.indexOf(e.key)}},function(e,o,a){\"use strict\";Object.defineProperty(o,\"__esModule\",{value:!0});o.default={modifier:[\"Alt\",\"AltGraph\",\"CapsLock\",\"Control\",\"Fn\",\"FnLock\",\"Meta\",\"NumLock\",\"ScrollLock\",\"Shift\",\"Symbol\",\"SymbolLock\"],legacyModifier:[\"Hyper\",\"Super\"],whiteSpace:[\"Enter\",\"Tab\"],navigation:[\"ArrowDown\",\"ArrowLeft\",\"ArrowRight\",\"ArrowUp\",\"End\",\"Home\",\"PageDown\",\"PageUp\"],editing:[\"Backspace\",\"Clear\",\"Copy\",\"CrSel\",\"Cut\",\"Delete\",\"EraseEof\",\"ExSel\",\"Insert\",\"Paste\",\"Redo\",\"Undo\"],ui:[\"Accept\",\"Again\",\"Attn\",\"Cancel\",\"ContextMenu\",\"Escape\",\"Execute\",\"Find\",\"Help\",\"Pause\",\"Play\",\"Props\",\"Select\",\"ZoomIn\",\"ZoomOut\"],device:[\"BrightnessDown\",\"BrightnessUp\",\"Eject\",\"LogOff\",\"Power\",\"PowerOff\",\"PrintScreen\",\"Hibernate\",\"Standby\",\"WakeUp\"],imeCompositionKeys:[\"AllCandidates\",\"Alphanumeric\",\"CodeInput\",\"Compose\",\"Convert\",\"Dead\",\"FinalMode\",\"GroupFirst\",\"GroupLast\",\"GroupNext\",\"GroupPrevious\",\"ModeChange\",\"NextCandidate\",\"NonConvert\",\"PreviousCandidate\",\"Process\",\"SingleCandidate\"],koreanSpecific:[\"HangulMode\",\"HanjaMode\",\"JunjaMode\"],japaneseSpecific:[\"Eisu\",\"Hankaku\",\"Hiragana\",\"HiraganaKatakana\",\"KanaMode\",\"KanjiMode\",\"Katakana\",\"Romaji\",\"Zenkaku\",\"ZenkakuHankaku\"],commonFunction:[\"F1\",\"F2\",\"F3\",\"F4\",\"F5\",\"F6\",\"F7\",\"F8\",\"F9\",\"F10\",\"F11\",\"F12\",\"Soft1\",\"Soft2\",\"Soft3\",\"Soft4\"],multimedia:[\"ChannelDown\",\"ChannelUp\",\"Close\",\"MailForward\",\"MailReply\",\"MailSend\",\"MediaClose\",\"MediaFastForward\",\"MediaPause\",\"MediaPlay\",\"MediaPlayPause\",\"MediaRecord\",\"MediaRewind\",\"MediaStop\",\"MediaTrackNext\",\"MediaTrackPrevious\",\"New\",\"Open\",\"Print\",\"Save\",\"SpellCheck\"],multimediaNumpad:[\"Key11\",\"Key12\"],audio:[\"AudioBalanceLeft\",\"AudioBalanceRight\",\"AudioBassBoostDown\",\"AudioBassBoostToggle\",\"AudioBassBoostUp\",\"AudioFaderFront\",\"AudioFaderRear\",\"AudioSurroundModeNext\",\"AudioTrebleDown\",\"AudioTrebleUp\",\"AudioVolumeDown\",\"AudioVolumeUp\",\"AudioVolumeMute\",\"MicrophoneToggle\",\"MicrophoneVolumeDown\",\"MicrophoneVolumeUp\",\"MicrophoneVolumeMute\"],speech:[\"SpeechCorrectionList\",\"SpeechInputToggle\"],application:[\"LaunchApplication1\",\"LaunchApplication2\",\"LaunchCalendar\",\"LaunchContacts\",\"LaunchMail\",\"LaunchMediaPlayer\",\"LaunchMusicPlayer\",\"LaunchPhone\",\"LaunchScreenSaver\",\"LaunchSpreadsheet\",\"LaunchWebBrowser\",\"LaunchWebCam\",\"LaunchWordProcessor\"],browser:[\"BrowserBack\",\"BrowserFavorites\",\"BrowserForward\",\"BrowserHome\",\"BrowserRefresh\",\"BrowserSearch\",\"BrowserStop\"],mobilePhone:[\"AppSwitch\",\"Call\",\"Camera\",\"CameraFocus\",\"EndCall\",\"GoBack\",\"GoHome\",\"HeadsetHook\",\"LastNumberRedial\",\"Notification\",\"MannerMode\",\"VoiceDial\"],tv:[\"TV\",\"TV3DMode\",\"TVAntennaCable\",\"TVAudioDescription\",\"TVAudioDescriptionMixDown\",\"TVAudioDescriptionMixUp\",\"TVContentsMenu\",\"TVDataService\",\"TVInput\",\"TVInputComponent1\",\"TVInputComponent2\",\"TVInputComposite1\",\"TVInputComposite2\",\"TVInputHDMI1\",\"TVInputHDMI2\",\"TVInputHDMI3\",\"TVInputHDMI4\",\"TVInputVGA1\",\"TVMediaContext\",\"TVNetwork\",\"TVNumberEntry\",\"TVPower\",\"TVRadioService\",\"TVSatellite\",\"TVSatelliteBS\",\"TVSatelliteCS\",\"TVSatelliteToggle\",\"TVTerrestrialAnalog\",\"TVTerrestrialDigital\",\"TVTimer\"],mediaControls:[\"AVRInput\",\"AVRPower\",\"ColorF0Red\",\"ColorF1Green\",\"ColorF2Yellow\",\"ColorF3Blue\",\"ColorF4Grey\",\"ColorF5Brown\",\"ClosedCaptionToggle\",\"Dimmer\",\"DisplaySwap\",\"DVR\",\"Exit\",\"FavoriteClear0\",\"FavoriteClear1\",\"FavoriteClear2\",\"FavoriteClear3\",\"FavoriteRecall0\",\"FavoriteRecall1\",\"FavoriteRecall2\",\"FavoriteRecall3\",\"FavoriteStore0\",\"FavoriteStore1\",\"FavoriteStore2\",\"FavoriteStore3\",\"Guide\",\"GuideNextDay\",\"GuidePreviousDay\",\"Info\",\"InstantReplay\",\"Link\",\"ListProgram\",\"LiveContent\",\"Lock\",\"MediaApps\",\"MediaAudioTrack\",\"MediaLast\",\"MediaSkipBackward\",\"MediaSkipForward\",\"MediaStepBackward\",\"MediaStepForward\",\"MediaTopMenu\",\"NavigateIn\",\"NavigateNext\",\"NavigateOut\",\"NavigatePrevious\",\"NextFavoriteChannel\",\"NextUserProfile\",\"OnDemand\",\"Pairing\",\"PinPDown\",\"PinPMove\",\"PinPToggle\",\"PinPUp\",\"PlaySpeedDown\",\"PlaySpeedReset\",\"PlaySpeedUp\",\"RandomToggle\",\"RcLowBattery\",\"RecordSpeedNext\",\"RfBypass\",\"ScanChannelsToggle\",\"ScreenModeNext\",\"Settings\",\"SplitScreenToggle\",\"STBInput\",\"STBPower\",\"Subtitle\",\"Teletext\",\"VideoModeNext\",\"Wink\",\"ZoomToggle\"]}}]).default;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(\"./lib/main.js\");\n"],"sourceRoot":""}